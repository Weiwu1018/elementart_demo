{"creation_time": "2024-08-21T09:07:41+00:00", "days_back": 7, "models": {"model.elementary_tutorial.returned_orders": {"name": "returned_orders", "unique_id": "model.elementary_tutorial.returned_orders", "owners": [], "tags": ["finance"], "package_name": "elementary_tutorial", "description": "This table contains all of the returned orders", "full_path": "models/returned_orders.sql", "meta": {}, "materialization": "view", "database_name": "demo2_0821", "schema_name": "public", "table_name": "returned_orders", "patch_path": "elementary_tutorial://models/schema.yml", "model_name": "returned_orders", "normalized_full_path": "elementary_tutorial/models/returned_orders.sql", "fqn": "demo2_0821.public.returned_orders", "artifact_type": "model"}, "model.elementary_tutorial.test4_volume_anomaly": {"name": "test4_volume_anomaly", "unique_id": "model.elementary_tutorial.test4_volume_anomaly", "owners": [], "tags": ["PII"], "package_name": "elementary_tutorial", "description": "This table has basic information about a customer", "full_path": "models/test4_volume_anomaly.sql", "meta": {}, "materialization": "view", "database_name": "demo2_0821", "schema_name": "public", "table_name": "test4_volume_anomaly", "patch_path": "elementary_tutorial://models/schema.yml", "model_name": "test4_volume_anomaly", "normalized_full_path": "elementary_tutorial/models/test4_volume_anomaly.sql", "fqn": "demo2_0821.public.test4_volume_anomaly", "artifact_type": "model"}, "model.elementary_tutorial.customers": {"name": "customers", "unique_id": "model.elementary_tutorial.customers", "owners": [], "tags": ["PII"], "package_name": "elementary_tutorial", "description": "This table has basic information about a customer, as well as some derived facts based on a customer's orders", "full_path": "models/customers.sql", "meta": {}, "materialization": "view", "database_name": "demo2_0821", "schema_name": "public", "table_name": "customers", "patch_path": "elementary_tutorial://models/schema.yml", "model_name": "customers", "normalized_full_path": "elementary_tutorial/models/customers.sql", "fqn": "demo2_0821.public.customers", "artifact_type": "model"}, "model.elementary_tutorial.orders": {"name": "orders", "unique_id": "model.elementary_tutorial.orders", "owners": [], "tags": ["finance"], "package_name": "elementary_tutorial", "description": "This table has basic information about orders, as well as some derived facts based on payments", "full_path": "models/orders.sql", "meta": {}, "materialization": "view", "database_name": "demo2_0821", "schema_name": "public", "table_name": "orders", "patch_path": "elementary_tutorial://models/schema.yml", "model_name": "orders", "normalized_full_path": "elementary_tutorial/models/orders.sql", "fqn": "demo2_0821.public.orders", "artifact_type": "model"}, "model.elementary_tutorial.test4_column_anomaly": {"name": "test4_column_anomaly", "unique_id": "model.elementary_tutorial.test4_column_anomaly", "owners": [], "tags": ["PII"], "package_name": "elementary_tutorial", "description": "This table has basic information about a customer, as well as some derived facts based on a customer's orders", "full_path": "models/test4_column_anomaly.sql", "meta": {}, "materialization": "view", "database_name": "demo2_0821", "schema_name": "public", "table_name": "test4_column_anomaly", "patch_path": "elementary_tutorial://models/schema.yml", "model_name": "test4_column_anomaly", "normalized_full_path": "elementary_tutorial/models/test4_column_anomaly.sql", "fqn": "demo2_0821.public.test4_column_anomaly", "artifact_type": "model"}, "model.elementary_tutorial.stg_customers": {"name": "stg_customers", "unique_id": "model.elementary_tutorial.stg_customers", "owners": [], "tags": [], "package_name": "elementary_tutorial", "description": "", "full_path": "models/staging/stg_customers.sql", "meta": {}, "materialization": "view", "database_name": "demo2_0821", "schema_name": "public", "table_name": "stg_customers", "patch_path": null, "model_name": "stg_customers", "normalized_full_path": "elementary_tutorial/models/staging/stg_customers.sql", "fqn": "demo2_0821.public.stg_customers", "artifact_type": "model"}, "model.elementary_tutorial.test_practice": {"name": "test_practice", "unique_id": "model.elementary_tutorial.test_practice", "owners": [], "tags": [], "package_name": "elementary_tutorial", "description": "", "full_path": "models/staging/test_practice.sql", "meta": {}, "materialization": "view", "database_name": "demo2_0821", "schema_name": "public", "table_name": "test_practice", "patch_path": null, "model_name": "test_practice", "normalized_full_path": "elementary_tutorial/models/staging/test_practice.sql", "fqn": "demo2_0821.public.test_practice", "artifact_type": "model"}, "model.elementary_tutorial.stg_payments": {"name": "stg_payments", "unique_id": "model.elementary_tutorial.stg_payments", "owners": [], "tags": [], "package_name": "elementary_tutorial", "description": "", "full_path": "models/staging/stg_payments.sql", "meta": {}, "materialization": "view", "database_name": "demo2_0821", "schema_name": "public", "table_name": "stg_payments", "patch_path": null, "model_name": "stg_payments", "normalized_full_path": "elementary_tutorial/models/staging/stg_payments.sql", "fqn": "demo2_0821.public.stg_payments", "artifact_type": "model"}, "model.elementary_tutorial.stg_orders": {"name": "stg_orders", "unique_id": "model.elementary_tutorial.stg_orders", "owners": [], "tags": [], "package_name": "elementary_tutorial", "description": "", "full_path": "models/staging/stg_orders.sql", "meta": {}, "materialization": "view", "database_name": "demo2_0821", "schema_name": "public", "table_name": "stg_orders", "patch_path": null, "model_name": "stg_orders", "normalized_full_path": "elementary_tutorial/models/staging/stg_orders.sql", "fqn": "demo2_0821.public.stg_orders", "artifact_type": "model"}, "model.elementary_tutorial.stg_signups": {"name": "stg_signups", "unique_id": "model.elementary_tutorial.stg_signups", "owners": [], "tags": [], "package_name": "elementary_tutorial", "description": "", "full_path": "models/staging/stg_signups.sql", "meta": {}, "materialization": "view", "database_name": "demo2_0821", "schema_name": "public", "table_name": "stg_signups", "patch_path": null, "model_name": "stg_signups", "normalized_full_path": "elementary_tutorial/models/staging/stg_signups.sql", "fqn": "demo2_0821.public.stg_signups", "artifact_type": "model"}, "model.elementary_tutorial.test_volume": {"name": "test_volume", "unique_id": "model.elementary_tutorial.test_volume", "owners": [], "tags": [], "package_name": "elementary_tutorial", "description": "", "full_path": "models/staging/test_volume.sql", "meta": {}, "materialization": "view", "database_name": "demo2_0821", "schema_name": "public", "table_name": "test_volume", "patch_path": null, "model_name": "test_volume", "normalized_full_path": "elementary_tutorial/models/staging/test_volume.sql", "fqn": "demo2_0821.public.test_volume", "artifact_type": "model"}, "model.elementary_tutorial.test4schema": {"name": "test4schema", "unique_id": "model.elementary_tutorial.test4schema", "owners": [], "tags": ["PII"], "package_name": "elementary_tutorial", "description": "This table has basic information about a customer, as well as some derived facts based on a customer's orders", "full_path": "models/test4schema.sql", "meta": {}, "materialization": "view", "database_name": "demo2_0821", "schema_name": "public", "table_name": "test4schema", "patch_path": "elementary_tutorial://models/schema.yml", "model_name": "test4schema", "normalized_full_path": "elementary_tutorial/models/test4schema.sql", "fqn": "demo2_0821.public.test4schema", "artifact_type": "model"}}, "groups": {"dbt": {"elementary_tutorial": {"models": {"__files__": [{"node_id": "model.elementary_tutorial.returned_orders", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.test4_volume_anomaly", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.customers", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.orders", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.test4_column_anomaly", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.test4schema", "resource_type": "model"}], "staging": {"__files__": [{"node_id": "model.elementary_tutorial.stg_customers", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.test_practice", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.stg_payments", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.stg_orders", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.stg_signups", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.test_volume", "resource_type": "model"}]}}, "tests": {"__files__": [{"node_id": "test.elementary_tutorial.test4_dbt_test", "resource_type": "test"}]}}}, "tags": {"finance": [{"node_id": "model.elementary_tutorial.returned_orders", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.orders", "resource_type": "model"}], "PII": [{"node_id": "model.elementary_tutorial.test4_volume_anomaly", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.customers", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.test4_column_anomaly", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.test4schema", "resource_type": "model"}], "No tags": [{"node_id": "model.elementary_tutorial.stg_customers", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.test_practice", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.stg_payments", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.stg_orders", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.stg_signups", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.test_volume", "resource_type": "model"}, {"node_id": "test.elementary_tutorial.test4_dbt_test", "resource_type": "test"}]}, "owners": {"No owners": [{"node_id": "model.elementary_tutorial.returned_orders", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.test4_volume_anomaly", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.customers", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.orders", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.test4_column_anomaly", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.stg_customers", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.test_practice", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.stg_payments", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.stg_orders", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.stg_signups", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.test_volume", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.test4schema", "resource_type": "model"}, {"node_id": "test.elementary_tutorial.test4_dbt_test", "resource_type": "test"}]}}, "invocation": {"invocation_id": null, "detected_at": null, "command": null, "selected": null, "full_refresh": null, "job_url": null, "job_name": null, "job_id": null, "orchestrator": null}, "test_results": {"test.elementary_tutorial.test4_dbt_test": [{"metadata": {"test_unique_id": "test.elementary_tutorial.test4_dbt_test", "elementary_unique_id": "test.elementary_tutorial.test4_dbt_test.None.singular", "database_name": "demo2_0821", "schema_name": "public", "table_name": "test_practice", "column_name": null, "test_name": "test4_dbt_test", "test_display_name": "Test4 Dbt Test", "original_path": "tests/test4_dbt_test.sql", "latest_run_time": "2024-08-21T17:06:11+08:00", "latest_run_time_utc": "2024-08-21T09:06:11+00:00", "latest_run_status": "fail", "model_unique_id": "model.elementary_tutorial.test_practice", "table_unique_id": "demo2_0821.public.test_practice", "test_type": "dbt_test", "test_sub_type": "singular", "test_query": "-- tests/check_record_count.sql\n\nwith actual_count as (\n    select\n        count(*) as actual_count\n    from \"demo2_0821\".\"public\".\"test_practice\"\n),\nexpected_count as (\n    select 300 as expected_count\n)\n\nselect\n    actual_count,\n    expected_count\nfrom actual_count, expected_count\nwhere actual_count != expected_count", "test_params": {}, "test_created_at": null, "description": null, "result": {"result_description": "Got 1 result, configured to fail if != 0", "result_query": "-- tests/check_record_count.sql\n\nwith actual_count as (\n    select\n        count(*) as actual_count\n    from \"demo2_0821\".\"public\".\"test_practice\"\n),\nexpected_count as (\n    select 300 as expected_count\n)\n\nselect\n    actual_count,\n    expected_count\nfrom actual_count, expected_count\nwhere actual_count != expected_count"}, "configuration": {"test_name": "test4_dbt_test", "test_params": {}}, "test_tags": [], "normalized_full_path": "elementary_tutorial/tests/test4_dbt_test.sql"}, "test_results": {"display_name": "test4_dbt_test", "results_sample": [{"actual_count": 649, "expected_count": 300}], "error_message": "Got 1 result, configured to fail if != 0", "failed_rows_count": 1}}], "model.elementary_tutorial.test4schema": [{"metadata": {"test_unique_id": "test.elementary_tutorial.elementary_schema_changes_test4schema_.5b49e3c366", "elementary_unique_id": "test.elementary_tutorial.elementary_schema_changes_test4schema_.5b49e3c366", "database_name": "demo2_0821", "schema_name": "public", "table_name": "test4schema", "column_name": null, "test_name": "schema_changes", "test_display_name": "Schema Changes", "original_path": "models/schema.yml", "latest_run_time": "2024-08-21T17:06:12+08:00", "latest_run_time_utc": "2024-08-21T09:06:12+00:00", "latest_run_status": "pass", "model_unique_id": "model.elementary_tutorial.test4schema", "table_unique_id": "demo2_0821.public.test4schema", "test_type": "schema_change", "test_sub_type": "generic", "test_query": "select * from \"demo2_0821\".\"public\".\"test_5b49e3c36__schema_changes_alerts__tmp_20240821090610921185\"", "test_params": {"model": "{{ get_where_subquery(ref('test4schema')) }}"}, "test_created_at": null, "description": "Monitors schema changes on the table of deleted, added, type changed columns over time. The test will fail if the table's schema changed from the previous execution of the test.", "result": {"result_description": null, "result_query": "select * from \"demo2_0821\".\"public\".\"test_5b49e3c36__schema_changes_alerts__tmp_20240821090610921185\""}, "configuration": {"test_name": "schema_changes", "timestamp_column": null, "testing_timeframe": "1 day", "anomaly_threshold": null}, "test_tags": ["elementary", "elementary-tests"], "normalized_full_path": "elementary_tutorial/models/schema.yml"}, "test_results": {"display_name": "generic", "metrics": null, "result_description": null}}], "model.elementary_tutorial.customers": [{"metadata": {"test_unique_id": "test.elementary_tutorial.elementary_column_anomalies_customers_zero_count__number_of_orders__signup_date.e012735381", "elementary_unique_id": "test.elementary_tutorial.elementary_column_anomalies_customers_zero_count__number_of_orders__signup_date.e012735381.number_of_orders.generic", "database_name": "demo2_0821", "schema_name": "public", "table_name": "customers", "column_name": "number_of_orders", "test_name": "column_anomalies", "test_display_name": "Column Anomalies", "original_path": "models/schema.yml", "latest_run_time": "2024-08-21T17:06:12+08:00", "latest_run_time_utc": "2024-08-21T09:06:12+00:00", "latest_run_status": "pass", "model_unique_id": "model.elementary_tutorial.customers", "table_unique_id": "demo2_0821.public.customers", "test_type": "anomaly_detection", "test_sub_type": "generic", "test_query": "select * from (with anomaly_scores as (\n        select\n            id,\n            metric_id,\n            test_execution_id,\n            test_unique_id,\n            detected_at,\n            full_table_name,\n            column_name,\n            metric_name,\n            anomaly_score,\n            anomaly_score_threshold,\n            anomalous_value,\n            bucket_start,\n            bucket_end,\n            bucket_seasonality,\n            metric_value,\n            min_metric_value,\n            max_metric_value,\n            training_avg,\n            training_stddev,\n            training_set_size,\n            training_start,\n            training_end,\n            dimension,\n            dimension_value,\n            \n    case\n        when dimension is not null and column_name is null then \n    'The last ' || metric_name || ' value for dimension ' || dimension || ' - ' ||\n    case when dimension_value is null then 'NULL' else dimension_value end || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when dimension is not null and column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value for dimension ' || dimension || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when metric_name = 'freshness' then \n    'Last update was at ' || anomalous_value || ', ' || cast(abs(round(cast(metric_value/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours ago. Usually the table is updated within ' || cast(abs(round(cast(training_avg/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours.'\n\n        when column_name is null then \n    'The last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        else null\n    end as anomaly_description\n,\n            max(bucket_end) over (partition by test_execution_id) as max_bucket_end\n        from \"demo2_0821\".\"public\".\"test_e012735381_eleme__anomaly_scores__tmp_20240821090609590753\"\n      ),\n      anomaly_scores_with_is_anomalous as (\n        select\n          *,\ncase when\n          (\n            \n  (anomaly_score is not null and\n  (\n    \n  (\n    metric_value = 0 and \n    \n      1 = 2\n    \n  )\n or\n    (\n      case when metric_name IN \n        ( 'freshness' ,  'event_freshness'  )\n then\n            anomaly_score > 3\n    else\n        \n        abs(anomaly_score) > 3\n    \n\n     end and\n      (\n  \n  \n  \n  \n    \n        (1 = 1)\n    \n\n    and\n\n    \n        (1 = 1)\n    \n  \n  )\n    )\n  ))\n\n          )\n          and bucket_end >= \n    cast(max_bucket_end as timestamp) + cast('-2' as integer) * INTERVAL '1 day'\n\n          then TRUE else FALSE end as is_anomalous\n        from anomaly_scores\n      ),\n\n      final_results as (\n          select\n          metric_value as value,\n          training_avg as average,\n          \n          case\n          when is_anomalous = TRUE and 'both' = 'spike' then\n          lag(metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when is_anomalous = TRUE and 'both' != 'spike' then\n          lag(min_metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when 'both' = 'spike' then metric_value\n          else min_metric_value end as min_value,\n          case\n          when is_anomalous = TRUE and 'both' = 'drop' then\n          lag(metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when is_anomalous = TRUE and 'both' != 'drop' then\n          lag(max_metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when 'both' = 'drop' then metric_value\n          else max_metric_value end as max_value,\n          bucket_start as start_time,\n          bucket_end as end_time,\n          *\n        from anomaly_scores_with_is_anomalous\n        order by bucket_end, dimension_value\n      )\n\n      select * from final_results\n      where 1 = 1) results\n    where is_anomalous = true", "test_params": {"column_anomalies": ["zero_count"], "timestamp_column": "signup_date", "column_name": "number_of_orders", "model": "{{ get_where_subquery(ref('customers')) }}"}, "test_created_at": null, "description": "Column-level anomaly monitors (null_count, null_percent, zero_count, string_length, variance, etc.) on the column according to its data type.", "result": {"result_description": null, "result_query": "select * from (with anomaly_scores as (\n        select\n            id,\n            metric_id,\n            test_execution_id,\n            test_unique_id,\n            detected_at,\n            full_table_name,\n            column_name,\n            metric_name,\n            anomaly_score,\n            anomaly_score_threshold,\n            anomalous_value,\n            bucket_start,\n            bucket_end,\n            bucket_seasonality,\n            metric_value,\n            min_metric_value,\n            max_metric_value,\n            training_avg,\n            training_stddev,\n            training_set_size,\n            training_start,\n            training_end,\n            dimension,\n            dimension_value,\n            \n    case\n        when dimension is not null and column_name is null then \n    'The last ' || metric_name || ' value for dimension ' || dimension || ' - ' ||\n    case when dimension_value is null then 'NULL' else dimension_value end || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when dimension is not null and column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value for dimension ' || dimension || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when metric_name = 'freshness' then \n    'Last update was at ' || anomalous_value || ', ' || cast(abs(round(cast(metric_value/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours ago. Usually the table is updated within ' || cast(abs(round(cast(training_avg/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours.'\n\n        when column_name is null then \n    'The last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        else null\n    end as anomaly_description\n,\n            max(bucket_end) over (partition by test_execution_id) as max_bucket_end\n        from \"demo2_0821\".\"public\".\"test_e012735381_eleme__anomaly_scores__tmp_20240821090609590753\"\n      ),\n      anomaly_scores_with_is_anomalous as (\n        select\n          *,\ncase when\n          (\n            \n  (anomaly_score is not null and\n  (\n    \n  (\n    metric_value = 0 and \n    \n      1 = 2\n    \n  )\n or\n    (\n      case when metric_name IN \n        ( 'freshness' ,  'event_freshness'  )\n then\n            anomaly_score > 3\n    else\n        \n        abs(anomaly_score) > 3\n    \n\n     end and\n      (\n  \n  \n  \n  \n    \n        (1 = 1)\n    \n\n    and\n\n    \n        (1 = 1)\n    \n  \n  )\n    )\n  ))\n\n          )\n          and bucket_end >= \n    cast(max_bucket_end as timestamp) + cast('-2' as integer) * INTERVAL '1 day'\n\n          then TRUE else FALSE end as is_anomalous\n        from anomaly_scores\n      ),\n\n      final_results as (\n          select\n          metric_value as value,\n          training_avg as average,\n          \n          case\n          when is_anomalous = TRUE and 'both' = 'spike' then\n          lag(metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when is_anomalous = TRUE and 'both' != 'spike' then\n          lag(min_metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when 'both' = 'spike' then metric_value\n          else min_metric_value end as min_value,\n          case\n          when is_anomalous = TRUE and 'both' = 'drop' then\n          lag(metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when is_anomalous = TRUE and 'both' != 'drop' then\n          lag(max_metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when 'both' = 'drop' then metric_value\n          else max_metric_value end as max_value,\n          bucket_start as start_time,\n          bucket_end as end_time,\n          *\n        from anomaly_scores_with_is_anomalous\n        order by bucket_end, dimension_value\n      )\n\n      select * from final_results\n      where 1 = 1) results\n    where is_anomalous = true"}, "configuration": {"test_name": "column_anomalies", "timestamp_column": "signup_date", "testing_timeframe": "1 day", "anomaly_threshold": null}, "test_tags": ["column_anomalies", "elementary-tests"], "normalized_full_path": "elementary_tutorial/models/schema.yml"}, "test_results": {"display_name": "Generic", "metrics": [], "result_description": null}}, {"metadata": {"test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_customers_1.f225f4677c", "elementary_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_customers_1.f225f4677c.None.row_count", "database_name": "demo2_0821", "schema_name": "public", "table_name": "customers", "column_name": null, "test_name": "volume_anomalies", "test_display_name": "Volume Anomalies", "original_path": "models/schema.yml", "latest_run_time": "2024-08-21T17:06:11+08:00", "latest_run_time_utc": "2024-08-21T09:06:11+00:00", "latest_run_status": "pass", "model_unique_id": "model.elementary_tutorial.customers", "table_unique_id": "demo2_0821.public.customers", "test_type": "anomaly_detection", "test_sub_type": "row_count", "test_query": "select * from (None) results\n      where\n        anomaly_score is not null and\n        upper(full_table_name) = upper(cast('DEMO2_0821.PUBLIC.CUSTOMERS' as varchar(4096))) and\n        metric_name = cast('row_count' as varchar(4096))", "test_params": {"anomaly_sensitivity": 1, "model": "{{ get_where_subquery(ref('customers')) }}", "timestamp_column": "signup_date", "where_expression": null, "anomaly_direction": "both", "time_bucket": {"period": "day", "count": 1}, "days_back": 14, "backfill_days": 2, "seasonality": null, "freshness_column": null, "event_timestamp_column": null, "dimensions": null, "ignore_small_changes": {"spike_failure_percent_threshold": null, "drop_failure_percent_threshold": null}, "fail_on_zero": false, "detection_delay": {"period": "hour", "count": 0}, "anomaly_exclude_metrics": null, "exclude_final_results": "1 = 1"}, "test_created_at": null, "description": "Monitors the row count of your table over time.", "result": {"result_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "result_query": "select * from (None) results\n      where\n        anomaly_score is not null and\n        upper(full_table_name) = upper(cast('DEMO2_0821.PUBLIC.CUSTOMERS' as varchar(4096))) and\n        metric_name = cast('row_count' as varchar(4096))"}, "configuration": {"test_name": "volume_anomalies", "timestamp_column": "signup_date", "testing_timeframe": "1 day", "anomaly_threshold": 1}, "test_tags": ["elementary-tests", "volume_anomalies"], "normalized_full_path": "elementary_tutorial/models/schema.yml"}, "test_results": {"display_name": "Row Count", "metrics": [{"value": 0.0, "average": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-08T00:00:00", "end_time": "2024-08-09T00:00:00", "id": "80d03c0f1a4186af709264ffe182c454", "metric_id": "759f16e807176023312d40cf5b31d0b1", "test_execution_id": "53eb2540-e1b2-47de-9b7d-2ab627db3fc9.test.elementary_tutorial.elementary_volume_anomalies_customers_1.f225f4677c", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_customers_1.f225f4677c", "detected_at": "2024-08-21T09:06:11.217778", "full_table_name": "DEMO2_0821.PUBLIC.CUSTOMERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0.0, "anomaly_score_threshold": 1, "anomalous_value": null, "bucket_start": "2024-08-08T00:00:00", "bucket_end": "2024-08-09T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 0.0, "training_avg": 0.0, "training_stddev": 0.0, "training_set_size": 2, "training_start": "2024-08-08T00:00:00", "training_end": "2024-08-09T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2024-08-21T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-09T00:00:00", "end_time": "2024-08-10T00:00:00", "id": "cc85a8c71dd79434f62c6fdd9b922f63", "metric_id": "de098ab2a44a7cff2939e876817a969f", "test_execution_id": "53eb2540-e1b2-47de-9b7d-2ab627db3fc9.test.elementary_tutorial.elementary_volume_anomalies_customers_1.f225f4677c", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_customers_1.f225f4677c", "detected_at": "2024-08-21T09:06:11.217778", "full_table_name": "DEMO2_0821.PUBLIC.CUSTOMERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0.0, "anomaly_score_threshold": 1, "anomalous_value": null, "bucket_start": "2024-08-09T00:00:00", "bucket_end": "2024-08-10T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 0.0, "training_avg": 0.0, "training_stddev": 0.0, "training_set_size": 3, "training_start": "2024-08-08T00:00:00", "training_end": "2024-08-10T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2024-08-21T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-10T00:00:00", "end_time": "2024-08-11T00:00:00", "id": "bc8edcf449da3354b3fcf5120fe7826f", "metric_id": "4c8acd0a3607e6cf8df56a136a29df15", "test_execution_id": "53eb2540-e1b2-47de-9b7d-2ab627db3fc9.test.elementary_tutorial.elementary_volume_anomalies_customers_1.f225f4677c", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_customers_1.f225f4677c", "detected_at": "2024-08-21T09:06:11.217778", "full_table_name": "DEMO2_0821.PUBLIC.CUSTOMERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0.0, "anomaly_score_threshold": 1, "anomalous_value": null, "bucket_start": "2024-08-10T00:00:00", "bucket_end": "2024-08-11T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 0.0, "training_avg": 0.0, "training_stddev": 0.0, "training_set_size": 4, "training_start": "2024-08-08T00:00:00", "training_end": "2024-08-11T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2024-08-21T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-11T00:00:00", "end_time": "2024-08-12T00:00:00", "id": "a0e511364fb4e311506de0dc6d497d68", "metric_id": "394bf8fb787792552fe853a0c701d387", "test_execution_id": "53eb2540-e1b2-47de-9b7d-2ab627db3fc9.test.elementary_tutorial.elementary_volume_anomalies_customers_1.f225f4677c", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_customers_1.f225f4677c", "detected_at": "2024-08-21T09:06:11.217778", "full_table_name": "DEMO2_0821.PUBLIC.CUSTOMERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0.0, "anomaly_score_threshold": 1, "anomalous_value": null, "bucket_start": "2024-08-11T00:00:00", "bucket_end": "2024-08-12T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 0.0, "training_avg": 0.0, "training_stddev": 0.0, "training_set_size": 5, "training_start": "2024-08-08T00:00:00", "training_end": "2024-08-12T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2024-08-21T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-12T00:00:00", "end_time": "2024-08-13T00:00:00", "id": "2f2fbf781bf4cb38f252bbc18fd59348", "metric_id": "c43c7a73e293e4b449bb5fed2562ef9c", "test_execution_id": "53eb2540-e1b2-47de-9b7d-2ab627db3fc9.test.elementary_tutorial.elementary_volume_anomalies_customers_1.f225f4677c", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_customers_1.f225f4677c", "detected_at": "2024-08-21T09:06:11.217778", "full_table_name": "DEMO2_0821.PUBLIC.CUSTOMERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0.0, "anomaly_score_threshold": 1, "anomalous_value": null, "bucket_start": "2024-08-12T00:00:00", "bucket_end": "2024-08-13T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 0.0, "training_avg": 0.0, "training_stddev": 0.0, "training_set_size": 6, "training_start": "2024-08-08T00:00:00", "training_end": "2024-08-13T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2024-08-21T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-13T00:00:00", "end_time": "2024-08-14T00:00:00", "id": "2f80e293060deba64831dcdf747c381e", "metric_id": "624d2b96988c373b5cf965bb6bc64182", "test_execution_id": "53eb2540-e1b2-47de-9b7d-2ab627db3fc9.test.elementary_tutorial.elementary_volume_anomalies_customers_1.f225f4677c", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_customers_1.f225f4677c", "detected_at": "2024-08-21T09:06:11.217778", "full_table_name": "DEMO2_0821.PUBLIC.CUSTOMERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0.0, "anomaly_score_threshold": 1, "anomalous_value": null, "bucket_start": "2024-08-13T00:00:00", "bucket_end": "2024-08-14T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 0.0, "training_avg": 0.0, "training_stddev": 0.0, "training_set_size": 7, "training_start": "2024-08-08T00:00:00", "training_end": "2024-08-14T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2024-08-21T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-14T00:00:00", "end_time": "2024-08-15T00:00:00", "id": "b7bfa0c20279f13b2cb08080c44166fd", "metric_id": "ecb959363c3e1604f24f1a1bb77507a2", "test_execution_id": "53eb2540-e1b2-47de-9b7d-2ab627db3fc9.test.elementary_tutorial.elementary_volume_anomalies_customers_1.f225f4677c", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_customers_1.f225f4677c", "detected_at": "2024-08-21T09:06:11.217778", "full_table_name": "DEMO2_0821.PUBLIC.CUSTOMERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0.0, "anomaly_score_threshold": 1, "anomalous_value": null, "bucket_start": "2024-08-14T00:00:00", "bucket_end": "2024-08-15T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 0.0, "training_avg": 0.0, "training_stddev": 0.0, "training_set_size": 8, "training_start": "2024-08-08T00:00:00", "training_end": "2024-08-15T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2024-08-21T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-15T00:00:00", "end_time": "2024-08-16T00:00:00", "id": "3310cf6fa55d2d202365b9b3bee6f83a", "metric_id": "2a0318afcebbac39ad56ff18696874b4", "test_execution_id": "53eb2540-e1b2-47de-9b7d-2ab627db3fc9.test.elementary_tutorial.elementary_volume_anomalies_customers_1.f225f4677c", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_customers_1.f225f4677c", "detected_at": "2024-08-21T09:06:11.217778", "full_table_name": "DEMO2_0821.PUBLIC.CUSTOMERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0.0, "anomaly_score_threshold": 1, "anomalous_value": null, "bucket_start": "2024-08-15T00:00:00", "bucket_end": "2024-08-16T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 0.0, "training_avg": 0.0, "training_stddev": 0.0, "training_set_size": 9, "training_start": "2024-08-08T00:00:00", "training_end": "2024-08-16T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2024-08-21T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-16T00:00:00", "end_time": "2024-08-17T00:00:00", "id": "75147d95ad578f3a6836b5d2a1bfed21", "metric_id": "1c97d35cd6fb3d18bd3b9f81469e3179", "test_execution_id": "53eb2540-e1b2-47de-9b7d-2ab627db3fc9.test.elementary_tutorial.elementary_volume_anomalies_customers_1.f225f4677c", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_customers_1.f225f4677c", "detected_at": "2024-08-21T09:06:11.217778", "full_table_name": "DEMO2_0821.PUBLIC.CUSTOMERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0.0, "anomaly_score_threshold": 1, "anomalous_value": null, "bucket_start": "2024-08-16T00:00:00", "bucket_end": "2024-08-17T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 0.0, "training_avg": 0.0, "training_stddev": 0.0, "training_set_size": 10, "training_start": "2024-08-08T00:00:00", "training_end": "2024-08-17T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2024-08-21T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-17T00:00:00", "end_time": "2024-08-18T00:00:00", "id": "0898c3a5fde454d5c92c86089904241c", "metric_id": "e69138e27e3eb7654d3baa50daa66bda", "test_execution_id": "53eb2540-e1b2-47de-9b7d-2ab627db3fc9.test.elementary_tutorial.elementary_volume_anomalies_customers_1.f225f4677c", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_customers_1.f225f4677c", "detected_at": "2024-08-21T09:06:11.217778", "full_table_name": "DEMO2_0821.PUBLIC.CUSTOMERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0.0, "anomaly_score_threshold": 1, "anomalous_value": null, "bucket_start": "2024-08-17T00:00:00", "bucket_end": "2024-08-18T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 0.0, "training_avg": 0.0, "training_stddev": 0.0, "training_set_size": 11, "training_start": "2024-08-08T00:00:00", "training_end": "2024-08-18T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2024-08-21T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-18T00:00:00", "end_time": "2024-08-19T00:00:00", "id": "92b05bc640519e20c1784c066af8882f", "metric_id": "768971d65c1ab8027a7b1d591103c027", "test_execution_id": "53eb2540-e1b2-47de-9b7d-2ab627db3fc9.test.elementary_tutorial.elementary_volume_anomalies_customers_1.f225f4677c", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_customers_1.f225f4677c", "detected_at": "2024-08-21T09:06:11.217778", "full_table_name": "DEMO2_0821.PUBLIC.CUSTOMERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0.0, "anomaly_score_threshold": 1, "anomalous_value": null, "bucket_start": "2024-08-18T00:00:00", "bucket_end": "2024-08-19T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 0.0, "training_avg": 0.0, "training_stddev": 0.0, "training_set_size": 12, "training_start": "2024-08-08T00:00:00", "training_end": "2024-08-19T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2024-08-21T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-19T00:00:00", "end_time": "2024-08-20T00:00:00", "id": "be864f05b99f8c74816ca9fe18f38bbb", "metric_id": "42e75dda94b91bac2bd35720d8cc367b", "test_execution_id": "53eb2540-e1b2-47de-9b7d-2ab627db3fc9.test.elementary_tutorial.elementary_volume_anomalies_customers_1.f225f4677c", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_customers_1.f225f4677c", "detected_at": "2024-08-21T09:06:11.217778", "full_table_name": "DEMO2_0821.PUBLIC.CUSTOMERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0.0, "anomaly_score_threshold": 1, "anomalous_value": null, "bucket_start": "2024-08-19T00:00:00", "bucket_end": "2024-08-20T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 0.0, "training_avg": 0.0, "training_stddev": 0.0, "training_set_size": 13, "training_start": "2024-08-08T00:00:00", "training_end": "2024-08-20T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2024-08-21T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-20T00:00:00", "end_time": "2024-08-21T00:00:00", "id": "3918d0a4bf62c635d0ed136a5dab08b5", "metric_id": "07a8b078ccd64da02ef026b1d0ba6522", "test_execution_id": "53eb2540-e1b2-47de-9b7d-2ab627db3fc9.test.elementary_tutorial.elementary_volume_anomalies_customers_1.f225f4677c", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_customers_1.f225f4677c", "detected_at": "2024-08-21T09:06:11.217778", "full_table_name": "DEMO2_0821.PUBLIC.CUSTOMERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0.0, "anomaly_score_threshold": 1, "anomalous_value": null, "bucket_start": "2024-08-20T00:00:00", "bucket_end": "2024-08-21T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 0.0, "training_avg": 0.0, "training_stddev": 0.0, "training_set_size": 14, "training_start": "2024-08-08T00:00:00", "training_end": "2024-08-21T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2024-08-21T00:00:00", "is_anomalous": false}], "result_description": "The last row_count value is 0.000. The average for this metric is 0.000."}}], "model.elementary_tutorial.test4_volume_anomaly": [{"metadata": {"test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_test4_volume_anomaly_1.22dd1cb7dd", "elementary_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_test4_volume_anomaly_1.22dd1cb7dd.None.row_count", "database_name": "demo2_0821", "schema_name": "public", "table_name": "test4_volume_anomaly", "column_name": null, "test_name": "volume_anomalies", "test_display_name": "Volume Anomalies", "original_path": "models/schema.yml", "latest_run_time": "2024-08-21T17:06:11+08:00", "latest_run_time_utc": "2024-08-21T09:06:11+00:00", "latest_run_status": "pass", "model_unique_id": "model.elementary_tutorial.test4_volume_anomaly", "table_unique_id": "demo2_0821.public.test4_volume_anomaly", "test_type": "anomaly_detection", "test_sub_type": "row_count", "test_query": "select * from (None) results\n      where\n        anomaly_score is not null and\n        upper(full_table_name) = upper(cast('DEMO2_0821.PUBLIC.TEST4_VOLUME_ANOMALY' as varchar(4096))) and\n        metric_name = cast('row_count' as varchar(4096))", "test_params": {"anomaly_sensitivity": 1, "model": "{{ get_where_subquery(ref('test4_volume_anomaly')) }}", "timestamp_column": "birth", "where_expression": null, "anomaly_direction": "both", "time_bucket": {"period": "day", "count": 1}, "days_back": 14, "backfill_days": 2, "seasonality": null, "freshness_column": null, "event_timestamp_column": null, "dimensions": null, "ignore_small_changes": {"spike_failure_percent_threshold": null, "drop_failure_percent_threshold": null}, "fail_on_zero": false, "detection_delay": {"period": "hour", "count": 0}, "anomaly_exclude_metrics": null, "exclude_final_results": "1 = 1"}, "test_created_at": null, "description": "Monitors the row count of your table over time.", "result": {"result_description": "The last row_count value is 0.000. The average for this metric is 209.286.", "result_query": "select * from (None) results\n      where\n        anomaly_score is not null and\n        upper(full_table_name) = upper(cast('DEMO2_0821.PUBLIC.TEST4_VOLUME_ANOMALY' as varchar(4096))) and\n        metric_name = cast('row_count' as varchar(4096))"}, "configuration": {"test_name": "volume_anomalies", "timestamp_column": "birth", "testing_timeframe": "1 day", "anomaly_threshold": 1}, "test_tags": ["column_test", "elementary-tests"], "normalized_full_path": "elementary_tutorial/models/schema.yml"}, "test_results": {"display_name": "Row Count", "metrics": [{"value": 0.0, "average": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-08T00:00:00", "end_time": "2024-08-09T00:00:00", "id": "819f8d24307e30064698a1feec00e2a0", "metric_id": "e098b5106645802c25746b7c418ceda6", "test_execution_id": "53eb2540-e1b2-47de-9b7d-2ab627db3fc9.test.elementary_tutorial.elementary_volume_anomalies_test4_volume_anomaly_1.22dd1cb7dd", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_test4_volume_anomaly_1.22dd1cb7dd", "detected_at": "2024-08-21T09:06:11.801947", "full_table_name": "DEMO2_0821.PUBLIC.TEST4_VOLUME_ANOMALY", "column_name": null, "metric_name": "row_count", "anomaly_score": 0.0, "anomaly_score_threshold": 1, "anomalous_value": null, "bucket_start": "2024-08-08T00:00:00", "bucket_end": "2024-08-09T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 0.0, "training_avg": 0.0, "training_stddev": 0.0, "training_set_size": 2, "training_start": "2024-08-08T00:00:00", "training_end": "2024-08-09T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2024-08-21T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-09T00:00:00", "end_time": "2024-08-10T00:00:00", "id": "ebc7c3a3c957a700a154f2e94ba7eb95", "metric_id": "3c01dded998a2d9cee5b8c6f7f029511", "test_execution_id": "53eb2540-e1b2-47de-9b7d-2ab627db3fc9.test.elementary_tutorial.elementary_volume_anomalies_test4_volume_anomaly_1.22dd1cb7dd", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_test4_volume_anomaly_1.22dd1cb7dd", "detected_at": "2024-08-21T09:06:11.801947", "full_table_name": "DEMO2_0821.PUBLIC.TEST4_VOLUME_ANOMALY", "column_name": null, "metric_name": "row_count", "anomaly_score": 0.0, "anomaly_score_threshold": 1, "anomalous_value": null, "bucket_start": "2024-08-09T00:00:00", "bucket_end": "2024-08-10T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 0.0, "training_avg": 0.0, "training_stddev": 0.0, "training_set_size": 3, "training_start": "2024-08-08T00:00:00", "training_end": "2024-08-10T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2024-08-21T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-10T00:00:00", "end_time": "2024-08-11T00:00:00", "id": "81171eb7b5a486821f9c73f0bd28cf83", "metric_id": "fa843575709cac77dfa70fe8b02df6e2", "test_execution_id": "53eb2540-e1b2-47de-9b7d-2ab627db3fc9.test.elementary_tutorial.elementary_volume_anomalies_test4_volume_anomaly_1.22dd1cb7dd", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_test4_volume_anomaly_1.22dd1cb7dd", "detected_at": "2024-08-21T09:06:11.801947", "full_table_name": "DEMO2_0821.PUBLIC.TEST4_VOLUME_ANOMALY", "column_name": null, "metric_name": "row_count", "anomaly_score": 0.0, "anomaly_score_threshold": 1, "anomalous_value": null, "bucket_start": "2024-08-10T00:00:00", "bucket_end": "2024-08-11T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 0.0, "training_avg": 0.0, "training_stddev": 0.0, "training_set_size": 4, "training_start": "2024-08-08T00:00:00", "training_end": "2024-08-11T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2024-08-21T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-11T00:00:00", "end_time": "2024-08-12T00:00:00", "id": "c57aaabc180f767bb1697812d62dfe9a", "metric_id": "3ae5f58268b0cc240b359c58a9663c14", "test_execution_id": "53eb2540-e1b2-47de-9b7d-2ab627db3fc9.test.elementary_tutorial.elementary_volume_anomalies_test4_volume_anomaly_1.22dd1cb7dd", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_test4_volume_anomaly_1.22dd1cb7dd", "detected_at": "2024-08-21T09:06:11.801947", "full_table_name": "DEMO2_0821.PUBLIC.TEST4_VOLUME_ANOMALY", "column_name": null, "metric_name": "row_count", "anomaly_score": 0.0, "anomaly_score_threshold": 1, "anomalous_value": null, "bucket_start": "2024-08-11T00:00:00", "bucket_end": "2024-08-12T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 0.0, "training_avg": 0.0, "training_stddev": 0.0, "training_set_size": 5, "training_start": "2024-08-08T00:00:00", "training_end": "2024-08-12T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2024-08-21T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-12T00:00:00", "end_time": "2024-08-13T00:00:00", "id": "2cdbdbd7195881c0717d0ed0bbe24167", "metric_id": "bee453bc6552bd023c89deebdd8d9c96", "test_execution_id": "53eb2540-e1b2-47de-9b7d-2ab627db3fc9.test.elementary_tutorial.elementary_volume_anomalies_test4_volume_anomaly_1.22dd1cb7dd", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_test4_volume_anomaly_1.22dd1cb7dd", "detected_at": "2024-08-21T09:06:11.801947", "full_table_name": "DEMO2_0821.PUBLIC.TEST4_VOLUME_ANOMALY", "column_name": null, "metric_name": "row_count", "anomaly_score": 0.0, "anomaly_score_threshold": 1, "anomalous_value": null, "bucket_start": "2024-08-12T00:00:00", "bucket_end": "2024-08-13T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 0.0, "training_avg": 0.0, "training_stddev": 0.0, "training_set_size": 6, "training_start": "2024-08-08T00:00:00", "training_end": "2024-08-13T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2024-08-21T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-13T00:00:00", "end_time": "2024-08-14T00:00:00", "id": "c682785362d7fc8feda2bd206bdc5dae", "metric_id": "ffe9d43808fed2611c9407f605d4b8ce", "test_execution_id": "53eb2540-e1b2-47de-9b7d-2ab627db3fc9.test.elementary_tutorial.elementary_volume_anomalies_test4_volume_anomaly_1.22dd1cb7dd", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_test4_volume_anomaly_1.22dd1cb7dd", "detected_at": "2024-08-21T09:06:11.801947", "full_table_name": "DEMO2_0821.PUBLIC.TEST4_VOLUME_ANOMALY", "column_name": null, "metric_name": "row_count", "anomaly_score": 0.0, "anomaly_score_threshold": 1, "anomalous_value": null, "bucket_start": "2024-08-13T00:00:00", "bucket_end": "2024-08-14T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 0.0, "training_avg": 0.0, "training_stddev": 0.0, "training_set_size": 7, "training_start": "2024-08-08T00:00:00", "training_end": "2024-08-14T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2024-08-21T00:00:00", "is_anomalous": false}, {"value": 15.0, "average": 1.875, "min_value": 0.0, "max_value": 7.178300858899107, "start_time": "2024-08-14T00:00:00", "end_time": "2024-08-15T00:00:00", "id": "59e4b325e4909cf1ec5de950025e7ec6", "metric_id": "7c694f6bb22bfb917efdd181b040932a", "test_execution_id": "53eb2540-e1b2-47de-9b7d-2ab627db3fc9.test.elementary_tutorial.elementary_volume_anomalies_test4_volume_anomaly_1.22dd1cb7dd", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_test4_volume_anomaly_1.22dd1cb7dd", "detected_at": "2024-08-21T09:06:11.801947", "full_table_name": "DEMO2_0821.PUBLIC.TEST4_VOLUME_ANOMALY", "column_name": null, "metric_name": "row_count", "anomaly_score": 2.4748737341529163, "anomaly_score_threshold": 1, "anomalous_value": null, "bucket_start": "2024-08-14T00:00:00", "bucket_end": "2024-08-15T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 15.0, "min_metric_value": 0.0, "max_metric_value": 7.178300858899107, "training_avg": 1.875, "training_stddev": 5.303300858899107, "training_set_size": 8, "training_start": "2024-08-08T00:00:00", "training_end": "2024-08-15T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 15.000. The average for this metric is 1.875.", "max_bucket_end": "2024-08-21T00:00:00", "is_anomalous": false}, {"value": 5.0, "average": 2.2222222222222223, "min_value": 0.0, "max_value": 7.291190997470738, "start_time": "2024-08-15T00:00:00", "end_time": "2024-08-16T00:00:00", "id": "3989367804a6f22451b65869a786d6e9", "metric_id": "121caa57cae9e86b7cad20f9bd34fa3f", "test_execution_id": "53eb2540-e1b2-47de-9b7d-2ab627db3fc9.test.elementary_tutorial.elementary_volume_anomalies_test4_volume_anomaly_1.22dd1cb7dd", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_test4_volume_anomaly_1.22dd1cb7dd", "detected_at": "2024-08-21T09:06:11.801947", "full_table_name": "DEMO2_0821.PUBLIC.TEST4_VOLUME_ANOMALY", "column_name": null, "metric_name": "row_count", "anomaly_score": 0.547996624351191, "anomaly_score_threshold": 1, "anomalous_value": null, "bucket_start": "2024-08-15T00:00:00", "bucket_end": "2024-08-16T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 5.0, "min_metric_value": 0.0, "max_metric_value": 7.291190997470738, "training_avg": 2.2222222222222223, "training_stddev": 5.068968775248516, "training_set_size": 9, "training_start": "2024-08-08T00:00:00", "training_end": "2024-08-16T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 5.000. The average for this metric is 2.222.", "max_bucket_end": "2024-08-21T00:00:00", "is_anomalous": false}, {"value": 10.0, "average": 3.0, "min_value": 0.0, "max_value": 8.3748384988657, "start_time": "2024-08-16T00:00:00", "end_time": "2024-08-17T00:00:00", "id": "f82bc2aaa3a834b47d4d5ac560285ecd", "metric_id": "848873058a37a21103cc82e157f1c970", "test_execution_id": "53eb2540-e1b2-47de-9b7d-2ab627db3fc9.test.elementary_tutorial.elementary_volume_anomalies_test4_volume_anomaly_1.22dd1cb7dd", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_test4_volume_anomaly_1.22dd1cb7dd", "detected_at": "2024-08-21T09:06:11.801947", "full_table_name": "DEMO2_0821.PUBLIC.TEST4_VOLUME_ANOMALY", "column_name": null, "metric_name": "row_count", "anomaly_score": 1.302364713186689, "anomaly_score_threshold": 1, "anomalous_value": null, "bucket_start": "2024-08-16T00:00:00", "bucket_end": "2024-08-17T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 10.0, "min_metric_value": 0.0, "max_metric_value": 8.3748384988657, "training_avg": 3.0, "training_stddev": 5.374838498865699, "training_set_size": 10, "training_start": "2024-08-08T00:00:00", "training_end": "2024-08-17T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 10.000. The average for this metric is 3.000.", "max_bucket_end": "2024-08-21T00:00:00", "is_anomalous": false}, {"value": 2890.0, "average": 265.45454545454544, "min_value": 0.0, "max_value": 1135.9327316989065, "start_time": "2024-08-17T00:00:00", "end_time": "2024-08-18T00:00:00", "id": "2f991352aa7ec8bb9159fdbe6cf4bf13", "metric_id": "774567b617e86d111b6b4bf729fe4e60", "test_execution_id": "53eb2540-e1b2-47de-9b7d-2ab627db3fc9.test.elementary_tutorial.elementary_volume_anomalies_test4_volume_anomaly_1.22dd1cb7dd", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_test4_volume_anomaly_1.22dd1cb7dd", "detected_at": "2024-08-21T09:06:11.801947", "full_table_name": "DEMO2_0821.PUBLIC.TEST4_VOLUME_ANOMALY", "column_name": null, "metric_name": "row_count", "anomaly_score": 3.0150617166743, "anomaly_score_threshold": 1, "anomalous_value": null, "bucket_start": "2024-08-17T00:00:00", "bucket_end": "2024-08-18T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 2890.0, "min_metric_value": 0.0, "max_metric_value": 1135.9327316989065, "training_avg": 265.45454545454544, "training_stddev": 870.4781862443612, "training_set_size": 11, "training_start": "2024-08-08T00:00:00", "training_end": "2024-08-18T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 2890.000. The average for this metric is 265.455.", "max_bucket_end": "2024-08-21T00:00:00", "is_anomalous": false}, {"value": 5.0, "average": 243.75, "min_value": 0.0, "max_value": 1077.1170068954125, "start_time": "2024-08-18T00:00:00", "end_time": "2024-08-19T00:00:00", "id": "4579222fd71a8c9d1daf799a2b9ee81b", "metric_id": "8f71549663a7cafbe50f6cd6d5871530", "test_execution_id": "53eb2540-e1b2-47de-9b7d-2ab627db3fc9.test.elementary_tutorial.elementary_volume_anomalies_test4_volume_anomaly_1.22dd1cb7dd", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_test4_volume_anomaly_1.22dd1cb7dd", "detected_at": "2024-08-21T09:06:11.801947", "full_table_name": "DEMO2_0821.PUBLIC.TEST4_VOLUME_ANOMALY", "column_name": null, "metric_name": "row_count", "anomaly_score": -0.2864884234971437, "anomaly_score_threshold": 1, "anomalous_value": null, "bucket_start": "2024-08-18T00:00:00", "bucket_end": "2024-08-19T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 5.0, "min_metric_value": 0.0, "max_metric_value": 1077.1170068954125, "training_avg": 243.75, "training_stddev": 833.3670068954124, "training_set_size": 12, "training_start": "2024-08-08T00:00:00", "training_end": "2024-08-19T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 5.000. The average for this metric is 243.750.", "max_bucket_end": "2024-08-21T00:00:00", "is_anomalous": false}, {"value": 5.0, "average": 225.3846153846154, "min_value": 0.0, "max_value": 1026.015776663176, "start_time": "2024-08-19T00:00:00", "end_time": "2024-08-20T00:00:00", "id": "729944b0092e557fa7375b0c2767ab4e", "metric_id": "b041aa5c59d775e606610ddd8b606401", "test_execution_id": "53eb2540-e1b2-47de-9b7d-2ab627db3fc9.test.elementary_tutorial.elementary_volume_anomalies_test4_volume_anomaly_1.22dd1cb7dd", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_test4_volume_anomaly_1.22dd1cb7dd", "detected_at": "2024-08-21T09:06:11.801947", "full_table_name": "DEMO2_0821.PUBLIC.TEST4_VOLUME_ANOMALY", "column_name": null, "metric_name": "row_count", "anomaly_score": -0.2752635995739589, "anomaly_score_threshold": 1, "anomalous_value": null, "bucket_start": "2024-08-19T00:00:00", "bucket_end": "2024-08-20T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 5.0, "min_metric_value": 0.0, "max_metric_value": 1026.015776663176, "training_avg": 225.3846153846154, "training_stddev": 800.6311612785605, "training_set_size": 13, "training_start": "2024-08-08T00:00:00", "training_end": "2024-08-20T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 5.000. The average for this metric is 225.385.", "max_bucket_end": "2024-08-21T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 209.28571428571428, "min_value": 0.0, "max_value": 980.8621653132323, "start_time": "2024-08-20T00:00:00", "end_time": "2024-08-21T00:00:00", "id": "9995d910876816a28cb773e88fce3eb2", "metric_id": "88ce5f637bf872315b67ff8c009d812b", "test_execution_id": "53eb2540-e1b2-47de-9b7d-2ab627db3fc9.test.elementary_tutorial.elementary_volume_anomalies_test4_volume_anomaly_1.22dd1cb7dd", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_test4_volume_anomaly_1.22dd1cb7dd", "detected_at": "2024-08-21T09:06:11.801947", "full_table_name": "DEMO2_0821.PUBLIC.TEST4_VOLUME_ANOMALY", "column_name": null, "metric_name": "row_count", "anomaly_score": -0.27124429990962773, "anomaly_score_threshold": 1, "anomalous_value": null, "bucket_start": "2024-08-20T00:00:00", "bucket_end": "2024-08-21T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 980.8621653132323, "training_avg": 209.28571428571428, "training_stddev": 771.5764510275179, "training_set_size": 14, "training_start": "2024-08-08T00:00:00", "training_end": "2024-08-21T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 209.286.", "max_bucket_end": "2024-08-21T00:00:00", "is_anomalous": false}], "result_description": "The last row_count value is 0.000. The average for this metric is 209.286."}}], "model.elementary_tutorial.test_practice": [{"metadata": {"test_unique_id": "test.elementary_tutorial.test4_dbt_test", "elementary_unique_id": "test.elementary_tutorial.test4_dbt_test.None.singular", "database_name": "demo2_0821", "schema_name": "public", "table_name": "test_practice", "column_name": null, "test_name": "test4_dbt_test", "test_display_name": "Test4 Dbt Test", "original_path": "tests/test4_dbt_test.sql", "latest_run_time": "2024-08-21T17:06:11+08:00", "latest_run_time_utc": "2024-08-21T09:06:11+00:00", "latest_run_status": "fail", "model_unique_id": "model.elementary_tutorial.test_practice", "table_unique_id": "demo2_0821.public.test_practice", "test_type": "dbt_test", "test_sub_type": "singular", "test_query": "-- tests/check_record_count.sql\n\nwith actual_count as (\n    select\n        count(*) as actual_count\n    from \"demo2_0821\".\"public\".\"test_practice\"\n),\nexpected_count as (\n    select 300 as expected_count\n)\n\nselect\n    actual_count,\n    expected_count\nfrom actual_count, expected_count\nwhere actual_count != expected_count", "test_params": {}, "test_created_at": null, "description": null, "result": {"result_description": "Got 1 result, configured to fail if != 0", "result_query": "-- tests/check_record_count.sql\n\nwith actual_count as (\n    select\n        count(*) as actual_count\n    from \"demo2_0821\".\"public\".\"test_practice\"\n),\nexpected_count as (\n    select 300 as expected_count\n)\n\nselect\n    actual_count,\n    expected_count\nfrom actual_count, expected_count\nwhere actual_count != expected_count"}, "configuration": {"test_name": "test4_dbt_test", "test_params": {}}, "test_tags": [], "normalized_full_path": "elementary_tutorial/tests/test4_dbt_test.sql"}, "test_results": {"display_name": "test4_dbt_test", "results_sample": [{"actual_count": 649, "expected_count": 300}], "error_message": "Got 1 result, configured to fail if != 0", "failed_rows_count": 1}}], "model.elementary_tutorial.test4_column_anomaly": [{"metadata": {"test_unique_id": "test.elementary_tutorial.elementary_column_anomalies_test4_column_anomaly_1__null_count__name.5c88e6fb20", "elementary_unique_id": "test.elementary_tutorial.elementary_column_anomalies_test4_column_anomaly_1__null_count__name.5c88e6fb20.name.generic", "database_name": "demo2_0821", "schema_name": "public", "table_name": "test4_column_anomaly", "column_name": "name", "test_name": "column_anomalies", "test_display_name": "Column Anomalies", "original_path": "models/schema.yml", "latest_run_time": "2024-08-21T16:55:06+08:00", "latest_run_time_utc": "2024-08-21T08:55:06+00:00", "latest_run_status": "pass", "model_unique_id": "model.elementary_tutorial.test4_column_anomaly", "table_unique_id": "demo2_0821.public.test4_column_anomaly", "test_type": "anomaly_detection", "test_sub_type": "generic", "test_query": "select * from (with anomaly_scores as (\n        select\n            id,\n            metric_id,\n            test_execution_id,\n            test_unique_id,\n            detected_at,\n            full_table_name,\n            column_name,\n            metric_name,\n            anomaly_score,\n            anomaly_score_threshold,\n            anomalous_value,\n            bucket_start,\n            bucket_end,\n            bucket_seasonality,\n            metric_value,\n            min_metric_value,\n            max_metric_value,\n            training_avg,\n            training_stddev,\n            training_set_size,\n            training_start,\n            training_end,\n            dimension,\n            dimension_value,\n            \n    case\n        when dimension is not null and column_name is null then \n    'The last ' || metric_name || ' value for dimension ' || dimension || ' - ' ||\n    case when dimension_value is null then 'NULL' else dimension_value end || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when dimension is not null and column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value for dimension ' || dimension || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when metric_name = 'freshness' then \n    'Last update was at ' || anomalous_value || ', ' || cast(abs(round(cast(metric_value/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours ago. Usually the table is updated within ' || cast(abs(round(cast(training_avg/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours.'\n\n        when column_name is null then \n    'The last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        else null\n    end as anomaly_description\n,\n            max(bucket_end) over (partition by test_execution_id) as max_bucket_end\n        from \"demo2_0821\".\"public\".\"test_5c88e6fb20_eleme__anomaly_scores__tmp_20240821085503776911\"\n      ),\n      anomaly_scores_with_is_anomalous as (\n        select\n          *,\ncase when\n          (\n            \n  (anomaly_score is not null and\n  (\n    \n  (\n    metric_value = 0 and \n    \n      1 = 2\n    \n  )\n or\n    (\n      case when metric_name IN \n        ( 'freshness' ,  'event_freshness'  )\n then\n            anomaly_score > 1\n    else\n        \n        abs(anomaly_score) > 1\n    \n\n     end and\n      (\n  \n  \n  \n  \n    \n        (1 = 1)\n    \n\n    and\n\n    \n        (1 = 1)\n    \n  \n  )\n    )\n  ))\n\n          )\n          and bucket_end >= \n    cast(max_bucket_end as timestamp) + cast('-2' as integer) * INTERVAL '1 day'\n\n          then TRUE else FALSE end as is_anomalous\n        from anomaly_scores\n      ),\n\n      final_results as (\n          select\n          metric_value as value,\n          training_avg as average,\n          \n          case\n          when is_anomalous = TRUE and 'both' = 'spike' then\n          lag(metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when is_anomalous = TRUE and 'both' != 'spike' then\n          lag(min_metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when 'both' = 'spike' then metric_value\n          else min_metric_value end as min_value,\n          case\n          when is_anomalous = TRUE and 'both' = 'drop' then\n          lag(metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when is_anomalous = TRUE and 'both' != 'drop' then\n          lag(max_metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when 'both' = 'drop' then metric_value\n          else max_metric_value end as max_value,\n          bucket_start as start_time,\n          bucket_end as end_time,\n          *\n        from anomaly_scores_with_is_anomalous\n        order by bucket_end, dimension_value\n      )\n\n      select * from final_results\n      where 1 = 1) results\n    where is_anomalous = true", "test_params": {"column_anomalies": ["null_count"], "anomaly_sensitivity": 1, "column_name": "name", "model": "{{ get_where_subquery(ref('test4_column_anomaly')) }}"}, "test_created_at": null, "description": "Column-level anomaly monitors (null_count, null_percent, zero_count, string_length, variance, etc.) on the column according to its data type.", "result": {"result_description": null, "result_query": "select * from (with anomaly_scores as (\n        select\n            id,\n            metric_id,\n            test_execution_id,\n            test_unique_id,\n            detected_at,\n            full_table_name,\n            column_name,\n            metric_name,\n            anomaly_score,\n            anomaly_score_threshold,\n            anomalous_value,\n            bucket_start,\n            bucket_end,\n            bucket_seasonality,\n            metric_value,\n            min_metric_value,\n            max_metric_value,\n            training_avg,\n            training_stddev,\n            training_set_size,\n            training_start,\n            training_end,\n            dimension,\n            dimension_value,\n            \n    case\n        when dimension is not null and column_name is null then \n    'The last ' || metric_name || ' value for dimension ' || dimension || ' - ' ||\n    case when dimension_value is null then 'NULL' else dimension_value end || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when dimension is not null and column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value for dimension ' || dimension || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when metric_name = 'freshness' then \n    'Last update was at ' || anomalous_value || ', ' || cast(abs(round(cast(metric_value/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours ago. Usually the table is updated within ' || cast(abs(round(cast(training_avg/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours.'\n\n        when column_name is null then \n    'The last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        else null\n    end as anomaly_description\n,\n            max(bucket_end) over (partition by test_execution_id) as max_bucket_end\n        from \"demo2_0821\".\"public\".\"test_5c88e6fb20_eleme__anomaly_scores__tmp_20240821085503776911\"\n      ),\n      anomaly_scores_with_is_anomalous as (\n        select\n          *,\ncase when\n          (\n            \n  (anomaly_score is not null and\n  (\n    \n  (\n    metric_value = 0 and \n    \n      1 = 2\n    \n  )\n or\n    (\n      case when metric_name IN \n        ( 'freshness' ,  'event_freshness'  )\n then\n            anomaly_score > 1\n    else\n        \n        abs(anomaly_score) > 1\n    \n\n     end and\n      (\n  \n  \n  \n  \n    \n        (1 = 1)\n    \n\n    and\n\n    \n        (1 = 1)\n    \n  \n  )\n    )\n  ))\n\n          )\n          and bucket_end >= \n    cast(max_bucket_end as timestamp) + cast('-2' as integer) * INTERVAL '1 day'\n\n          then TRUE else FALSE end as is_anomalous\n        from anomaly_scores\n      ),\n\n      final_results as (\n          select\n          metric_value as value,\n          training_avg as average,\n          \n          case\n          when is_anomalous = TRUE and 'both' = 'spike' then\n          lag(metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when is_anomalous = TRUE and 'both' != 'spike' then\n          lag(min_metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when 'both' = 'spike' then metric_value\n          else min_metric_value end as min_value,\n          case\n          when is_anomalous = TRUE and 'both' = 'drop' then\n          lag(metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when is_anomalous = TRUE and 'both' != 'drop' then\n          lag(max_metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when 'both' = 'drop' then metric_value\n          else max_metric_value end as max_value,\n          bucket_start as start_time,\n          bucket_end as end_time,\n          *\n        from anomaly_scores_with_is_anomalous\n        order by bucket_end, dimension_value\n      )\n\n      select * from final_results\n      where 1 = 1) results\n    where is_anomalous = true"}, "configuration": {"test_name": "column_anomalies", "timestamp_column": null, "testing_timeframe": "1 day", "anomaly_threshold": 1}, "test_tags": ["column_anomalies", "elementary-tests"], "normalized_full_path": "elementary_tutorial/models/schema.yml"}, "test_results": {"display_name": "Generic", "metrics": [], "result_description": null}}, {"metadata": {"test_unique_id": "test.elementary_tutorial.elementary_column_anomalies_test4_column_anomaly_1__null_count__name.5c88e6fb20", "elementary_unique_id": "test.elementary_tutorial.elementary_column_anomalies_test4_column_anomaly_1__null_count__name.5c88e6fb20.name.null_count", "database_name": "demo2_0821", "schema_name": "public", "table_name": "test4_column_anomaly", "column_name": "name", "test_name": "column_anomalies", "test_display_name": "Column Anomalies", "original_path": "models/schema.yml", "latest_run_time": "2024-08-21T17:06:10+08:00", "latest_run_time_utc": "2024-08-21T09:06:10+00:00", "latest_run_status": "fail", "model_unique_id": "model.elementary_tutorial.test4_column_anomaly", "table_unique_id": "demo2_0821.public.test4_column_anomaly", "test_type": "anomaly_detection", "test_sub_type": "null_count", "test_query": "select * from (None) results\n      where\n        anomaly_score is not null and\n        upper(full_table_name) = upper(cast('DEMO2_0821.PUBLIC.TEST4_COLUMN_ANOMALY' as varchar(4096))) and\n        metric_name = cast('null_count' as varchar(4096))\n          and upper(column_name) = upper(cast('name' as varchar(4096)))", "test_params": {"column_anomalies": ["null_count"], "anomaly_sensitivity": 1, "column_name": "name", "model": "{{ get_where_subquery(ref('test4_column_anomaly')) }}", "timestamp_column": "birth", "where_expression": null, "anomaly_direction": "both", "time_bucket": {"period": "day", "count": 1}, "days_back": 14, "backfill_days": 2, "seasonality": null, "freshness_column": null, "event_timestamp_column": null, "dimensions": null, "ignore_small_changes": {"spike_failure_percent_threshold": null, "drop_failure_percent_threshold": null}, "fail_on_zero": false, "detection_delay": {"period": "hour", "count": 0}, "anomaly_exclude_metrics": null, "exclude_final_results": "1 = 1"}, "test_created_at": null, "description": "Column-level anomaly monitors (null_count, null_percent, zero_count, string_length, variance, etc.) on the column according to its data type.", "result": {"result_description": "In column name, the last null_count value is 0.000. The average for this metric is 21.667.", "result_query": "select * from (None) results\n      where\n        anomaly_score is not null and\n        upper(full_table_name) = upper(cast('DEMO2_0821.PUBLIC.TEST4_COLUMN_ANOMALY' as varchar(4096))) and\n        metric_name = cast('null_count' as varchar(4096))\n          and upper(column_name) = upper(cast('name' as varchar(4096)))"}, "configuration": {"test_name": "column_anomalies", "timestamp_column": "birth", "testing_timeframe": "1 day", "anomaly_threshold": 1}, "test_tags": ["column_anomalies", "elementary-tests"], "normalized_full_path": "elementary_tutorial/models/schema.yml"}, "test_results": {"display_name": "Null Count", "metrics": [{"value": 0.0, "average": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-15T00:00:00", "end_time": "2024-08-16T00:00:00", "id": "2e448c333181ae0160ed1de736601d74", "metric_id": "7328bb7c16a51ceb83137d03ba743f23", "test_execution_id": "53eb2540-e1b2-47de-9b7d-2ab627db3fc9.test.elementary_tutorial.elementary_column_anomalies_test4_column_anomaly_1__null_count__name.5c88e6fb20", "test_unique_id": "test.elementary_tutorial.elementary_column_anomalies_test4_column_anomaly_1__null_count__name.5c88e6fb20", "detected_at": "2024-08-21T09:06:10.067387", "full_table_name": "DEMO2_0821.PUBLIC.TEST4_COLUMN_ANOMALY", "column_name": "name", "metric_name": "null_count", "anomaly_score": 0.0, "anomaly_score_threshold": 1, "anomalous_value": null, "bucket_start": "2024-08-15T00:00:00", "bucket_end": "2024-08-16T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 0.0, "training_avg": 0.0, "training_stddev": 0.0, "training_set_size": 2, "training_start": "2024-08-15T00:00:00", "training_end": "2024-08-16T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "In column name, the last null_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2024-08-20T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-16T00:00:00", "end_time": "2024-08-17T00:00:00", "id": "32efaaf2c0f68857ba9c128581a3e4c5", "metric_id": "f56eabc572cadc1b520f0927bc059fb9", "test_execution_id": "53eb2540-e1b2-47de-9b7d-2ab627db3fc9.test.elementary_tutorial.elementary_column_anomalies_test4_column_anomaly_1__null_count__name.5c88e6fb20", "test_unique_id": "test.elementary_tutorial.elementary_column_anomalies_test4_column_anomaly_1__null_count__name.5c88e6fb20", "detected_at": "2024-08-21T09:06:10.067387", "full_table_name": "DEMO2_0821.PUBLIC.TEST4_COLUMN_ANOMALY", "column_name": "name", "metric_name": "null_count", "anomaly_score": 0.0, "anomaly_score_threshold": 1, "anomalous_value": null, "bucket_start": "2024-08-16T00:00:00", "bucket_end": "2024-08-17T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 0.0, "training_avg": 0.0, "training_stddev": 0.0, "training_set_size": 3, "training_start": "2024-08-15T00:00:00", "training_end": "2024-08-17T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "In column name, the last null_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2024-08-20T00:00:00", "is_anomalous": false}, {"value": 130.0, "average": 32.5, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-17T00:00:00", "end_time": "2024-08-18T00:00:00", "id": "554855c8118f57488519602e5d432e9e", "metric_id": "43c59e5cdbefc2466c0e3101bd893dca", "test_execution_id": "53eb2540-e1b2-47de-9b7d-2ab627db3fc9.test.elementary_tutorial.elementary_column_anomalies_test4_column_anomaly_1__null_count__name.5c88e6fb20", "test_unique_id": "test.elementary_tutorial.elementary_column_anomalies_test4_column_anomaly_1__null_count__name.5c88e6fb20", "detected_at": "2024-08-21T09:06:10.067387", "full_table_name": "DEMO2_0821.PUBLIC.TEST4_COLUMN_ANOMALY", "column_name": "name", "metric_name": "null_count", "anomaly_score": 1.5, "anomaly_score_threshold": 1, "anomalous_value": null, "bucket_start": "2024-08-17T00:00:00", "bucket_end": "2024-08-18T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 130.0, "min_metric_value": 0.0, "max_metric_value": 97.5, "training_avg": 32.5, "training_stddev": 65.0, "training_set_size": 4, "training_start": "2024-08-15T00:00:00", "training_end": "2024-08-18T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "In column name, the last null_count value is 130.000. The average for this metric is 32.500.", "max_bucket_end": "2024-08-20T00:00:00", "is_anomalous": true}, {"value": 0.0, "average": 26.0, "min_value": 0.0, "max_value": 84.13776741499453, "start_time": "2024-08-18T00:00:00", "end_time": "2024-08-19T00:00:00", "id": "e2b50af9dea1af3aa9303c9f3c0d16da", "metric_id": "713ca451b6410ca0dd3062f95f91ed97", "test_execution_id": "53eb2540-e1b2-47de-9b7d-2ab627db3fc9.test.elementary_tutorial.elementary_column_anomalies_test4_column_anomaly_1__null_count__name.5c88e6fb20", "test_unique_id": "test.elementary_tutorial.elementary_column_anomalies_test4_column_anomaly_1__null_count__name.5c88e6fb20", "detected_at": "2024-08-21T09:06:10.067387", "full_table_name": "DEMO2_0821.PUBLIC.TEST4_COLUMN_ANOMALY", "column_name": "name", "metric_name": "null_count", "anomaly_score": -0.4472135954999579, "anomaly_score_threshold": 1, "anomalous_value": null, "bucket_start": "2024-08-18T00:00:00", "bucket_end": "2024-08-19T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 84.13776741499453, "training_avg": 26.0, "training_stddev": 58.137767414994535, "training_set_size": 5, "training_start": "2024-08-15T00:00:00", "training_end": "2024-08-19T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "In column name, the last null_count value is 0.000. The average for this metric is 26.000.", "max_bucket_end": "2024-08-20T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 21.666666666666668, "min_value": 0.0, "max_value": 74.73894442696886, "start_time": "2024-08-19T00:00:00", "end_time": "2024-08-20T00:00:00", "id": "5d270853cb021dc0fa3a8f720d2768cc", "metric_id": "6d22838d25ce5fdef9676df6aff00d05", "test_execution_id": "53eb2540-e1b2-47de-9b7d-2ab627db3fc9.test.elementary_tutorial.elementary_column_anomalies_test4_column_anomaly_1__null_count__name.5c88e6fb20", "test_unique_id": "test.elementary_tutorial.elementary_column_anomalies_test4_column_anomaly_1__null_count__name.5c88e6fb20", "detected_at": "2024-08-21T09:06:10.067387", "full_table_name": "DEMO2_0821.PUBLIC.TEST4_COLUMN_ANOMALY", "column_name": "name", "metric_name": "null_count", "anomaly_score": -0.408248290463863, "anomaly_score_threshold": 1, "anomalous_value": null, "bucket_start": "2024-08-19T00:00:00", "bucket_end": "2024-08-20T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 74.73894442696886, "training_avg": 21.666666666666668, "training_stddev": 53.07227776030219, "training_set_size": 6, "training_start": "2024-08-15T00:00:00", "training_end": "2024-08-20T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "In column name, the last null_count value is 0.000. The average for this metric is 21.667.", "max_bucket_end": "2024-08-20T00:00:00", "is_anomalous": false}], "result_description": "In column name, the last null_count value is 0.000. The average for this metric is 21.667."}}, {"metadata": {"test_unique_id": "test.elementary_tutorial.elementary_column_anomalies_test4_column_anomaly_1__zero_count__max__age.21be7f55a1", "elementary_unique_id": "test.elementary_tutorial.elementary_column_anomalies_test4_column_anomaly_1__zero_count__max__age.21be7f55a1.age.generic", "database_name": "demo2_0821", "schema_name": "public", "table_name": "test4_column_anomaly", "column_name": "age", "test_name": "column_anomalies", "test_display_name": "Column Anomalies", "original_path": "models/schema.yml", "latest_run_time": "2024-08-21T16:55:06+08:00", "latest_run_time_utc": "2024-08-21T08:55:06+00:00", "latest_run_status": "pass", "model_unique_id": "model.elementary_tutorial.test4_column_anomaly", "table_unique_id": "demo2_0821.public.test4_column_anomaly", "test_type": "anomaly_detection", "test_sub_type": "generic", "test_query": "select * from (with anomaly_scores as (\n        select\n            id,\n            metric_id,\n            test_execution_id,\n            test_unique_id,\n            detected_at,\n            full_table_name,\n            column_name,\n            metric_name,\n            anomaly_score,\n            anomaly_score_threshold,\n            anomalous_value,\n            bucket_start,\n            bucket_end,\n            bucket_seasonality,\n            metric_value,\n            min_metric_value,\n            max_metric_value,\n            training_avg,\n            training_stddev,\n            training_set_size,\n            training_start,\n            training_end,\n            dimension,\n            dimension_value,\n            \n    case\n        when dimension is not null and column_name is null then \n    'The last ' || metric_name || ' value for dimension ' || dimension || ' - ' ||\n    case when dimension_value is null then 'NULL' else dimension_value end || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when dimension is not null and column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value for dimension ' || dimension || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when metric_name = 'freshness' then \n    'Last update was at ' || anomalous_value || ', ' || cast(abs(round(cast(metric_value/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours ago. Usually the table is updated within ' || cast(abs(round(cast(training_avg/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours.'\n\n        when column_name is null then \n    'The last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        else null\n    end as anomaly_description\n,\n            max(bucket_end) over (partition by test_execution_id) as max_bucket_end\n        from \"demo2_0821\".\"public\".\"test_21be7f55a1_eleme__anomaly_scores__tmp_20240821085504073902\"\n      ),\n      anomaly_scores_with_is_anomalous as (\n        select\n          *,\ncase when\n          (\n            \n  (anomaly_score is not null and\n  (\n    \n  (\n    metric_value = 0 and \n    \n      1 = 2\n    \n  )\n or\n    (\n      case when metric_name IN \n        ( 'freshness' ,  'event_freshness'  )\n then\n            anomaly_score > 1\n    else\n        \n        abs(anomaly_score) > 1\n    \n\n     end and\n      (\n  \n  \n  \n  \n    \n        (1 = 1)\n    \n\n    and\n\n    \n        (1 = 1)\n    \n  \n  )\n    )\n  ))\n\n          )\n          and bucket_end >= \n    cast(max_bucket_end as timestamp) + cast('-2' as integer) * INTERVAL '1 day'\n\n          then TRUE else FALSE end as is_anomalous\n        from anomaly_scores\n      ),\n\n      final_results as (\n          select\n          metric_value as value,\n          training_avg as average,\n          \n          case\n          when is_anomalous = TRUE and 'both' = 'spike' then\n          lag(metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when is_anomalous = TRUE and 'both' != 'spike' then\n          lag(min_metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when 'both' = 'spike' then metric_value\n          else min_metric_value end as min_value,\n          case\n          when is_anomalous = TRUE and 'both' = 'drop' then\n          lag(metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when is_anomalous = TRUE and 'both' != 'drop' then\n          lag(max_metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when 'both' = 'drop' then metric_value\n          else max_metric_value end as max_value,\n          bucket_start as start_time,\n          bucket_end as end_time,\n          *\n        from anomaly_scores_with_is_anomalous\n        order by bucket_end, dimension_value\n      )\n\n      select * from final_results\n      where 1 = 1) results\n    where is_anomalous = true", "test_params": {"column_anomalies": ["zero_count", "max"], "anomaly_sensitivity": 1, "column_name": "age", "model": "{{ get_where_subquery(ref('test4_column_anomaly')) }}"}, "test_created_at": null, "description": "Column-level anomaly monitors (null_count, null_percent, zero_count, string_length, variance, etc.) on the column according to its data type.", "result": {"result_description": null, "result_query": "select * from (with anomaly_scores as (\n        select\n            id,\n            metric_id,\n            test_execution_id,\n            test_unique_id,\n            detected_at,\n            full_table_name,\n            column_name,\n            metric_name,\n            anomaly_score,\n            anomaly_score_threshold,\n            anomalous_value,\n            bucket_start,\n            bucket_end,\n            bucket_seasonality,\n            metric_value,\n            min_metric_value,\n            max_metric_value,\n            training_avg,\n            training_stddev,\n            training_set_size,\n            training_start,\n            training_end,\n            dimension,\n            dimension_value,\n            \n    case\n        when dimension is not null and column_name is null then \n    'The last ' || metric_name || ' value for dimension ' || dimension || ' - ' ||\n    case when dimension_value is null then 'NULL' else dimension_value end || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when dimension is not null and column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value for dimension ' || dimension || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when metric_name = 'freshness' then \n    'Last update was at ' || anomalous_value || ', ' || cast(abs(round(cast(metric_value/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours ago. Usually the table is updated within ' || cast(abs(round(cast(training_avg/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours.'\n\n        when column_name is null then \n    'The last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        else null\n    end as anomaly_description\n,\n            max(bucket_end) over (partition by test_execution_id) as max_bucket_end\n        from \"demo2_0821\".\"public\".\"test_21be7f55a1_eleme__anomaly_scores__tmp_20240821085504073902\"\n      ),\n      anomaly_scores_with_is_anomalous as (\n        select\n          *,\ncase when\n          (\n            \n  (anomaly_score is not null and\n  (\n    \n  (\n    metric_value = 0 and \n    \n      1 = 2\n    \n  )\n or\n    (\n      case when metric_name IN \n        ( 'freshness' ,  'event_freshness'  )\n then\n            anomaly_score > 1\n    else\n        \n        abs(anomaly_score) > 1\n    \n\n     end and\n      (\n  \n  \n  \n  \n    \n        (1 = 1)\n    \n\n    and\n\n    \n        (1 = 1)\n    \n  \n  )\n    )\n  ))\n\n          )\n          and bucket_end >= \n    cast(max_bucket_end as timestamp) + cast('-2' as integer) * INTERVAL '1 day'\n\n          then TRUE else FALSE end as is_anomalous\n        from anomaly_scores\n      ),\n\n      final_results as (\n          select\n          metric_value as value,\n          training_avg as average,\n          \n          case\n          when is_anomalous = TRUE and 'both' = 'spike' then\n          lag(metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when is_anomalous = TRUE and 'both' != 'spike' then\n          lag(min_metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when 'both' = 'spike' then metric_value\n          else min_metric_value end as min_value,\n          case\n          when is_anomalous = TRUE and 'both' = 'drop' then\n          lag(metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when is_anomalous = TRUE and 'both' != 'drop' then\n          lag(max_metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when 'both' = 'drop' then metric_value\n          else max_metric_value end as max_value,\n          bucket_start as start_time,\n          bucket_end as end_time,\n          *\n        from anomaly_scores_with_is_anomalous\n        order by bucket_end, dimension_value\n      )\n\n      select * from final_results\n      where 1 = 1) results\n    where is_anomalous = true"}, "configuration": {"test_name": "column_anomalies", "timestamp_column": null, "testing_timeframe": "1 day", "anomaly_threshold": 1}, "test_tags": ["column_test", "elementary-tests"], "normalized_full_path": "elementary_tutorial/models/schema.yml"}, "test_results": {"display_name": "Generic", "metrics": [], "result_description": null}}, {"metadata": {"test_unique_id": "test.elementary_tutorial.elementary_column_anomalies_test4_column_anomaly_1__zero_count__max__age.21be7f55a1", "elementary_unique_id": "test.elementary_tutorial.elementary_column_anomalies_test4_column_anomaly_1__zero_count__max__age.21be7f55a1.age.max", "database_name": "demo2_0821", "schema_name": "public", "table_name": "test4_column_anomaly", "column_name": "age", "test_name": "column_anomalies", "test_display_name": "Column Anomalies", "original_path": "models/schema.yml", "latest_run_time": "2024-08-21T17:06:10+08:00", "latest_run_time_utc": "2024-08-21T09:06:10+00:00", "latest_run_status": "warn", "model_unique_id": "model.elementary_tutorial.test4_column_anomaly", "table_unique_id": "demo2_0821.public.test4_column_anomaly", "test_type": "anomaly_detection", "test_sub_type": "max", "test_query": "select * from (None) results\n      where\n        anomaly_score is not null and\n        upper(full_table_name) = upper(cast('DEMO2_0821.PUBLIC.TEST4_COLUMN_ANOMALY' as varchar(4096))) and\n        metric_name = cast('max' as varchar(4096))\n          and upper(column_name) = upper(cast('age' as varchar(4096)))", "test_params": {"column_anomalies": ["zero_count", "max"], "anomaly_sensitivity": 1, "column_name": "age", "model": "{{ get_where_subquery(ref('test4_column_anomaly')) }}", "timestamp_column": "birth", "where_expression": null, "anomaly_direction": "both", "time_bucket": {"period": "day", "count": 1}, "days_back": 14, "backfill_days": 2, "seasonality": null, "freshness_column": null, "event_timestamp_column": null, "dimensions": null, "ignore_small_changes": {"spike_failure_percent_threshold": null, "drop_failure_percent_threshold": null}, "fail_on_zero": false, "detection_delay": {"period": "hour", "count": 0}, "anomaly_exclude_metrics": null, "exclude_final_results": "1 = 1"}, "test_created_at": null, "description": "Column-level anomaly monitors (null_count, null_percent, zero_count, string_length, variance, etc.) on the column according to its data type.", "result": {"result_description": "In column age, the last max value is 0.000. The average for this metric is 28.833.", "result_query": "select * from (None) results\n      where\n        anomaly_score is not null and\n        upper(full_table_name) = upper(cast('DEMO2_0821.PUBLIC.TEST4_COLUMN_ANOMALY' as varchar(4096))) and\n        metric_name = cast('max' as varchar(4096))\n          and upper(column_name) = upper(cast('age' as varchar(4096)))"}, "configuration": {"test_name": "column_anomalies", "timestamp_column": "birth", "testing_timeframe": "1 day", "anomaly_threshold": 1}, "test_tags": ["column_test", "elementary-tests"], "normalized_full_path": "elementary_tutorial/models/schema.yml"}, "test_results": {"display_name": "Max", "metrics": [{"value": 25.0, "average": 26.0, "min_value": 24.585786437626904, "max_value": 27.414213562373096, "start_time": "2024-08-15T00:00:00", "end_time": "2024-08-16T00:00:00", "id": "f84f39b50923d5905cfc689770e93d15", "metric_id": "5a3a487af7a0a4b8659e9b9a23ebcc9b", "test_execution_id": "53eb2540-e1b2-47de-9b7d-2ab627db3fc9.test.elementary_tutorial.elementary_column_anomalies_test4_column_anomaly_1__zero_count__max__age.21be7f55a1", "test_unique_id": "test.elementary_tutorial.elementary_column_anomalies_test4_column_anomaly_1__zero_count__max__age.21be7f55a1", "detected_at": "2024-08-21T09:06:10.373085", "full_table_name": "DEMO2_0821.PUBLIC.TEST4_COLUMN_ANOMALY", "column_name": "age", "metric_name": "max", "anomaly_score": -0.7071067811865475, "anomaly_score_threshold": 1, "anomalous_value": null, "bucket_start": "2024-08-15T00:00:00", "bucket_end": "2024-08-16T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 25.0, "min_metric_value": 24.585786437626904, "max_metric_value": 27.414213562373096, "training_avg": 26.0, "training_stddev": 1.4142135623730951, "training_set_size": 2, "training_start": "2024-08-15T00:00:00", "training_end": "2024-08-16T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "In column age, the last max value is 25.000. The average for this metric is 26.000.", "max_bucket_end": "2024-08-20T00:00:00", "is_anomalous": false}, {"value": 26.0, "average": 26.0, "min_value": 25.0, "max_value": 27.0, "start_time": "2024-08-16T00:00:00", "end_time": "2024-08-17T00:00:00", "id": "83f870150c9130c25cbd923eaad98012", "metric_id": "ac13427680734791c358178075d53414", "test_execution_id": "53eb2540-e1b2-47de-9b7d-2ab627db3fc9.test.elementary_tutorial.elementary_column_anomalies_test4_column_anomaly_1__zero_count__max__age.21be7f55a1", "test_unique_id": "test.elementary_tutorial.elementary_column_anomalies_test4_column_anomaly_1__zero_count__max__age.21be7f55a1", "detected_at": "2024-08-21T09:06:10.373085", "full_table_name": "DEMO2_0821.PUBLIC.TEST4_COLUMN_ANOMALY", "column_name": "age", "metric_name": "max", "anomaly_score": 0.0, "anomaly_score_threshold": 1, "anomalous_value": null, "bucket_start": "2024-08-16T00:00:00", "bucket_end": "2024-08-17T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 26.0, "min_metric_value": 25.0, "max_metric_value": 27.0, "training_avg": 26.0, "training_stddev": 1.0, "training_set_size": 3, "training_start": "2024-08-15T00:00:00", "training_end": "2024-08-17T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "In column age, the last max value is 26.000. The average for this metric is 26.000.", "max_bucket_end": "2024-08-20T00:00:00", "is_anomalous": false}, {"value": 35.0, "average": 28.25, "min_value": 25.0, "max_value": 27.0, "start_time": "2024-08-17T00:00:00", "end_time": "2024-08-18T00:00:00", "id": "d90b94e9e5dbffe740806494837a35e8", "metric_id": "1915df3c6bdffd63dceb460702ba9dea", "test_execution_id": "53eb2540-e1b2-47de-9b7d-2ab627db3fc9.test.elementary_tutorial.elementary_column_anomalies_test4_column_anomaly_1__zero_count__max__age.21be7f55a1", "test_unique_id": "test.elementary_tutorial.elementary_column_anomalies_test4_column_anomaly_1__zero_count__max__age.21be7f55a1", "detected_at": "2024-08-21T09:06:10.373085", "full_table_name": "DEMO2_0821.PUBLIC.TEST4_COLUMN_ANOMALY", "column_name": "age", "metric_name": "max", "anomaly_score": 1.4759020470849824, "anomaly_score_threshold": 1, "anomalous_value": null, "bucket_start": "2024-08-17T00:00:00", "bucket_end": "2024-08-18T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 35.0, "min_metric_value": 23.67652575532925, "max_metric_value": 32.82347424467075, "training_avg": 28.25, "training_stddev": 4.573474244670748, "training_set_size": 4, "training_start": "2024-08-15T00:00:00", "training_end": "2024-08-18T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "In column age, the last max value is 35.000. The average for this metric is 28.250.", "max_bucket_end": "2024-08-20T00:00:00", "is_anomalous": true}, {"value": 60.0, "average": 34.6, "min_value": 23.67652575532925, "max_value": 32.82347424467075, "start_time": "2024-08-18T00:00:00", "end_time": "2024-08-19T00:00:00", "id": "d0430294ae4170e45562d7d6f099d7df", "metric_id": "c19e40a24c48c5f6966f13e4f28a99a5", "test_execution_id": "53eb2540-e1b2-47de-9b7d-2ab627db3fc9.test.elementary_tutorial.elementary_column_anomalies_test4_column_anomaly_1__zero_count__max__age.21be7f55a1", "test_unique_id": "test.elementary_tutorial.elementary_column_anomalies_test4_column_anomaly_1__zero_count__max__age.21be7f55a1", "detected_at": "2024-08-21T09:06:10.373085", "full_table_name": "DEMO2_0821.PUBLIC.TEST4_COLUMN_ANOMALY", "column_name": "age", "metric_name": "max", "anomaly_score": 1.723073699192404, "anomaly_score_threshold": 1, "anomalous_value": null, "bucket_start": "2024-08-18T00:00:00", "bucket_end": "2024-08-19T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 60.0, "min_metric_value": 19.858900990767346, "max_metric_value": 49.34109900923266, "training_avg": 34.6, "training_stddev": 14.741099009232657, "training_set_size": 5, "training_start": "2024-08-15T00:00:00", "training_end": "2024-08-19T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "In column age, the last max value is 60.000. The average for this metric is 34.600.", "max_bucket_end": "2024-08-20T00:00:00", "is_anomalous": true}, {"value": 0.0, "average": 28.833333333333332, "min_value": 19.858900990767346, "max_value": 49.34109900923266, "start_time": "2024-08-19T00:00:00", "end_time": "2024-08-20T00:00:00", "id": "f9ee554c10308031005845144e8c329d", "metric_id": "221ed2d7f4c7f8b380acf3a943ad0a87", "test_execution_id": "53eb2540-e1b2-47de-9b7d-2ab627db3fc9.test.elementary_tutorial.elementary_column_anomalies_test4_column_anomaly_1__zero_count__max__age.21be7f55a1", "test_unique_id": "test.elementary_tutorial.elementary_column_anomalies_test4_column_anomaly_1__zero_count__max__age.21be7f55a1", "detected_at": "2024-08-21T09:06:10.373085", "full_table_name": "DEMO2_0821.PUBLIC.TEST4_COLUMN_ANOMALY", "column_name": "age", "metric_name": "max", "anomaly_score": -1.4922001574862815, "anomaly_score_threshold": 1, "anomalous_value": null, "bucket_start": "2024-08-19T00:00:00", "bucket_end": "2024-08-20T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 9.510635109051439, "max_metric_value": 48.15603155761522, "training_avg": 28.833333333333332, "training_stddev": 19.322698224281893, "training_set_size": 6, "training_start": "2024-08-15T00:00:00", "training_end": "2024-08-20T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "In column age, the last max value is 0.000. The average for this metric is 28.833.", "max_bucket_end": "2024-08-20T00:00:00", "is_anomalous": true}], "result_description": "In column age, the last max value is 0.000. The average for this metric is 28.833."}}, {"metadata": {"test_unique_id": "test.elementary_tutorial.elementary_column_anomalies_test4_column_anomaly_1__zero_count__max__age.21be7f55a1", "elementary_unique_id": "test.elementary_tutorial.elementary_column_anomalies_test4_column_anomaly_1__zero_count__max__age.21be7f55a1.age.zero_count", "database_name": "demo2_0821", "schema_name": "public", "table_name": "test4_column_anomaly", "column_name": "age", "test_name": "column_anomalies", "test_display_name": "Column Anomalies", "original_path": "models/schema.yml", "latest_run_time": "2024-08-21T17:06:10+08:00", "latest_run_time_utc": "2024-08-21T09:06:10+00:00", "latest_run_status": "warn", "model_unique_id": "model.elementary_tutorial.test4_column_anomaly", "table_unique_id": "demo2_0821.public.test4_column_anomaly", "test_type": "anomaly_detection", "test_sub_type": "zero_count", "test_query": "select * from (None) results\n      where\n        anomaly_score is not null and\n        upper(full_table_name) = upper(cast('DEMO2_0821.PUBLIC.TEST4_COLUMN_ANOMALY' as varchar(4096))) and\n        metric_name = cast('zero_count' as varchar(4096))\n          and upper(column_name) = upper(cast('age' as varchar(4096)))", "test_params": {"column_anomalies": ["zero_count", "max"], "anomaly_sensitivity": 1, "column_name": "age", "model": "{{ get_where_subquery(ref('test4_column_anomaly')) }}", "timestamp_column": "birth", "where_expression": null, "anomaly_direction": "both", "time_bucket": {"period": "day", "count": 1}, "days_back": 14, "backfill_days": 2, "seasonality": null, "freshness_column": null, "event_timestamp_column": null, "dimensions": null, "ignore_small_changes": {"spike_failure_percent_threshold": null, "drop_failure_percent_threshold": null}, "fail_on_zero": false, "detection_delay": {"period": "hour", "count": 0}, "anomaly_exclude_metrics": null, "exclude_final_results": "1 = 1"}, "test_created_at": null, "description": "Column-level anomaly monitors (null_count, null_percent, zero_count, string_length, variance, etc.) on the column according to its data type.", "result": {"result_description": "In column age, the last zero_count value is 1.000. The average for this metric is 21.833.", "result_query": "select * from (None) results\n      where\n        anomaly_score is not null and\n        upper(full_table_name) = upper(cast('DEMO2_0821.PUBLIC.TEST4_COLUMN_ANOMALY' as varchar(4096))) and\n        metric_name = cast('zero_count' as varchar(4096))\n          and upper(column_name) = upper(cast('age' as varchar(4096)))"}, "configuration": {"test_name": "column_anomalies", "timestamp_column": "birth", "testing_timeframe": "1 day", "anomaly_threshold": 1}, "test_tags": ["column_test", "elementary-tests"], "normalized_full_path": "elementary_tutorial/models/schema.yml"}, "test_results": {"display_name": "Zero Count", "metrics": [{"value": 0.0, "average": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-15T00:00:00", "end_time": "2024-08-16T00:00:00", "id": "caabf781da611b24bf6a285abf148df6", "metric_id": "6fa6e163e05eb0f3157a2b5febbbcdda", "test_execution_id": "53eb2540-e1b2-47de-9b7d-2ab627db3fc9.test.elementary_tutorial.elementary_column_anomalies_test4_column_anomaly_1__zero_count__max__age.21be7f55a1", "test_unique_id": "test.elementary_tutorial.elementary_column_anomalies_test4_column_anomaly_1__zero_count__max__age.21be7f55a1", "detected_at": "2024-08-21T09:06:10.373085", "full_table_name": "DEMO2_0821.PUBLIC.TEST4_COLUMN_ANOMALY", "column_name": "age", "metric_name": "zero_count", "anomaly_score": 0.0, "anomaly_score_threshold": 1, "anomalous_value": null, "bucket_start": "2024-08-15T00:00:00", "bucket_end": "2024-08-16T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 0.0, "training_avg": 0.0, "training_stddev": 0.0, "training_set_size": 2, "training_start": "2024-08-15T00:00:00", "training_end": "2024-08-16T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "In column age, the last zero_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2024-08-20T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-16T00:00:00", "end_time": "2024-08-17T00:00:00", "id": "a14e365c1aaf003ba245132ea0eea560", "metric_id": "3fbbcd9148791c1310af44593b155778", "test_execution_id": "53eb2540-e1b2-47de-9b7d-2ab627db3fc9.test.elementary_tutorial.elementary_column_anomalies_test4_column_anomaly_1__zero_count__max__age.21be7f55a1", "test_unique_id": "test.elementary_tutorial.elementary_column_anomalies_test4_column_anomaly_1__zero_count__max__age.21be7f55a1", "detected_at": "2024-08-21T09:06:10.373085", "full_table_name": "DEMO2_0821.PUBLIC.TEST4_COLUMN_ANOMALY", "column_name": "age", "metric_name": "zero_count", "anomaly_score": 0.0, "anomaly_score_threshold": 1, "anomalous_value": null, "bucket_start": "2024-08-16T00:00:00", "bucket_end": "2024-08-17T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 0.0, "training_avg": 0.0, "training_stddev": 0.0, "training_set_size": 3, "training_start": "2024-08-15T00:00:00", "training_end": "2024-08-17T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "In column age, the last zero_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2024-08-20T00:00:00", "is_anomalous": false}, {"value": 130.0, "average": 32.5, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-17T00:00:00", "end_time": "2024-08-18T00:00:00", "id": "ee629ab33cf258600a1b173f1315f689", "metric_id": "6286ddc5aaa5706ad21451ff01081cb6", "test_execution_id": "53eb2540-e1b2-47de-9b7d-2ab627db3fc9.test.elementary_tutorial.elementary_column_anomalies_test4_column_anomaly_1__zero_count__max__age.21be7f55a1", "test_unique_id": "test.elementary_tutorial.elementary_column_anomalies_test4_column_anomaly_1__zero_count__max__age.21be7f55a1", "detected_at": "2024-08-21T09:06:10.373085", "full_table_name": "DEMO2_0821.PUBLIC.TEST4_COLUMN_ANOMALY", "column_name": "age", "metric_name": "zero_count", "anomaly_score": 1.5, "anomaly_score_threshold": 1, "anomalous_value": null, "bucket_start": "2024-08-17T00:00:00", "bucket_end": "2024-08-18T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 130.0, "min_metric_value": 0.0, "max_metric_value": 97.5, "training_avg": 32.5, "training_stddev": 65.0, "training_set_size": 4, "training_start": "2024-08-15T00:00:00", "training_end": "2024-08-18T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "In column age, the last zero_count value is 130.000. The average for this metric is 32.500.", "max_bucket_end": "2024-08-20T00:00:00", "is_anomalous": true}, {"value": 0.0, "average": 26.0, "min_value": 0.0, "max_value": 84.13776741499453, "start_time": "2024-08-18T00:00:00", "end_time": "2024-08-19T00:00:00", "id": "01123f0ba0552deefcaa8f4651e0933f", "metric_id": "3064fc655e3c7e978a01d9c3307eb487", "test_execution_id": "53eb2540-e1b2-47de-9b7d-2ab627db3fc9.test.elementary_tutorial.elementary_column_anomalies_test4_column_anomaly_1__zero_count__max__age.21be7f55a1", "test_unique_id": "test.elementary_tutorial.elementary_column_anomalies_test4_column_anomaly_1__zero_count__max__age.21be7f55a1", "detected_at": "2024-08-21T09:06:10.373085", "full_table_name": "DEMO2_0821.PUBLIC.TEST4_COLUMN_ANOMALY", "column_name": "age", "metric_name": "zero_count", "anomaly_score": -0.4472135954999579, "anomaly_score_threshold": 1, "anomalous_value": null, "bucket_start": "2024-08-18T00:00:00", "bucket_end": "2024-08-19T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 84.13776741499453, "training_avg": 26.0, "training_stddev": 58.137767414994535, "training_set_size": 5, "training_start": "2024-08-15T00:00:00", "training_end": "2024-08-19T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "In column age, the last zero_count value is 0.000. The average for this metric is 26.000.", "max_bucket_end": "2024-08-20T00:00:00", "is_anomalous": false}, {"value": 1.0, "average": 21.833333333333332, "min_value": 0.0, "max_value": 74.82547111495776, "start_time": "2024-08-19T00:00:00", "end_time": "2024-08-20T00:00:00", "id": "1590a4b3cd6b47ba36792be27c6dca73", "metric_id": "b1ba55fbafc71355b049541ccbb6ed07", "test_execution_id": "53eb2540-e1b2-47de-9b7d-2ab627db3fc9.test.elementary_tutorial.elementary_column_anomalies_test4_column_anomaly_1__zero_count__max__age.21be7f55a1", "test_unique_id": "test.elementary_tutorial.elementary_column_anomalies_test4_column_anomaly_1__zero_count__max__age.21be7f55a1", "detected_at": "2024-08-21T09:06:10.373085", "full_table_name": "DEMO2_0821.PUBLIC.TEST4_COLUMN_ANOMALY", "column_name": "age", "metric_name": "zero_count", "anomaly_score": -0.3931400808773845, "anomaly_score_threshold": 1, "anomalous_value": null, "bucket_start": "2024-08-19T00:00:00", "bucket_end": "2024-08-20T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 1.0, "min_metric_value": 0.0, "max_metric_value": 74.82547111495776, "training_avg": 21.833333333333332, "training_stddev": 52.99213778162443, "training_set_size": 6, "training_start": "2024-08-15T00:00:00", "training_end": "2024-08-20T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "In column age, the last zero_count value is 1.000. The average for this metric is 21.833.", "max_bucket_end": "2024-08-20T00:00:00", "is_anomalous": false}], "result_description": "In column age, the last zero_count value is 1.000. The average for this metric is 21.833."}}], "model.elementary_tutorial.orders": [{"metadata": {"test_unique_id": "test.elementary_tutorial.elementary_dimension_anomalies_orders_status.a5036d4371", "elementary_unique_id": "test.elementary_tutorial.elementary_dimension_anomalies_orders_status.a5036d4371", "database_name": "demo2_0821", "schema_name": "public", "table_name": "orders", "column_name": null, "test_name": "dimension_anomalies", "test_display_name": "Dimension Anomalies", "original_path": "models/schema.yml", "latest_run_time": "2024-08-21T17:06:12+08:00", "latest_run_time_utc": "2024-08-21T09:06:12+00:00", "latest_run_status": "pass", "model_unique_id": "model.elementary_tutorial.orders", "table_unique_id": "demo2_0821.public.orders", "test_type": "anomaly_detection", "test_sub_type": "generic", "test_query": "select * from (with anomaly_scores as (\n        select\n            id,\n            metric_id,\n            test_execution_id,\n            test_unique_id,\n            detected_at,\n            full_table_name,\n            column_name,\n            metric_name,\n            anomaly_score,\n            anomaly_score_threshold,\n            anomalous_value,\n            bucket_start,\n            bucket_end,\n            bucket_seasonality,\n            metric_value,\n            min_metric_value,\n            max_metric_value,\n            training_avg,\n            training_stddev,\n            training_set_size,\n            training_start,\n            training_end,\n            dimension,\n            dimension_value,\n            \n    case\n        when dimension is not null and column_name is null then \n    'The last ' || metric_name || ' value for dimension ' || dimension || ' - ' ||\n    case when dimension_value is null then 'NULL' else dimension_value end || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when dimension is not null and column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value for dimension ' || dimension || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when metric_name = 'freshness' then \n    'Last update was at ' || anomalous_value || ', ' || cast(abs(round(cast(metric_value/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours ago. Usually the table is updated within ' || cast(abs(round(cast(training_avg/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours.'\n\n        when column_name is null then \n    'The last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        else null\n    end as anomaly_description\n,\n            max(bucket_end) over (partition by test_execution_id) as max_bucket_end\n        from \"demo2_0821\".\"public\".\"test_a5036d4371_eleme__anomaly_scores__tmp_20240821090610676209\"\n      ),\n      anomaly_scores_with_is_anomalous as (\n        select\n          *,\ncase when\n          (\n            \n  (anomaly_score is not null and\n  (\n    \n  (\n    metric_value = 0 and \n    \n      1 = 2\n    \n  )\n or\n    (\n      case when metric_name IN \n        ( 'freshness' ,  'event_freshness'  )\n then\n            anomaly_score > 3\n    else\n        \n        abs(anomaly_score) > 3\n    \n\n     end and\n      (\n  \n  \n  \n  \n    \n        (1 = 1)\n    \n\n    and\n\n    \n        (1 = 1)\n    \n  \n  )\n    )\n  ))\n\n          )\n          and bucket_end >= \n    cast(max_bucket_end as timestamp) + cast('-2' as integer) * INTERVAL '1 day'\n\n          then TRUE else FALSE end as is_anomalous\n        from anomaly_scores\n      ),\n\n      final_results as (\n          select\n          metric_value as value,\n          training_avg as average,\n          \n          case\n          when is_anomalous = TRUE and 'both' = 'spike' then\n          lag(metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when is_anomalous = TRUE and 'both' != 'spike' then\n          lag(min_metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when 'both' = 'spike' then metric_value\n          else min_metric_value end as min_value,\n          case\n          when is_anomalous = TRUE and 'both' = 'drop' then\n          lag(metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when is_anomalous = TRUE and 'both' != 'drop' then\n          lag(max_metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when 'both' = 'drop' then metric_value\n          else max_metric_value end as max_value,\n          bucket_start as start_time,\n          bucket_end as end_time,\n          *\n        from anomaly_scores_with_is_anomalous\n        order by bucket_end, dimension_value\n      )\n\n      select * from final_results\n      where 1 = 1) results\n    where is_anomalous = true", "test_params": {"dimensions": ["status"], "model": "{{ get_where_subquery(ref('orders')) }}"}, "test_created_at": null, "description": "Monitors the frequency of values in the configured dimensions over time.", "result": {"result_description": null, "result_query": "select * from (with anomaly_scores as (\n        select\n            id,\n            metric_id,\n            test_execution_id,\n            test_unique_id,\n            detected_at,\n            full_table_name,\n            column_name,\n            metric_name,\n            anomaly_score,\n            anomaly_score_threshold,\n            anomalous_value,\n            bucket_start,\n            bucket_end,\n            bucket_seasonality,\n            metric_value,\n            min_metric_value,\n            max_metric_value,\n            training_avg,\n            training_stddev,\n            training_set_size,\n            training_start,\n            training_end,\n            dimension,\n            dimension_value,\n            \n    case\n        when dimension is not null and column_name is null then \n    'The last ' || metric_name || ' value for dimension ' || dimension || ' - ' ||\n    case when dimension_value is null then 'NULL' else dimension_value end || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when dimension is not null and column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value for dimension ' || dimension || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when metric_name = 'freshness' then \n    'Last update was at ' || anomalous_value || ', ' || cast(abs(round(cast(metric_value/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours ago. Usually the table is updated within ' || cast(abs(round(cast(training_avg/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours.'\n\n        when column_name is null then \n    'The last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        else null\n    end as anomaly_description\n,\n            max(bucket_end) over (partition by test_execution_id) as max_bucket_end\n        from \"demo2_0821\".\"public\".\"test_a5036d4371_eleme__anomaly_scores__tmp_20240821090610676209\"\n      ),\n      anomaly_scores_with_is_anomalous as (\n        select\n          *,\ncase when\n          (\n            \n  (anomaly_score is not null and\n  (\n    \n  (\n    metric_value = 0 and \n    \n      1 = 2\n    \n  )\n or\n    (\n      case when metric_name IN \n        ( 'freshness' ,  'event_freshness'  )\n then\n            anomaly_score > 3\n    else\n        \n        abs(anomaly_score) > 3\n    \n\n     end and\n      (\n  \n  \n  \n  \n    \n        (1 = 1)\n    \n\n    and\n\n    \n        (1 = 1)\n    \n  \n  )\n    )\n  ))\n\n          )\n          and bucket_end >= \n    cast(max_bucket_end as timestamp) + cast('-2' as integer) * INTERVAL '1 day'\n\n          then TRUE else FALSE end as is_anomalous\n        from anomaly_scores\n      ),\n\n      final_results as (\n          select\n          metric_value as value,\n          training_avg as average,\n          \n          case\n          when is_anomalous = TRUE and 'both' = 'spike' then\n          lag(metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when is_anomalous = TRUE and 'both' != 'spike' then\n          lag(min_metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when 'both' = 'spike' then metric_value\n          else min_metric_value end as min_value,\n          case\n          when is_anomalous = TRUE and 'both' = 'drop' then\n          lag(metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when is_anomalous = TRUE and 'both' != 'drop' then\n          lag(max_metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when 'both' = 'drop' then metric_value\n          else max_metric_value end as max_value,\n          bucket_start as start_time,\n          bucket_end as end_time,\n          *\n        from anomaly_scores_with_is_anomalous\n        order by bucket_end, dimension_value\n      )\n\n      select * from final_results\n      where 1 = 1) results\n    where is_anomalous = true"}, "configuration": {"test_name": "dimension_anomalies", "timestamp_column": null, "testing_timeframe": "1 day", "anomaly_threshold": null}, "test_tags": ["elementary-tests"], "normalized_full_path": "elementary_tutorial/models/schema.yml"}, "test_results": {"display_name": "Generic", "metrics": {"headers": [{"id": "anomalous_value_timestamp", "display_name": "timestamp", "type": "date"}, {"id": "anomalous_value_generic", "display_name": "generic", "type": "int"}, {"id": "anomalous_value_average_generic", "display_name": "average generic", "type": "int"}], "test_rows_sample": []}, "result_description": null}}], "model.elementary_tutorial.returned_orders": [{"metadata": {"test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "elementary_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e.None.row_count", "database_name": "demo2_0821", "schema_name": "public", "table_name": "returned_orders", "column_name": null, "test_name": "volume_anomalies", "test_display_name": "Volume Anomalies", "original_path": "models/schema.yml", "latest_run_time": "2024-08-21T17:06:11+08:00", "latest_run_time_utc": "2024-08-21T09:06:11+00:00", "latest_run_status": "pass", "model_unique_id": "model.elementary_tutorial.returned_orders", "table_unique_id": "demo2_0821.public.returned_orders", "test_type": "anomaly_detection", "test_sub_type": "row_count", "test_query": "select * from (None) results\n      where\n        anomaly_score is not null and\n        upper(full_table_name) = upper(cast('DEMO2_0821.PUBLIC.RETURNED_ORDERS' as varchar(4096))) and\n        metric_name = cast('row_count' as varchar(4096))", "test_params": {"timestamp_column": "order_date", "model": "{{ get_where_subquery(ref('returned_orders')) }}", "where_expression": null, "anomaly_sensitivity": 3, "anomaly_direction": "both", "time_bucket": {"period": "day", "count": 1}, "days_back": 14, "backfill_days": 2, "seasonality": null, "freshness_column": null, "event_timestamp_column": null, "dimensions": null, "ignore_small_changes": {"spike_failure_percent_threshold": null, "drop_failure_percent_threshold": null}, "fail_on_zero": false, "detection_delay": {"period": "hour", "count": 0}, "anomaly_exclude_metrics": null, "exclude_final_results": "1 = 1"}, "test_created_at": null, "description": "Monitors the row count of your table over time.", "result": {"result_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "result_query": "select * from (None) results\n      where\n        anomaly_score is not null and\n        upper(full_table_name) = upper(cast('DEMO2_0821.PUBLIC.RETURNED_ORDERS' as varchar(4096))) and\n        metric_name = cast('row_count' as varchar(4096))"}, "configuration": {"test_name": "volume_anomalies", "timestamp_column": "order_date", "testing_timeframe": "1 day", "anomaly_threshold": 3}, "test_tags": ["elementary-tests", "table_anomalies"], "normalized_full_path": "elementary_tutorial/models/schema.yml"}, "test_results": {"display_name": "Row Count", "metrics": [{"value": 0.0, "average": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-08T00:00:00", "end_time": "2024-08-09T00:00:00", "id": "0700602e8ea08c73b91bf70d5530669e", "metric_id": "69f082aab3695c0b894ad1060a43e068", "test_execution_id": "53eb2540-e1b2-47de-9b7d-2ab627db3fc9.test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "detected_at": "2024-08-21T09:06:11.551881", "full_table_name": "DEMO2_0821.PUBLIC.RETURNED_ORDERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0.0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2024-08-08T00:00:00", "bucket_end": "2024-08-09T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 0.0, "training_avg": 0.0, "training_stddev": 0.0, "training_set_size": 2, "training_start": "2024-08-08T00:00:00", "training_end": "2024-08-09T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2024-08-21T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-09T00:00:00", "end_time": "2024-08-10T00:00:00", "id": "f13f8cd960d778c434dba21134edf471", "metric_id": "4a7761171b3d513b918d68075f05bc3f", "test_execution_id": "53eb2540-e1b2-47de-9b7d-2ab627db3fc9.test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "detected_at": "2024-08-21T09:06:11.551881", "full_table_name": "DEMO2_0821.PUBLIC.RETURNED_ORDERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0.0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2024-08-09T00:00:00", "bucket_end": "2024-08-10T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 0.0, "training_avg": 0.0, "training_stddev": 0.0, "training_set_size": 3, "training_start": "2024-08-08T00:00:00", "training_end": "2024-08-10T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2024-08-21T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-10T00:00:00", "end_time": "2024-08-11T00:00:00", "id": "be0edcd79a6f7a9ec38a4eb4254ab593", "metric_id": "18c48d1c14366291d05b802561ea9a47", "test_execution_id": "53eb2540-e1b2-47de-9b7d-2ab627db3fc9.test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "detected_at": "2024-08-21T09:06:11.551881", "full_table_name": "DEMO2_0821.PUBLIC.RETURNED_ORDERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0.0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2024-08-10T00:00:00", "bucket_end": "2024-08-11T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 0.0, "training_avg": 0.0, "training_stddev": 0.0, "training_set_size": 4, "training_start": "2024-08-08T00:00:00", "training_end": "2024-08-11T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2024-08-21T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-11T00:00:00", "end_time": "2024-08-12T00:00:00", "id": "feacb62373299f88ee3c4ebcca5f1df8", "metric_id": "8d8da24b2d61034b0a56d51bd583ea24", "test_execution_id": "53eb2540-e1b2-47de-9b7d-2ab627db3fc9.test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "detected_at": "2024-08-21T09:06:11.551881", "full_table_name": "DEMO2_0821.PUBLIC.RETURNED_ORDERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0.0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2024-08-11T00:00:00", "bucket_end": "2024-08-12T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 0.0, "training_avg": 0.0, "training_stddev": 0.0, "training_set_size": 5, "training_start": "2024-08-08T00:00:00", "training_end": "2024-08-12T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2024-08-21T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-12T00:00:00", "end_time": "2024-08-13T00:00:00", "id": "ace5335b461d8c2f523e36385b77411a", "metric_id": "608002c2f9a3ac0f64b3f988df4aca5a", "test_execution_id": "53eb2540-e1b2-47de-9b7d-2ab627db3fc9.test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "detected_at": "2024-08-21T09:06:11.551881", "full_table_name": "DEMO2_0821.PUBLIC.RETURNED_ORDERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0.0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2024-08-12T00:00:00", "bucket_end": "2024-08-13T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 0.0, "training_avg": 0.0, "training_stddev": 0.0, "training_set_size": 6, "training_start": "2024-08-08T00:00:00", "training_end": "2024-08-13T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2024-08-21T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-13T00:00:00", "end_time": "2024-08-14T00:00:00", "id": "586660675db3246fd9483625b6535aba", "metric_id": "9583073089efb4438f3526b314ac52ab", "test_execution_id": "53eb2540-e1b2-47de-9b7d-2ab627db3fc9.test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "detected_at": "2024-08-21T09:06:11.551881", "full_table_name": "DEMO2_0821.PUBLIC.RETURNED_ORDERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0.0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2024-08-13T00:00:00", "bucket_end": "2024-08-14T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 0.0, "training_avg": 0.0, "training_stddev": 0.0, "training_set_size": 7, "training_start": "2024-08-08T00:00:00", "training_end": "2024-08-14T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2024-08-21T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-14T00:00:00", "end_time": "2024-08-15T00:00:00", "id": "c58b9bfebcc2110170c7786f43dbd45f", "metric_id": "9a7466bc8dc8960840e1831727b3d021", "test_execution_id": "53eb2540-e1b2-47de-9b7d-2ab627db3fc9.test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "detected_at": "2024-08-21T09:06:11.551881", "full_table_name": "DEMO2_0821.PUBLIC.RETURNED_ORDERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0.0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2024-08-14T00:00:00", "bucket_end": "2024-08-15T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 0.0, "training_avg": 0.0, "training_stddev": 0.0, "training_set_size": 8, "training_start": "2024-08-08T00:00:00", "training_end": "2024-08-15T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2024-08-21T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-15T00:00:00", "end_time": "2024-08-16T00:00:00", "id": "377fd9dc27a8ca411a424746e026ba07", "metric_id": "3b92033084c28912f64235c75d3a0f0b", "test_execution_id": "53eb2540-e1b2-47de-9b7d-2ab627db3fc9.test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "detected_at": "2024-08-21T09:06:11.551881", "full_table_name": "DEMO2_0821.PUBLIC.RETURNED_ORDERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0.0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2024-08-15T00:00:00", "bucket_end": "2024-08-16T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 0.0, "training_avg": 0.0, "training_stddev": 0.0, "training_set_size": 9, "training_start": "2024-08-08T00:00:00", "training_end": "2024-08-16T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2024-08-21T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-16T00:00:00", "end_time": "2024-08-17T00:00:00", "id": "ba2a52848c07dc8a70e21d26718764b6", "metric_id": "c3b121002ce059b3dd2dbc243984ea12", "test_execution_id": "53eb2540-e1b2-47de-9b7d-2ab627db3fc9.test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "detected_at": "2024-08-21T09:06:11.551881", "full_table_name": "DEMO2_0821.PUBLIC.RETURNED_ORDERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0.0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2024-08-16T00:00:00", "bucket_end": "2024-08-17T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 0.0, "training_avg": 0.0, "training_stddev": 0.0, "training_set_size": 10, "training_start": "2024-08-08T00:00:00", "training_end": "2024-08-17T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2024-08-21T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-17T00:00:00", "end_time": "2024-08-18T00:00:00", "id": "112058f121bc44b114f872bc7a228b39", "metric_id": "201a36c70bf8a8e66db90a2b56a2185d", "test_execution_id": "53eb2540-e1b2-47de-9b7d-2ab627db3fc9.test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "detected_at": "2024-08-21T09:06:11.551881", "full_table_name": "DEMO2_0821.PUBLIC.RETURNED_ORDERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0.0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2024-08-17T00:00:00", "bucket_end": "2024-08-18T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 0.0, "training_avg": 0.0, "training_stddev": 0.0, "training_set_size": 11, "training_start": "2024-08-08T00:00:00", "training_end": "2024-08-18T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2024-08-21T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-18T00:00:00", "end_time": "2024-08-19T00:00:00", "id": "e8e29d2fb0a4aaebd0f06984720cf9b8", "metric_id": "4c262b0cd16c01bbbe737c230329d06e", "test_execution_id": "53eb2540-e1b2-47de-9b7d-2ab627db3fc9.test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "detected_at": "2024-08-21T09:06:11.551881", "full_table_name": "DEMO2_0821.PUBLIC.RETURNED_ORDERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0.0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2024-08-18T00:00:00", "bucket_end": "2024-08-19T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 0.0, "training_avg": 0.0, "training_stddev": 0.0, "training_set_size": 12, "training_start": "2024-08-08T00:00:00", "training_end": "2024-08-19T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2024-08-21T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-19T00:00:00", "end_time": "2024-08-20T00:00:00", "id": "1c6492dc37f633e8fcab120897263f07", "metric_id": "580758eed8ec44eaa80bf32ef7278c43", "test_execution_id": "53eb2540-e1b2-47de-9b7d-2ab627db3fc9.test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "detected_at": "2024-08-21T09:06:11.551881", "full_table_name": "DEMO2_0821.PUBLIC.RETURNED_ORDERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0.0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2024-08-19T00:00:00", "bucket_end": "2024-08-20T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 0.0, "training_avg": 0.0, "training_stddev": 0.0, "training_set_size": 13, "training_start": "2024-08-08T00:00:00", "training_end": "2024-08-20T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2024-08-21T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-20T00:00:00", "end_time": "2024-08-21T00:00:00", "id": "3e6f76c65539ac76057f392f796738e7", "metric_id": "7bcdce6602f79e140be631bcc51de0ce", "test_execution_id": "53eb2540-e1b2-47de-9b7d-2ab627db3fc9.test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "detected_at": "2024-08-21T09:06:11.551881", "full_table_name": "DEMO2_0821.PUBLIC.RETURNED_ORDERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0.0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2024-08-20T00:00:00", "bucket_end": "2024-08-21T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 0.0, "training_avg": 0.0, "training_stddev": 0.0, "training_set_size": 14, "training_start": "2024-08-08T00:00:00", "training_end": "2024-08-21T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2024-08-21T00:00:00", "is_anomalous": false}], "result_description": "The last row_count value is 0.000. The average for this metric is 0.000."}}]}, "test_results_totals": {"test.elementary_tutorial.test4_dbt_test": {"errors": 0, "warnings": 0, "passed": 0, "failures": 1}, "model.elementary_tutorial.test4schema": {"errors": 0, "warnings": 0, "passed": 1, "failures": 0}, "model.elementary_tutorial.customers": {"errors": 0, "warnings": 0, "passed": 2, "failures": 0}, "model.elementary_tutorial.test4_volume_anomaly": {"errors": 0, "warnings": 0, "passed": 1, "failures": 0}, "model.elementary_tutorial.test_practice": {"errors": 0, "warnings": 0, "passed": 0, "failures": 1}, "model.elementary_tutorial.test4_column_anomaly": {"errors": 0, "warnings": 2, "passed": 2, "failures": 1}, "model.elementary_tutorial.orders": {"errors": 0, "warnings": 0, "passed": 1, "failures": 0}, "model.elementary_tutorial.returned_orders": {"errors": 0, "warnings": 0, "passed": 1, "failures": 0}}, "test_runs": {"test.elementary_tutorial.test4_dbt_test": [{"metadata": {"test_unique_id": "test.elementary_tutorial.test4_dbt_test", "elementary_unique_id": "test.elementary_tutorial.test4_dbt_test.None.singular", "database_name": "demo2_0821", "schema_name": "public", "table_name": "test_practice", "column_name": null, "test_name": "test4_dbt_test", "test_display_name": "Test4 Dbt Test", "original_path": "tests/test4_dbt_test.sql", "latest_run_time": "2024-08-21T17:06:11+08:00", "latest_run_time_utc": "2024-08-21T09:06:11+00:00", "latest_run_status": "fail", "model_unique_id": "model.elementary_tutorial.test_practice", "table_unique_id": "demo2_0821.public.test_practice", "test_type": "dbt_test", "test_sub_type": "singular", "test_query": "-- tests/check_record_count.sql\n\nwith actual_count as (\n    select\n        count(*) as actual_count\n    from \"demo2_0821\".\"public\".\"test_practice\"\n),\nexpected_count as (\n    select 300 as expected_count\n)\n\nselect\n    actual_count,\n    expected_count\nfrom actual_count, expected_count\nwhere actual_count != expected_count", "test_params": {}, "test_created_at": null, "description": null, "result": {"result_description": "Got 1 result, configured to fail if != 0", "result_query": "-- tests/check_record_count.sql\n\nwith actual_count as (\n    select\n        count(*) as actual_count\n    from \"demo2_0821\".\"public\".\"test_practice\"\n),\nexpected_count as (\n    select 300 as expected_count\n)\n\nselect\n    actual_count,\n    expected_count\nfrom actual_count, expected_count\nwhere actual_count != expected_count"}, "configuration": {"test_name": "test4_dbt_test", "test_params": {}}, "test_tags": [], "normalized_full_path": "elementary_tutorial/tests/test4_dbt_test.sql"}, "test_runs": {"fail_rate": 1.0, "totals": {"errors": 0, "warnings": 0, "passed": 0, "failures": 3}, "invocations": [{"affected_rows": 1, "time_utc": "2024-08-21T08:55:05+00:00", "id": "d39e80c8-a6c5-4085-9bf0-81e5ceab5c05", "status": "fail", "execution_time": null}, {"affected_rows": 1, "time_utc": "2024-08-21T08:59:15+00:00", "id": "fca13d3e-a6c8-41d8-a3bf-223f31f769e9", "status": "fail", "execution_time": null}, {"affected_rows": 1, "time_utc": "2024-08-21T09:06:11+00:00", "id": "53eb2540-e1b2-47de-9b7d-2ab627db3fc9", "status": "fail", "execution_time": null}], "description": "There were 3 failures, no errors and no warnings on the last 3 test runs."}, "median_exec_time": 0.0, "last_exec_time": null}], "model.elementary_tutorial.test4schema": [{"metadata": {"test_unique_id": "test.elementary_tutorial.elementary_schema_changes_test4schema_.5b49e3c366", "elementary_unique_id": "test.elementary_tutorial.elementary_schema_changes_test4schema_.5b49e3c366", "database_name": "demo2_0821", "schema_name": "public", "table_name": "test4schema", "column_name": null, "test_name": "schema_changes", "test_display_name": "Schema Changes", "original_path": "models/schema.yml", "latest_run_time": "2024-08-21T17:06:12+08:00", "latest_run_time_utc": "2024-08-21T09:06:12+00:00", "latest_run_status": "pass", "model_unique_id": "model.elementary_tutorial.test4schema", "table_unique_id": "demo2_0821.public.test4schema", "test_type": "schema_change", "test_sub_type": "generic", "test_query": "select * from \"demo2_0821\".\"public\".\"test_5b49e3c36__schema_changes_alerts__tmp_20240821090610921185\"", "test_params": {"model": "{{ get_where_subquery(ref('test4schema')) }}"}, "test_created_at": null, "description": "Monitors schema changes on the table of deleted, added, type changed columns over time. The test will fail if the table's schema changed from the previous execution of the test.", "result": {"result_description": null, "result_query": "select * from \"demo2_0821\".\"public\".\"test_5b49e3c36__schema_changes_alerts__tmp_20240821090610921185\""}, "configuration": {"test_name": "schema_changes", "timestamp_column": null, "testing_timeframe": "1 day", "anomaly_threshold": null}, "test_tags": ["elementary", "elementary-tests"], "normalized_full_path": "elementary_tutorial/models/schema.yml"}, "test_runs": {"fail_rate": 0.0, "totals": {"errors": 0, "warnings": 1, "passed": 2, "failures": 0}, "invocations": [{"affected_rows": null, "time_utc": "2024-08-21T08:55:06+00:00", "id": "d39e80c8-a6c5-4085-9bf0-81e5ceab5c05", "status": "pass", "execution_time": null}, {"affected_rows": null, "time_utc": "2024-08-21T08:59:14+00:00", "id": "fca13d3e-a6c8-41d8-a3bf-223f31f769e9", "status": "warn", "execution_time": null}, {"affected_rows": null, "time_utc": "2024-08-21T09:06:12+00:00", "id": "53eb2540-e1b2-47de-9b7d-2ab627db3fc9", "status": "pass", "execution_time": null}], "description": "There were no failures, no errors and 1 warnings on the last 3 test runs."}, "median_exec_time": 0.0, "last_exec_time": null}], "model.elementary_tutorial.customers": [{"metadata": {"test_unique_id": "test.elementary_tutorial.elementary_column_anomalies_customers_zero_count__number_of_orders__signup_date.e012735381", "elementary_unique_id": "test.elementary_tutorial.elementary_column_anomalies_customers_zero_count__number_of_orders__signup_date.e012735381.number_of_orders.generic", "database_name": "demo2_0821", "schema_name": "public", "table_name": "customers", "column_name": "number_of_orders", "test_name": "column_anomalies", "test_display_name": "Column Anomalies", "original_path": "models/schema.yml", "latest_run_time": "2024-08-21T17:06:12+08:00", "latest_run_time_utc": "2024-08-21T09:06:12+00:00", "latest_run_status": "pass", "model_unique_id": "model.elementary_tutorial.customers", "table_unique_id": "demo2_0821.public.customers", "test_type": "anomaly_detection", "test_sub_type": "generic", "test_query": "select * from (with anomaly_scores as (\n        select\n            id,\n            metric_id,\n            test_execution_id,\n            test_unique_id,\n            detected_at,\n            full_table_name,\n            column_name,\n            metric_name,\n            anomaly_score,\n            anomaly_score_threshold,\n            anomalous_value,\n            bucket_start,\n            bucket_end,\n            bucket_seasonality,\n            metric_value,\n            min_metric_value,\n            max_metric_value,\n            training_avg,\n            training_stddev,\n            training_set_size,\n            training_start,\n            training_end,\n            dimension,\n            dimension_value,\n            \n    case\n        when dimension is not null and column_name is null then \n    'The last ' || metric_name || ' value for dimension ' || dimension || ' - ' ||\n    case when dimension_value is null then 'NULL' else dimension_value end || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when dimension is not null and column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value for dimension ' || dimension || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when metric_name = 'freshness' then \n    'Last update was at ' || anomalous_value || ', ' || cast(abs(round(cast(metric_value/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours ago. Usually the table is updated within ' || cast(abs(round(cast(training_avg/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours.'\n\n        when column_name is null then \n    'The last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        else null\n    end as anomaly_description\n,\n            max(bucket_end) over (partition by test_execution_id) as max_bucket_end\n        from \"demo2_0821\".\"public\".\"test_e012735381_eleme__anomaly_scores__tmp_20240821090609590753\"\n      ),\n      anomaly_scores_with_is_anomalous as (\n        select\n          *,\ncase when\n          (\n            \n  (anomaly_score is not null and\n  (\n    \n  (\n    metric_value = 0 and \n    \n      1 = 2\n    \n  )\n or\n    (\n      case when metric_name IN \n        ( 'freshness' ,  'event_freshness'  )\n then\n            anomaly_score > 3\n    else\n        \n        abs(anomaly_score) > 3\n    \n\n     end and\n      (\n  \n  \n  \n  \n    \n        (1 = 1)\n    \n\n    and\n\n    \n        (1 = 1)\n    \n  \n  )\n    )\n  ))\n\n          )\n          and bucket_end >= \n    cast(max_bucket_end as timestamp) + cast('-2' as integer) * INTERVAL '1 day'\n\n          then TRUE else FALSE end as is_anomalous\n        from anomaly_scores\n      ),\n\n      final_results as (\n          select\n          metric_value as value,\n          training_avg as average,\n          \n          case\n          when is_anomalous = TRUE and 'both' = 'spike' then\n          lag(metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when is_anomalous = TRUE and 'both' != 'spike' then\n          lag(min_metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when 'both' = 'spike' then metric_value\n          else min_metric_value end as min_value,\n          case\n          when is_anomalous = TRUE and 'both' = 'drop' then\n          lag(metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when is_anomalous = TRUE and 'both' != 'drop' then\n          lag(max_metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when 'both' = 'drop' then metric_value\n          else max_metric_value end as max_value,\n          bucket_start as start_time,\n          bucket_end as end_time,\n          *\n        from anomaly_scores_with_is_anomalous\n        order by bucket_end, dimension_value\n      )\n\n      select * from final_results\n      where 1 = 1) results\n    where is_anomalous = true", "test_params": {"column_anomalies": ["zero_count"], "timestamp_column": "signup_date", "column_name": "number_of_orders", "model": "{{ get_where_subquery(ref('customers')) }}"}, "test_created_at": null, "description": "Column-level anomaly monitors (null_count, null_percent, zero_count, string_length, variance, etc.) on the column according to its data type.", "result": {"result_description": null, "result_query": "select * from (with anomaly_scores as (\n        select\n            id,\n            metric_id,\n            test_execution_id,\n            test_unique_id,\n            detected_at,\n            full_table_name,\n            column_name,\n            metric_name,\n            anomaly_score,\n            anomaly_score_threshold,\n            anomalous_value,\n            bucket_start,\n            bucket_end,\n            bucket_seasonality,\n            metric_value,\n            min_metric_value,\n            max_metric_value,\n            training_avg,\n            training_stddev,\n            training_set_size,\n            training_start,\n            training_end,\n            dimension,\n            dimension_value,\n            \n    case\n        when dimension is not null and column_name is null then \n    'The last ' || metric_name || ' value for dimension ' || dimension || ' - ' ||\n    case when dimension_value is null then 'NULL' else dimension_value end || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when dimension is not null and column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value for dimension ' || dimension || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when metric_name = 'freshness' then \n    'Last update was at ' || anomalous_value || ', ' || cast(abs(round(cast(metric_value/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours ago. Usually the table is updated within ' || cast(abs(round(cast(training_avg/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours.'\n\n        when column_name is null then \n    'The last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        else null\n    end as anomaly_description\n,\n            max(bucket_end) over (partition by test_execution_id) as max_bucket_end\n        from \"demo2_0821\".\"public\".\"test_e012735381_eleme__anomaly_scores__tmp_20240821090609590753\"\n      ),\n      anomaly_scores_with_is_anomalous as (\n        select\n          *,\ncase when\n          (\n            \n  (anomaly_score is not null and\n  (\n    \n  (\n    metric_value = 0 and \n    \n      1 = 2\n    \n  )\n or\n    (\n      case when metric_name IN \n        ( 'freshness' ,  'event_freshness'  )\n then\n            anomaly_score > 3\n    else\n        \n        abs(anomaly_score) > 3\n    \n\n     end and\n      (\n  \n  \n  \n  \n    \n        (1 = 1)\n    \n\n    and\n\n    \n        (1 = 1)\n    \n  \n  )\n    )\n  ))\n\n          )\n          and bucket_end >= \n    cast(max_bucket_end as timestamp) + cast('-2' as integer) * INTERVAL '1 day'\n\n          then TRUE else FALSE end as is_anomalous\n        from anomaly_scores\n      ),\n\n      final_results as (\n          select\n          metric_value as value,\n          training_avg as average,\n          \n          case\n          when is_anomalous = TRUE and 'both' = 'spike' then\n          lag(metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when is_anomalous = TRUE and 'both' != 'spike' then\n          lag(min_metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when 'both' = 'spike' then metric_value\n          else min_metric_value end as min_value,\n          case\n          when is_anomalous = TRUE and 'both' = 'drop' then\n          lag(metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when is_anomalous = TRUE and 'both' != 'drop' then\n          lag(max_metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when 'both' = 'drop' then metric_value\n          else max_metric_value end as max_value,\n          bucket_start as start_time,\n          bucket_end as end_time,\n          *\n        from anomaly_scores_with_is_anomalous\n        order by bucket_end, dimension_value\n      )\n\n      select * from final_results\n      where 1 = 1) results\n    where is_anomalous = true"}, "configuration": {"test_name": "column_anomalies", "timestamp_column": "signup_date", "testing_timeframe": "1 day", "anomaly_threshold": null}, "test_tags": ["column_anomalies", "elementary-tests"], "normalized_full_path": "elementary_tutorial/models/schema.yml"}, "test_runs": {"fail_rate": 0.0, "totals": {"errors": 0, "warnings": 0, "passed": 3, "failures": 0}, "invocations": [{"affected_rows": null, "time_utc": "2024-08-21T08:55:06+00:00", "id": "d39e80c8-a6c5-4085-9bf0-81e5ceab5c05", "status": "pass", "execution_time": null}, {"affected_rows": null, "time_utc": "2024-08-21T08:59:16+00:00", "id": "fca13d3e-a6c8-41d8-a3bf-223f31f769e9", "status": "pass", "execution_time": null}, {"affected_rows": null, "time_utc": "2024-08-21T09:06:12+00:00", "id": "53eb2540-e1b2-47de-9b7d-2ab627db3fc9", "status": "pass", "execution_time": null}], "description": "There were no failures, no errors and no warnings on the last 3 test runs."}, "median_exec_time": 0.0, "last_exec_time": null}, {"metadata": {"test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_customers_1.f225f4677c", "elementary_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_customers_1.f225f4677c.None.row_count", "database_name": "demo2_0821", "schema_name": "public", "table_name": "customers", "column_name": null, "test_name": "volume_anomalies", "test_display_name": "Volume Anomalies", "original_path": "models/schema.yml", "latest_run_time": "2024-08-21T17:06:11+08:00", "latest_run_time_utc": "2024-08-21T09:06:11+00:00", "latest_run_status": "pass", "model_unique_id": "model.elementary_tutorial.customers", "table_unique_id": "demo2_0821.public.customers", "test_type": "anomaly_detection", "test_sub_type": "row_count", "test_query": "select * from (None) results\n      where\n        anomaly_score is not null and\n        upper(full_table_name) = upper(cast('DEMO2_0821.PUBLIC.CUSTOMERS' as varchar(4096))) and\n        metric_name = cast('row_count' as varchar(4096))", "test_params": {"anomaly_sensitivity": 1, "model": "{{ get_where_subquery(ref('customers')) }}", "timestamp_column": "signup_date", "where_expression": null, "anomaly_direction": "both", "time_bucket": {"period": "day", "count": 1}, "days_back": 14, "backfill_days": 2, "seasonality": null, "freshness_column": null, "event_timestamp_column": null, "dimensions": null, "ignore_small_changes": {"spike_failure_percent_threshold": null, "drop_failure_percent_threshold": null}, "fail_on_zero": false, "detection_delay": {"period": "hour", "count": 0}, "anomaly_exclude_metrics": null, "exclude_final_results": "1 = 1"}, "test_created_at": null, "description": "Monitors the row count of your table over time.", "result": {"result_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "result_query": "select * from (None) results\n      where\n        anomaly_score is not null and\n        upper(full_table_name) = upper(cast('DEMO2_0821.PUBLIC.CUSTOMERS' as varchar(4096))) and\n        metric_name = cast('row_count' as varchar(4096))"}, "configuration": {"test_name": "volume_anomalies", "timestamp_column": "signup_date", "testing_timeframe": "1 day", "anomaly_threshold": 1}, "test_tags": ["elementary-tests", "volume_anomalies"], "normalized_full_path": "elementary_tutorial/models/schema.yml"}, "test_runs": {"fail_rate": 0.0, "totals": {"errors": 0, "warnings": 0, "passed": 3, "failures": 0}, "invocations": [{"affected_rows": null, "time_utc": "2024-08-21T08:55:05+00:00", "id": "d39e80c8-a6c5-4085-9bf0-81e5ceab5c05", "status": "pass", "execution_time": null}, {"affected_rows": null, "time_utc": "2024-08-21T08:59:15+00:00", "id": "fca13d3e-a6c8-41d8-a3bf-223f31f769e9", "status": "pass", "execution_time": null}, {"affected_rows": null, "time_utc": "2024-08-21T09:06:11+00:00", "id": "53eb2540-e1b2-47de-9b7d-2ab627db3fc9", "status": "pass", "execution_time": null}], "description": "There were no failures, no errors and no warnings on the last 3 test runs."}, "median_exec_time": 0.0, "last_exec_time": null}], "model.elementary_tutorial.test4_volume_anomaly": [{"metadata": {"test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_test4_volume_anomaly_1.22dd1cb7dd", "elementary_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_test4_volume_anomaly_1.22dd1cb7dd.None.row_count", "database_name": "demo2_0821", "schema_name": "public", "table_name": "test4_volume_anomaly", "column_name": null, "test_name": "volume_anomalies", "test_display_name": "Volume Anomalies", "original_path": "models/schema.yml", "latest_run_time": "2024-08-21T17:06:11+08:00", "latest_run_time_utc": "2024-08-21T09:06:11+00:00", "latest_run_status": "pass", "model_unique_id": "model.elementary_tutorial.test4_volume_anomaly", "table_unique_id": "demo2_0821.public.test4_volume_anomaly", "test_type": "anomaly_detection", "test_sub_type": "row_count", "test_query": "select * from (None) results\n      where\n        anomaly_score is not null and\n        upper(full_table_name) = upper(cast('DEMO2_0821.PUBLIC.TEST4_VOLUME_ANOMALY' as varchar(4096))) and\n        metric_name = cast('row_count' as varchar(4096))", "test_params": {"anomaly_sensitivity": 1, "model": "{{ get_where_subquery(ref('test4_volume_anomaly')) }}", "timestamp_column": "birth", "where_expression": null, "anomaly_direction": "both", "time_bucket": {"period": "day", "count": 1}, "days_back": 14, "backfill_days": 2, "seasonality": null, "freshness_column": null, "event_timestamp_column": null, "dimensions": null, "ignore_small_changes": {"spike_failure_percent_threshold": null, "drop_failure_percent_threshold": null}, "fail_on_zero": false, "detection_delay": {"period": "hour", "count": 0}, "anomaly_exclude_metrics": null, "exclude_final_results": "1 = 1"}, "test_created_at": null, "description": "Monitors the row count of your table over time.", "result": {"result_description": "The last row_count value is 0.000. The average for this metric is 209.286.", "result_query": "select * from (None) results\n      where\n        anomaly_score is not null and\n        upper(full_table_name) = upper(cast('DEMO2_0821.PUBLIC.TEST4_VOLUME_ANOMALY' as varchar(4096))) and\n        metric_name = cast('row_count' as varchar(4096))"}, "configuration": {"test_name": "volume_anomalies", "timestamp_column": "birth", "testing_timeframe": "1 day", "anomaly_threshold": 1}, "test_tags": ["column_test", "elementary-tests"], "normalized_full_path": "elementary_tutorial/models/schema.yml"}, "test_runs": {"fail_rate": 0.0, "totals": {"errors": 0, "warnings": 0, "passed": 3, "failures": 0}, "invocations": [{"affected_rows": null, "time_utc": "2024-08-21T08:55:05+00:00", "id": "d39e80c8-a6c5-4085-9bf0-81e5ceab5c05", "status": "pass", "execution_time": null}, {"affected_rows": null, "time_utc": "2024-08-21T08:59:15+00:00", "id": "fca13d3e-a6c8-41d8-a3bf-223f31f769e9", "status": "pass", "execution_time": null}, {"affected_rows": null, "time_utc": "2024-08-21T09:06:11+00:00", "id": "53eb2540-e1b2-47de-9b7d-2ab627db3fc9", "status": "pass", "execution_time": null}], "description": "There were no failures, no errors and no warnings on the last 3 test runs."}, "median_exec_time": 0.0, "last_exec_time": null}], "model.elementary_tutorial.test_practice": [{"metadata": {"test_unique_id": "test.elementary_tutorial.test4_dbt_test", "elementary_unique_id": "test.elementary_tutorial.test4_dbt_test.None.singular", "database_name": "demo2_0821", "schema_name": "public", "table_name": "test_practice", "column_name": null, "test_name": "test4_dbt_test", "test_display_name": "Test4 Dbt Test", "original_path": "tests/test4_dbt_test.sql", "latest_run_time": "2024-08-21T17:06:11+08:00", "latest_run_time_utc": "2024-08-21T09:06:11+00:00", "latest_run_status": "fail", "model_unique_id": "model.elementary_tutorial.test_practice", "table_unique_id": "demo2_0821.public.test_practice", "test_type": "dbt_test", "test_sub_type": "singular", "test_query": "-- tests/check_record_count.sql\n\nwith actual_count as (\n    select\n        count(*) as actual_count\n    from \"demo2_0821\".\"public\".\"test_practice\"\n),\nexpected_count as (\n    select 300 as expected_count\n)\n\nselect\n    actual_count,\n    expected_count\nfrom actual_count, expected_count\nwhere actual_count != expected_count", "test_params": {}, "test_created_at": null, "description": null, "result": {"result_description": "Got 1 result, configured to fail if != 0", "result_query": "-- tests/check_record_count.sql\n\nwith actual_count as (\n    select\n        count(*) as actual_count\n    from \"demo2_0821\".\"public\".\"test_practice\"\n),\nexpected_count as (\n    select 300 as expected_count\n)\n\nselect\n    actual_count,\n    expected_count\nfrom actual_count, expected_count\nwhere actual_count != expected_count"}, "configuration": {"test_name": "test4_dbt_test", "test_params": {}}, "test_tags": [], "normalized_full_path": "elementary_tutorial/tests/test4_dbt_test.sql"}, "test_runs": {"fail_rate": 1.0, "totals": {"errors": 0, "warnings": 0, "passed": 0, "failures": 3}, "invocations": [{"affected_rows": 1, "time_utc": "2024-08-21T08:55:05+00:00", "id": "d39e80c8-a6c5-4085-9bf0-81e5ceab5c05", "status": "fail", "execution_time": null}, {"affected_rows": 1, "time_utc": "2024-08-21T08:59:15+00:00", "id": "fca13d3e-a6c8-41d8-a3bf-223f31f769e9", "status": "fail", "execution_time": null}, {"affected_rows": 1, "time_utc": "2024-08-21T09:06:11+00:00", "id": "53eb2540-e1b2-47de-9b7d-2ab627db3fc9", "status": "fail", "execution_time": null}], "description": "There were 3 failures, no errors and no warnings on the last 3 test runs."}, "median_exec_time": 0.0, "last_exec_time": null}], "model.elementary_tutorial.test4_column_anomaly": [{"metadata": {"test_unique_id": "test.elementary_tutorial.elementary_column_anomalies_test4_column_anomaly_1__null_count__name.5c88e6fb20", "elementary_unique_id": "test.elementary_tutorial.elementary_column_anomalies_test4_column_anomaly_1__null_count__name.5c88e6fb20.name.generic", "database_name": "demo2_0821", "schema_name": "public", "table_name": "test4_column_anomaly", "column_name": "name", "test_name": "column_anomalies", "test_display_name": "Column Anomalies", "original_path": "models/schema.yml", "latest_run_time": "2024-08-21T16:55:06+08:00", "latest_run_time_utc": "2024-08-21T08:55:06+00:00", "latest_run_status": "pass", "model_unique_id": "model.elementary_tutorial.test4_column_anomaly", "table_unique_id": "demo2_0821.public.test4_column_anomaly", "test_type": "anomaly_detection", "test_sub_type": "generic", "test_query": "select * from (with anomaly_scores as (\n        select\n            id,\n            metric_id,\n            test_execution_id,\n            test_unique_id,\n            detected_at,\n            full_table_name,\n            column_name,\n            metric_name,\n            anomaly_score,\n            anomaly_score_threshold,\n            anomalous_value,\n            bucket_start,\n            bucket_end,\n            bucket_seasonality,\n            metric_value,\n            min_metric_value,\n            max_metric_value,\n            training_avg,\n            training_stddev,\n            training_set_size,\n            training_start,\n            training_end,\n            dimension,\n            dimension_value,\n            \n    case\n        when dimension is not null and column_name is null then \n    'The last ' || metric_name || ' value for dimension ' || dimension || ' - ' ||\n    case when dimension_value is null then 'NULL' else dimension_value end || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when dimension is not null and column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value for dimension ' || dimension || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when metric_name = 'freshness' then \n    'Last update was at ' || anomalous_value || ', ' || cast(abs(round(cast(metric_value/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours ago. Usually the table is updated within ' || cast(abs(round(cast(training_avg/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours.'\n\n        when column_name is null then \n    'The last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        else null\n    end as anomaly_description\n,\n            max(bucket_end) over (partition by test_execution_id) as max_bucket_end\n        from \"demo2_0821\".\"public\".\"test_5c88e6fb20_eleme__anomaly_scores__tmp_20240821085503776911\"\n      ),\n      anomaly_scores_with_is_anomalous as (\n        select\n          *,\ncase when\n          (\n            \n  (anomaly_score is not null and\n  (\n    \n  (\n    metric_value = 0 and \n    \n      1 = 2\n    \n  )\n or\n    (\n      case when metric_name IN \n        ( 'freshness' ,  'event_freshness'  )\n then\n            anomaly_score > 1\n    else\n        \n        abs(anomaly_score) > 1\n    \n\n     end and\n      (\n  \n  \n  \n  \n    \n        (1 = 1)\n    \n\n    and\n\n    \n        (1 = 1)\n    \n  \n  )\n    )\n  ))\n\n          )\n          and bucket_end >= \n    cast(max_bucket_end as timestamp) + cast('-2' as integer) * INTERVAL '1 day'\n\n          then TRUE else FALSE end as is_anomalous\n        from anomaly_scores\n      ),\n\n      final_results as (\n          select\n          metric_value as value,\n          training_avg as average,\n          \n          case\n          when is_anomalous = TRUE and 'both' = 'spike' then\n          lag(metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when is_anomalous = TRUE and 'both' != 'spike' then\n          lag(min_metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when 'both' = 'spike' then metric_value\n          else min_metric_value end as min_value,\n          case\n          when is_anomalous = TRUE and 'both' = 'drop' then\n          lag(metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when is_anomalous = TRUE and 'both' != 'drop' then\n          lag(max_metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when 'both' = 'drop' then metric_value\n          else max_metric_value end as max_value,\n          bucket_start as start_time,\n          bucket_end as end_time,\n          *\n        from anomaly_scores_with_is_anomalous\n        order by bucket_end, dimension_value\n      )\n\n      select * from final_results\n      where 1 = 1) results\n    where is_anomalous = true", "test_params": {"column_anomalies": ["null_count"], "anomaly_sensitivity": 1, "column_name": "name", "model": "{{ get_where_subquery(ref('test4_column_anomaly')) }}"}, "test_created_at": null, "description": "Column-level anomaly monitors (null_count, null_percent, zero_count, string_length, variance, etc.) on the column according to its data type.", "result": {"result_description": null, "result_query": "select * from (with anomaly_scores as (\n        select\n            id,\n            metric_id,\n            test_execution_id,\n            test_unique_id,\n            detected_at,\n            full_table_name,\n            column_name,\n            metric_name,\n            anomaly_score,\n            anomaly_score_threshold,\n            anomalous_value,\n            bucket_start,\n            bucket_end,\n            bucket_seasonality,\n            metric_value,\n            min_metric_value,\n            max_metric_value,\n            training_avg,\n            training_stddev,\n            training_set_size,\n            training_start,\n            training_end,\n            dimension,\n            dimension_value,\n            \n    case\n        when dimension is not null and column_name is null then \n    'The last ' || metric_name || ' value for dimension ' || dimension || ' - ' ||\n    case when dimension_value is null then 'NULL' else dimension_value end || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when dimension is not null and column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value for dimension ' || dimension || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when metric_name = 'freshness' then \n    'Last update was at ' || anomalous_value || ', ' || cast(abs(round(cast(metric_value/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours ago. Usually the table is updated within ' || cast(abs(round(cast(training_avg/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours.'\n\n        when column_name is null then \n    'The last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        else null\n    end as anomaly_description\n,\n            max(bucket_end) over (partition by test_execution_id) as max_bucket_end\n        from \"demo2_0821\".\"public\".\"test_5c88e6fb20_eleme__anomaly_scores__tmp_20240821085503776911\"\n      ),\n      anomaly_scores_with_is_anomalous as (\n        select\n          *,\ncase when\n          (\n            \n  (anomaly_score is not null and\n  (\n    \n  (\n    metric_value = 0 and \n    \n      1 = 2\n    \n  )\n or\n    (\n      case when metric_name IN \n        ( 'freshness' ,  'event_freshness'  )\n then\n            anomaly_score > 1\n    else\n        \n        abs(anomaly_score) > 1\n    \n\n     end and\n      (\n  \n  \n  \n  \n    \n        (1 = 1)\n    \n\n    and\n\n    \n        (1 = 1)\n    \n  \n  )\n    )\n  ))\n\n          )\n          and bucket_end >= \n    cast(max_bucket_end as timestamp) + cast('-2' as integer) * INTERVAL '1 day'\n\n          then TRUE else FALSE end as is_anomalous\n        from anomaly_scores\n      ),\n\n      final_results as (\n          select\n          metric_value as value,\n          training_avg as average,\n          \n          case\n          when is_anomalous = TRUE and 'both' = 'spike' then\n          lag(metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when is_anomalous = TRUE and 'both' != 'spike' then\n          lag(min_metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when 'both' = 'spike' then metric_value\n          else min_metric_value end as min_value,\n          case\n          when is_anomalous = TRUE and 'both' = 'drop' then\n          lag(metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when is_anomalous = TRUE and 'both' != 'drop' then\n          lag(max_metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when 'both' = 'drop' then metric_value\n          else max_metric_value end as max_value,\n          bucket_start as start_time,\n          bucket_end as end_time,\n          *\n        from anomaly_scores_with_is_anomalous\n        order by bucket_end, dimension_value\n      )\n\n      select * from final_results\n      where 1 = 1) results\n    where is_anomalous = true"}, "configuration": {"test_name": "column_anomalies", "timestamp_column": null, "testing_timeframe": "1 day", "anomaly_threshold": 1}, "test_tags": ["column_anomalies", "elementary-tests"], "normalized_full_path": "elementary_tutorial/models/schema.yml"}, "test_runs": {"fail_rate": 0.0, "totals": {"errors": 0, "warnings": 0, "passed": 1, "failures": 0}, "invocations": [{"affected_rows": null, "time_utc": "2024-08-21T08:55:06+00:00", "id": "d39e80c8-a6c5-4085-9bf0-81e5ceab5c05", "status": "pass", "execution_time": null}], "description": "There were no failures, no errors and no warnings on the last 1 test runs."}, "median_exec_time": 0.0, "last_exec_time": null}, {"metadata": {"test_unique_id": "test.elementary_tutorial.elementary_column_anomalies_test4_column_anomaly_1__null_count__name.5c88e6fb20", "elementary_unique_id": "test.elementary_tutorial.elementary_column_anomalies_test4_column_anomaly_1__null_count__name.5c88e6fb20.name.null_count", "database_name": "demo2_0821", "schema_name": "public", "table_name": "test4_column_anomaly", "column_name": "name", "test_name": "column_anomalies", "test_display_name": "Column Anomalies", "original_path": "models/schema.yml", "latest_run_time": "2024-08-21T17:06:10+08:00", "latest_run_time_utc": "2024-08-21T09:06:10+00:00", "latest_run_status": "fail", "model_unique_id": "model.elementary_tutorial.test4_column_anomaly", "table_unique_id": "demo2_0821.public.test4_column_anomaly", "test_type": "anomaly_detection", "test_sub_type": "null_count", "test_query": "select * from (None) results\n      where\n        anomaly_score is not null and\n        upper(full_table_name) = upper(cast('DEMO2_0821.PUBLIC.TEST4_COLUMN_ANOMALY' as varchar(4096))) and\n        metric_name = cast('null_count' as varchar(4096))\n          and upper(column_name) = upper(cast('name' as varchar(4096)))", "test_params": {"column_anomalies": ["null_count"], "anomaly_sensitivity": 1, "column_name": "name", "model": "{{ get_where_subquery(ref('test4_column_anomaly')) }}", "timestamp_column": "birth", "where_expression": null, "anomaly_direction": "both", "time_bucket": {"period": "day", "count": 1}, "days_back": 14, "backfill_days": 2, "seasonality": null, "freshness_column": null, "event_timestamp_column": null, "dimensions": null, "ignore_small_changes": {"spike_failure_percent_threshold": null, "drop_failure_percent_threshold": null}, "fail_on_zero": false, "detection_delay": {"period": "hour", "count": 0}, "anomaly_exclude_metrics": null, "exclude_final_results": "1 = 1"}, "test_created_at": null, "description": "Column-level anomaly monitors (null_count, null_percent, zero_count, string_length, variance, etc.) on the column according to its data type.", "result": {"result_description": "In column name, the last null_count value is 0.000. The average for this metric is 21.667.", "result_query": "select * from (None) results\n      where\n        anomaly_score is not null and\n        upper(full_table_name) = upper(cast('DEMO2_0821.PUBLIC.TEST4_COLUMN_ANOMALY' as varchar(4096))) and\n        metric_name = cast('null_count' as varchar(4096))\n          and upper(column_name) = upper(cast('name' as varchar(4096)))"}, "configuration": {"test_name": "column_anomalies", "timestamp_column": "birth", "testing_timeframe": "1 day", "anomaly_threshold": 1}, "test_tags": ["column_anomalies", "elementary-tests"], "normalized_full_path": "elementary_tutorial/models/schema.yml"}, "test_runs": {"fail_rate": 1.0, "totals": {"errors": 0, "warnings": 0, "passed": 0, "failures": 2}, "invocations": [{"affected_rows": null, "time_utc": "2024-08-21T08:59:14+00:00", "id": "fca13d3e-a6c8-41d8-a3bf-223f31f769e9", "status": "fail", "execution_time": null}, {"affected_rows": null, "time_utc": "2024-08-21T09:06:10+00:00", "id": "53eb2540-e1b2-47de-9b7d-2ab627db3fc9", "status": "fail", "execution_time": null}], "description": "There were 2 failures, no errors and no warnings on the last 2 test runs."}, "median_exec_time": 0.0, "last_exec_time": null}, {"metadata": {"test_unique_id": "test.elementary_tutorial.elementary_column_anomalies_test4_column_anomaly_1__zero_count__max__age.21be7f55a1", "elementary_unique_id": "test.elementary_tutorial.elementary_column_anomalies_test4_column_anomaly_1__zero_count__max__age.21be7f55a1.age.generic", "database_name": "demo2_0821", "schema_name": "public", "table_name": "test4_column_anomaly", "column_name": "age", "test_name": "column_anomalies", "test_display_name": "Column Anomalies", "original_path": "models/schema.yml", "latest_run_time": "2024-08-21T16:55:06+08:00", "latest_run_time_utc": "2024-08-21T08:55:06+00:00", "latest_run_status": "pass", "model_unique_id": "model.elementary_tutorial.test4_column_anomaly", "table_unique_id": "demo2_0821.public.test4_column_anomaly", "test_type": "anomaly_detection", "test_sub_type": "generic", "test_query": "select * from (with anomaly_scores as (\n        select\n            id,\n            metric_id,\n            test_execution_id,\n            test_unique_id,\n            detected_at,\n            full_table_name,\n            column_name,\n            metric_name,\n            anomaly_score,\n            anomaly_score_threshold,\n            anomalous_value,\n            bucket_start,\n            bucket_end,\n            bucket_seasonality,\n            metric_value,\n            min_metric_value,\n            max_metric_value,\n            training_avg,\n            training_stddev,\n            training_set_size,\n            training_start,\n            training_end,\n            dimension,\n            dimension_value,\n            \n    case\n        when dimension is not null and column_name is null then \n    'The last ' || metric_name || ' value for dimension ' || dimension || ' - ' ||\n    case when dimension_value is null then 'NULL' else dimension_value end || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when dimension is not null and column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value for dimension ' || dimension || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when metric_name = 'freshness' then \n    'Last update was at ' || anomalous_value || ', ' || cast(abs(round(cast(metric_value/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours ago. Usually the table is updated within ' || cast(abs(round(cast(training_avg/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours.'\n\n        when column_name is null then \n    'The last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        else null\n    end as anomaly_description\n,\n            max(bucket_end) over (partition by test_execution_id) as max_bucket_end\n        from \"demo2_0821\".\"public\".\"test_21be7f55a1_eleme__anomaly_scores__tmp_20240821085504073902\"\n      ),\n      anomaly_scores_with_is_anomalous as (\n        select\n          *,\ncase when\n          (\n            \n  (anomaly_score is not null and\n  (\n    \n  (\n    metric_value = 0 and \n    \n      1 = 2\n    \n  )\n or\n    (\n      case when metric_name IN \n        ( 'freshness' ,  'event_freshness'  )\n then\n            anomaly_score > 1\n    else\n        \n        abs(anomaly_score) > 1\n    \n\n     end and\n      (\n  \n  \n  \n  \n    \n        (1 = 1)\n    \n\n    and\n\n    \n        (1 = 1)\n    \n  \n  )\n    )\n  ))\n\n          )\n          and bucket_end >= \n    cast(max_bucket_end as timestamp) + cast('-2' as integer) * INTERVAL '1 day'\n\n          then TRUE else FALSE end as is_anomalous\n        from anomaly_scores\n      ),\n\n      final_results as (\n          select\n          metric_value as value,\n          training_avg as average,\n          \n          case\n          when is_anomalous = TRUE and 'both' = 'spike' then\n          lag(metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when is_anomalous = TRUE and 'both' != 'spike' then\n          lag(min_metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when 'both' = 'spike' then metric_value\n          else min_metric_value end as min_value,\n          case\n          when is_anomalous = TRUE and 'both' = 'drop' then\n          lag(metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when is_anomalous = TRUE and 'both' != 'drop' then\n          lag(max_metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when 'both' = 'drop' then metric_value\n          else max_metric_value end as max_value,\n          bucket_start as start_time,\n          bucket_end as end_time,\n          *\n        from anomaly_scores_with_is_anomalous\n        order by bucket_end, dimension_value\n      )\n\n      select * from final_results\n      where 1 = 1) results\n    where is_anomalous = true", "test_params": {"column_anomalies": ["zero_count", "max"], "anomaly_sensitivity": 1, "column_name": "age", "model": "{{ get_where_subquery(ref('test4_column_anomaly')) }}"}, "test_created_at": null, "description": "Column-level anomaly monitors (null_count, null_percent, zero_count, string_length, variance, etc.) on the column according to its data type.", "result": {"result_description": null, "result_query": "select * from (with anomaly_scores as (\n        select\n            id,\n            metric_id,\n            test_execution_id,\n            test_unique_id,\n            detected_at,\n            full_table_name,\n            column_name,\n            metric_name,\n            anomaly_score,\n            anomaly_score_threshold,\n            anomalous_value,\n            bucket_start,\n            bucket_end,\n            bucket_seasonality,\n            metric_value,\n            min_metric_value,\n            max_metric_value,\n            training_avg,\n            training_stddev,\n            training_set_size,\n            training_start,\n            training_end,\n            dimension,\n            dimension_value,\n            \n    case\n        when dimension is not null and column_name is null then \n    'The last ' || metric_name || ' value for dimension ' || dimension || ' - ' ||\n    case when dimension_value is null then 'NULL' else dimension_value end || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when dimension is not null and column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value for dimension ' || dimension || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when metric_name = 'freshness' then \n    'Last update was at ' || anomalous_value || ', ' || cast(abs(round(cast(metric_value/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours ago. Usually the table is updated within ' || cast(abs(round(cast(training_avg/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours.'\n\n        when column_name is null then \n    'The last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        else null\n    end as anomaly_description\n,\n            max(bucket_end) over (partition by test_execution_id) as max_bucket_end\n        from \"demo2_0821\".\"public\".\"test_21be7f55a1_eleme__anomaly_scores__tmp_20240821085504073902\"\n      ),\n      anomaly_scores_with_is_anomalous as (\n        select\n          *,\ncase when\n          (\n            \n  (anomaly_score is not null and\n  (\n    \n  (\n    metric_value = 0 and \n    \n      1 = 2\n    \n  )\n or\n    (\n      case when metric_name IN \n        ( 'freshness' ,  'event_freshness'  )\n then\n            anomaly_score > 1\n    else\n        \n        abs(anomaly_score) > 1\n    \n\n     end and\n      (\n  \n  \n  \n  \n    \n        (1 = 1)\n    \n\n    and\n\n    \n        (1 = 1)\n    \n  \n  )\n    )\n  ))\n\n          )\n          and bucket_end >= \n    cast(max_bucket_end as timestamp) + cast('-2' as integer) * INTERVAL '1 day'\n\n          then TRUE else FALSE end as is_anomalous\n        from anomaly_scores\n      ),\n\n      final_results as (\n          select\n          metric_value as value,\n          training_avg as average,\n          \n          case\n          when is_anomalous = TRUE and 'both' = 'spike' then\n          lag(metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when is_anomalous = TRUE and 'both' != 'spike' then\n          lag(min_metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when 'both' = 'spike' then metric_value\n          else min_metric_value end as min_value,\n          case\n          when is_anomalous = TRUE and 'both' = 'drop' then\n          lag(metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when is_anomalous = TRUE and 'both' != 'drop' then\n          lag(max_metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when 'both' = 'drop' then metric_value\n          else max_metric_value end as max_value,\n          bucket_start as start_time,\n          bucket_end as end_time,\n          *\n        from anomaly_scores_with_is_anomalous\n        order by bucket_end, dimension_value\n      )\n\n      select * from final_results\n      where 1 = 1) results\n    where is_anomalous = true"}, "configuration": {"test_name": "column_anomalies", "timestamp_column": null, "testing_timeframe": "1 day", "anomaly_threshold": 1}, "test_tags": ["column_test", "elementary-tests"], "normalized_full_path": "elementary_tutorial/models/schema.yml"}, "test_runs": {"fail_rate": 0.0, "totals": {"errors": 0, "warnings": 0, "passed": 1, "failures": 0}, "invocations": [{"affected_rows": null, "time_utc": "2024-08-21T08:55:06+00:00", "id": "d39e80c8-a6c5-4085-9bf0-81e5ceab5c05", "status": "pass", "execution_time": null}], "description": "There were no failures, no errors and no warnings on the last 1 test runs."}, "median_exec_time": 0.0, "last_exec_time": null}, {"metadata": {"test_unique_id": "test.elementary_tutorial.elementary_column_anomalies_test4_column_anomaly_1__zero_count__max__age.21be7f55a1", "elementary_unique_id": "test.elementary_tutorial.elementary_column_anomalies_test4_column_anomaly_1__zero_count__max__age.21be7f55a1.age.max", "database_name": "demo2_0821", "schema_name": "public", "table_name": "test4_column_anomaly", "column_name": "age", "test_name": "column_anomalies", "test_display_name": "Column Anomalies", "original_path": "models/schema.yml", "latest_run_time": "2024-08-21T17:06:10+08:00", "latest_run_time_utc": "2024-08-21T09:06:10+00:00", "latest_run_status": "warn", "model_unique_id": "model.elementary_tutorial.test4_column_anomaly", "table_unique_id": "demo2_0821.public.test4_column_anomaly", "test_type": "anomaly_detection", "test_sub_type": "max", "test_query": "select * from (None) results\n      where\n        anomaly_score is not null and\n        upper(full_table_name) = upper(cast('DEMO2_0821.PUBLIC.TEST4_COLUMN_ANOMALY' as varchar(4096))) and\n        metric_name = cast('max' as varchar(4096))\n          and upper(column_name) = upper(cast('age' as varchar(4096)))", "test_params": {"column_anomalies": ["zero_count", "max"], "anomaly_sensitivity": 1, "column_name": "age", "model": "{{ get_where_subquery(ref('test4_column_anomaly')) }}", "timestamp_column": "birth", "where_expression": null, "anomaly_direction": "both", "time_bucket": {"period": "day", "count": 1}, "days_back": 14, "backfill_days": 2, "seasonality": null, "freshness_column": null, "event_timestamp_column": null, "dimensions": null, "ignore_small_changes": {"spike_failure_percent_threshold": null, "drop_failure_percent_threshold": null}, "fail_on_zero": false, "detection_delay": {"period": "hour", "count": 0}, "anomaly_exclude_metrics": null, "exclude_final_results": "1 = 1"}, "test_created_at": null, "description": "Column-level anomaly monitors (null_count, null_percent, zero_count, string_length, variance, etc.) on the column according to its data type.", "result": {"result_description": "In column age, the last max value is 0.000. The average for this metric is 28.833.", "result_query": "select * from (None) results\n      where\n        anomaly_score is not null and\n        upper(full_table_name) = upper(cast('DEMO2_0821.PUBLIC.TEST4_COLUMN_ANOMALY' as varchar(4096))) and\n        metric_name = cast('max' as varchar(4096))\n          and upper(column_name) = upper(cast('age' as varchar(4096)))"}, "configuration": {"test_name": "column_anomalies", "timestamp_column": "birth", "testing_timeframe": "1 day", "anomaly_threshold": 1}, "test_tags": ["column_test", "elementary-tests"], "normalized_full_path": "elementary_tutorial/models/schema.yml"}, "test_runs": {"fail_rate": 0.0, "totals": {"errors": 0, "warnings": 2, "passed": 0, "failures": 0}, "invocations": [{"affected_rows": null, "time_utc": "2024-08-21T08:59:14+00:00", "id": "fca13d3e-a6c8-41d8-a3bf-223f31f769e9", "status": "warn", "execution_time": null}, {"affected_rows": null, "time_utc": "2024-08-21T09:06:10+00:00", "id": "53eb2540-e1b2-47de-9b7d-2ab627db3fc9", "status": "warn", "execution_time": null}], "description": "There were no failures, no errors and 2 warnings on the last 2 test runs."}, "median_exec_time": 0.0, "last_exec_time": null}, {"metadata": {"test_unique_id": "test.elementary_tutorial.elementary_column_anomalies_test4_column_anomaly_1__zero_count__max__age.21be7f55a1", "elementary_unique_id": "test.elementary_tutorial.elementary_column_anomalies_test4_column_anomaly_1__zero_count__max__age.21be7f55a1.age.zero_count", "database_name": "demo2_0821", "schema_name": "public", "table_name": "test4_column_anomaly", "column_name": "age", "test_name": "column_anomalies", "test_display_name": "Column Anomalies", "original_path": "models/schema.yml", "latest_run_time": "2024-08-21T17:06:10+08:00", "latest_run_time_utc": "2024-08-21T09:06:10+00:00", "latest_run_status": "warn", "model_unique_id": "model.elementary_tutorial.test4_column_anomaly", "table_unique_id": "demo2_0821.public.test4_column_anomaly", "test_type": "anomaly_detection", "test_sub_type": "zero_count", "test_query": "select * from (None) results\n      where\n        anomaly_score is not null and\n        upper(full_table_name) = upper(cast('DEMO2_0821.PUBLIC.TEST4_COLUMN_ANOMALY' as varchar(4096))) and\n        metric_name = cast('zero_count' as varchar(4096))\n          and upper(column_name) = upper(cast('age' as varchar(4096)))", "test_params": {"column_anomalies": ["zero_count", "max"], "anomaly_sensitivity": 1, "column_name": "age", "model": "{{ get_where_subquery(ref('test4_column_anomaly')) }}", "timestamp_column": "birth", "where_expression": null, "anomaly_direction": "both", "time_bucket": {"period": "day", "count": 1}, "days_back": 14, "backfill_days": 2, "seasonality": null, "freshness_column": null, "event_timestamp_column": null, "dimensions": null, "ignore_small_changes": {"spike_failure_percent_threshold": null, "drop_failure_percent_threshold": null}, "fail_on_zero": false, "detection_delay": {"period": "hour", "count": 0}, "anomaly_exclude_metrics": null, "exclude_final_results": "1 = 1"}, "test_created_at": null, "description": "Column-level anomaly monitors (null_count, null_percent, zero_count, string_length, variance, etc.) on the column according to its data type.", "result": {"result_description": "In column age, the last zero_count value is 1.000. The average for this metric is 21.833.", "result_query": "select * from (None) results\n      where\n        anomaly_score is not null and\n        upper(full_table_name) = upper(cast('DEMO2_0821.PUBLIC.TEST4_COLUMN_ANOMALY' as varchar(4096))) and\n        metric_name = cast('zero_count' as varchar(4096))\n          and upper(column_name) = upper(cast('age' as varchar(4096)))"}, "configuration": {"test_name": "column_anomalies", "timestamp_column": "birth", "testing_timeframe": "1 day", "anomaly_threshold": 1}, "test_tags": ["column_test", "elementary-tests"], "normalized_full_path": "elementary_tutorial/models/schema.yml"}, "test_runs": {"fail_rate": 0.0, "totals": {"errors": 0, "warnings": 2, "passed": 0, "failures": 0}, "invocations": [{"affected_rows": null, "time_utc": "2024-08-21T08:59:14+00:00", "id": "fca13d3e-a6c8-41d8-a3bf-223f31f769e9", "status": "warn", "execution_time": null}, {"affected_rows": null, "time_utc": "2024-08-21T09:06:10+00:00", "id": "53eb2540-e1b2-47de-9b7d-2ab627db3fc9", "status": "warn", "execution_time": null}], "description": "There were no failures, no errors and 2 warnings on the last 2 test runs."}, "median_exec_time": 0.0, "last_exec_time": null}], "model.elementary_tutorial.orders": [{"metadata": {"test_unique_id": "test.elementary_tutorial.elementary_dimension_anomalies_orders_status.a5036d4371", "elementary_unique_id": "test.elementary_tutorial.elementary_dimension_anomalies_orders_status.a5036d4371", "database_name": "demo2_0821", "schema_name": "public", "table_name": "orders", "column_name": null, "test_name": "dimension_anomalies", "test_display_name": "Dimension Anomalies", "original_path": "models/schema.yml", "latest_run_time": "2024-08-21T17:06:12+08:00", "latest_run_time_utc": "2024-08-21T09:06:12+00:00", "latest_run_status": "pass", "model_unique_id": "model.elementary_tutorial.orders", "table_unique_id": "demo2_0821.public.orders", "test_type": "anomaly_detection", "test_sub_type": "generic", "test_query": "select * from (with anomaly_scores as (\n        select\n            id,\n            metric_id,\n            test_execution_id,\n            test_unique_id,\n            detected_at,\n            full_table_name,\n            column_name,\n            metric_name,\n            anomaly_score,\n            anomaly_score_threshold,\n            anomalous_value,\n            bucket_start,\n            bucket_end,\n            bucket_seasonality,\n            metric_value,\n            min_metric_value,\n            max_metric_value,\n            training_avg,\n            training_stddev,\n            training_set_size,\n            training_start,\n            training_end,\n            dimension,\n            dimension_value,\n            \n    case\n        when dimension is not null and column_name is null then \n    'The last ' || metric_name || ' value for dimension ' || dimension || ' - ' ||\n    case when dimension_value is null then 'NULL' else dimension_value end || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when dimension is not null and column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value for dimension ' || dimension || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when metric_name = 'freshness' then \n    'Last update was at ' || anomalous_value || ', ' || cast(abs(round(cast(metric_value/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours ago. Usually the table is updated within ' || cast(abs(round(cast(training_avg/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours.'\n\n        when column_name is null then \n    'The last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        else null\n    end as anomaly_description\n,\n            max(bucket_end) over (partition by test_execution_id) as max_bucket_end\n        from \"demo2_0821\".\"public\".\"test_a5036d4371_eleme__anomaly_scores__tmp_20240821090610676209\"\n      ),\n      anomaly_scores_with_is_anomalous as (\n        select\n          *,\ncase when\n          (\n            \n  (anomaly_score is not null and\n  (\n    \n  (\n    metric_value = 0 and \n    \n      1 = 2\n    \n  )\n or\n    (\n      case when metric_name IN \n        ( 'freshness' ,  'event_freshness'  )\n then\n            anomaly_score > 3\n    else\n        \n        abs(anomaly_score) > 3\n    \n\n     end and\n      (\n  \n  \n  \n  \n    \n        (1 = 1)\n    \n\n    and\n\n    \n        (1 = 1)\n    \n  \n  )\n    )\n  ))\n\n          )\n          and bucket_end >= \n    cast(max_bucket_end as timestamp) + cast('-2' as integer) * INTERVAL '1 day'\n\n          then TRUE else FALSE end as is_anomalous\n        from anomaly_scores\n      ),\n\n      final_results as (\n          select\n          metric_value as value,\n          training_avg as average,\n          \n          case\n          when is_anomalous = TRUE and 'both' = 'spike' then\n          lag(metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when is_anomalous = TRUE and 'both' != 'spike' then\n          lag(min_metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when 'both' = 'spike' then metric_value\n          else min_metric_value end as min_value,\n          case\n          when is_anomalous = TRUE and 'both' = 'drop' then\n          lag(metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when is_anomalous = TRUE and 'both' != 'drop' then\n          lag(max_metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when 'both' = 'drop' then metric_value\n          else max_metric_value end as max_value,\n          bucket_start as start_time,\n          bucket_end as end_time,\n          *\n        from anomaly_scores_with_is_anomalous\n        order by bucket_end, dimension_value\n      )\n\n      select * from final_results\n      where 1 = 1) results\n    where is_anomalous = true", "test_params": {"dimensions": ["status"], "model": "{{ get_where_subquery(ref('orders')) }}"}, "test_created_at": null, "description": "Monitors the frequency of values in the configured dimensions over time.", "result": {"result_description": null, "result_query": "select * from (with anomaly_scores as (\n        select\n            id,\n            metric_id,\n            test_execution_id,\n            test_unique_id,\n            detected_at,\n            full_table_name,\n            column_name,\n            metric_name,\n            anomaly_score,\n            anomaly_score_threshold,\n            anomalous_value,\n            bucket_start,\n            bucket_end,\n            bucket_seasonality,\n            metric_value,\n            min_metric_value,\n            max_metric_value,\n            training_avg,\n            training_stddev,\n            training_set_size,\n            training_start,\n            training_end,\n            dimension,\n            dimension_value,\n            \n    case\n        when dimension is not null and column_name is null then \n    'The last ' || metric_name || ' value for dimension ' || dimension || ' - ' ||\n    case when dimension_value is null then 'NULL' else dimension_value end || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when dimension is not null and column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value for dimension ' || dimension || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when metric_name = 'freshness' then \n    'Last update was at ' || anomalous_value || ', ' || cast(abs(round(cast(metric_value/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours ago. Usually the table is updated within ' || cast(abs(round(cast(training_avg/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours.'\n\n        when column_name is null then \n    'The last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        else null\n    end as anomaly_description\n,\n            max(bucket_end) over (partition by test_execution_id) as max_bucket_end\n        from \"demo2_0821\".\"public\".\"test_a5036d4371_eleme__anomaly_scores__tmp_20240821090610676209\"\n      ),\n      anomaly_scores_with_is_anomalous as (\n        select\n          *,\ncase when\n          (\n            \n  (anomaly_score is not null and\n  (\n    \n  (\n    metric_value = 0 and \n    \n      1 = 2\n    \n  )\n or\n    (\n      case when metric_name IN \n        ( 'freshness' ,  'event_freshness'  )\n then\n            anomaly_score > 3\n    else\n        \n        abs(anomaly_score) > 3\n    \n\n     end and\n      (\n  \n  \n  \n  \n    \n        (1 = 1)\n    \n\n    and\n\n    \n        (1 = 1)\n    \n  \n  )\n    )\n  ))\n\n          )\n          and bucket_end >= \n    cast(max_bucket_end as timestamp) + cast('-2' as integer) * INTERVAL '1 day'\n\n          then TRUE else FALSE end as is_anomalous\n        from anomaly_scores\n      ),\n\n      final_results as (\n          select\n          metric_value as value,\n          training_avg as average,\n          \n          case\n          when is_anomalous = TRUE and 'both' = 'spike' then\n          lag(metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when is_anomalous = TRUE and 'both' != 'spike' then\n          lag(min_metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when 'both' = 'spike' then metric_value\n          else min_metric_value end as min_value,\n          case\n          when is_anomalous = TRUE and 'both' = 'drop' then\n          lag(metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when is_anomalous = TRUE and 'both' != 'drop' then\n          lag(max_metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when 'both' = 'drop' then metric_value\n          else max_metric_value end as max_value,\n          bucket_start as start_time,\n          bucket_end as end_time,\n          *\n        from anomaly_scores_with_is_anomalous\n        order by bucket_end, dimension_value\n      )\n\n      select * from final_results\n      where 1 = 1) results\n    where is_anomalous = true"}, "configuration": {"test_name": "dimension_anomalies", "timestamp_column": null, "testing_timeframe": "1 day", "anomaly_threshold": null}, "test_tags": ["elementary-tests"], "normalized_full_path": "elementary_tutorial/models/schema.yml"}, "test_runs": {"fail_rate": 0.0, "totals": {"errors": 0, "warnings": 0, "passed": 3, "failures": 0}, "invocations": [{"affected_rows": null, "time_utc": "2024-08-21T08:55:06+00:00", "id": "d39e80c8-a6c5-4085-9bf0-81e5ceab5c05", "status": "pass", "execution_time": null}, {"affected_rows": null, "time_utc": "2024-08-21T08:59:16+00:00", "id": "fca13d3e-a6c8-41d8-a3bf-223f31f769e9", "status": "pass", "execution_time": null}, {"affected_rows": null, "time_utc": "2024-08-21T09:06:12+00:00", "id": "53eb2540-e1b2-47de-9b7d-2ab627db3fc9", "status": "pass", "execution_time": null}], "description": "There were no failures, no errors and no warnings on the last 3 test runs."}, "median_exec_time": 0.0, "last_exec_time": null}], "model.elementary_tutorial.returned_orders": [{"metadata": {"test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "elementary_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e.None.row_count", "database_name": "demo2_0821", "schema_name": "public", "table_name": "returned_orders", "column_name": null, "test_name": "volume_anomalies", "test_display_name": "Volume Anomalies", "original_path": "models/schema.yml", "latest_run_time": "2024-08-21T17:06:11+08:00", "latest_run_time_utc": "2024-08-21T09:06:11+00:00", "latest_run_status": "pass", "model_unique_id": "model.elementary_tutorial.returned_orders", "table_unique_id": "demo2_0821.public.returned_orders", "test_type": "anomaly_detection", "test_sub_type": "row_count", "test_query": "select * from (None) results\n      where\n        anomaly_score is not null and\n        upper(full_table_name) = upper(cast('DEMO2_0821.PUBLIC.RETURNED_ORDERS' as varchar(4096))) and\n        metric_name = cast('row_count' as varchar(4096))", "test_params": {"timestamp_column": "order_date", "model": "{{ get_where_subquery(ref('returned_orders')) }}", "where_expression": null, "anomaly_sensitivity": 3, "anomaly_direction": "both", "time_bucket": {"period": "day", "count": 1}, "days_back": 14, "backfill_days": 2, "seasonality": null, "freshness_column": null, "event_timestamp_column": null, "dimensions": null, "ignore_small_changes": {"spike_failure_percent_threshold": null, "drop_failure_percent_threshold": null}, "fail_on_zero": false, "detection_delay": {"period": "hour", "count": 0}, "anomaly_exclude_metrics": null, "exclude_final_results": "1 = 1"}, "test_created_at": null, "description": "Monitors the row count of your table over time.", "result": {"result_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "result_query": "select * from (None) results\n      where\n        anomaly_score is not null and\n        upper(full_table_name) = upper(cast('DEMO2_0821.PUBLIC.RETURNED_ORDERS' as varchar(4096))) and\n        metric_name = cast('row_count' as varchar(4096))"}, "configuration": {"test_name": "volume_anomalies", "timestamp_column": "order_date", "testing_timeframe": "1 day", "anomaly_threshold": 3}, "test_tags": ["elementary-tests", "table_anomalies"], "normalized_full_path": "elementary_tutorial/models/schema.yml"}, "test_runs": {"fail_rate": 0.0, "totals": {"errors": 0, "warnings": 0, "passed": 3, "failures": 0}, "invocations": [{"affected_rows": null, "time_utc": "2024-08-21T08:55:05+00:00", "id": "d39e80c8-a6c5-4085-9bf0-81e5ceab5c05", "status": "pass", "execution_time": null}, {"affected_rows": null, "time_utc": "2024-08-21T08:59:15+00:00", "id": "fca13d3e-a6c8-41d8-a3bf-223f31f769e9", "status": "pass", "execution_time": null}, {"affected_rows": null, "time_utc": "2024-08-21T09:06:11+00:00", "id": "53eb2540-e1b2-47de-9b7d-2ab627db3fc9", "status": "pass", "execution_time": null}], "description": "There were no failures, no errors and no warnings on the last 3 test runs."}, "median_exec_time": 0.0, "last_exec_time": null}]}, "test_runs_totals": {"test.elementary_tutorial.test4_dbt_test": {"errors": 0, "warnings": 0, "passed": 0, "failures": 3}, "model.elementary_tutorial.test4schema": {"errors": 0, "warnings": 1, "passed": 2, "failures": 0}, "model.elementary_tutorial.customers": {"errors": 0, "warnings": 0, "passed": 6, "failures": 0}, "model.elementary_tutorial.test4_volume_anomaly": {"errors": 0, "warnings": 0, "passed": 3, "failures": 0}, "model.elementary_tutorial.test_practice": {"errors": 0, "warnings": 0, "passed": 0, "failures": 3}, "model.elementary_tutorial.test4_column_anomaly": {"errors": 0, "warnings": 4, "passed": 2, "failures": 2}, "model.elementary_tutorial.orders": {"errors": 0, "warnings": 0, "passed": 3, "failures": 0}, "model.elementary_tutorial.returned_orders": {"errors": 0, "warnings": 0, "passed": 3, "failures": 0}}, "coverages": {"model.elementary_tutorial.customers": {"table_tests": 1, "column_tests": 1}, "model.elementary_tutorial.orders": {"table_tests": 1, "column_tests": 0}, "model.elementary_tutorial.returned_orders": {"table_tests": 1, "column_tests": 0}, "model.elementary_tutorial.test4_column_anomaly": {"table_tests": 0, "column_tests": 2}, "model.elementary_tutorial.test4schema": {"table_tests": 1, "column_tests": 0}, "model.elementary_tutorial.test4_volume_anomaly": {"table_tests": 1, "column_tests": 0}, "model.elementary_tutorial.test_practice": {"table_tests": 1, "column_tests": 0}}, "model_runs": [{"unique_id": "model.elementary_tutorial.stg_customers", "schema": "public", "name": "stg_customers", "status": "success", "last_exec_time": 0.1, "median_exec_time": 0.1, "compiled_code": "-- depends_on: \"demo2_0821\".\"public\".\"customers_validation\"\n\n\n    with source as (\n        select * from \"demo2_0821\".\"public\".\"customers_training\"\n    ),\n\n\nrenamed as (\n\n    select\n        id as customer_id,\n        first_name,\n        last_name\n\n    from source\n\n)\n\nselect * from renamed", "last_generated_at": "2024-08-21T09:05:48+00:00", "exec_time_change_rate": 0.0, "totals": {"errors": 0, "success": 3}, "runs": [{"id": "c88edba8-ce38-48ad-81d1-78f6bbf572ec", "time_utc": "2024-08-21T08:54:50+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.1}, {"id": "5c75dbb5-a734-4e3d-a98e-abb12a5188c5", "time_utc": "2024-08-21T08:59:04+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.3}, {"id": "982985e3-671d-4723-b4a6-a193ff42afa3", "time_utc": "2024-08-21T09:05:48+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.1}]}, {"unique_id": "model.elementary_tutorial.stg_orders", "schema": "public", "name": "stg_orders", "status": "success", "last_exec_time": 0.1, "median_exec_time": 0.1, "compiled_code": "-- depends_on: \"demo2_0821\".\"public\".\"orders_validation\"\n\n\n    with source as (\n        select * from \"demo2_0821\".\"public\".\"orders_training\"\n    ),\n\n\nrenamed as (\n\n    select\n        id as order_id,\n        user_id as customer_id,\n        order_date,\n        status\n\n    from source\n\n)\n\nselect * from renamed", "last_generated_at": "2024-08-21T09:05:48+00:00", "exec_time_change_rate": 0.0, "totals": {"errors": 0, "success": 3}, "runs": [{"id": "c88edba8-ce38-48ad-81d1-78f6bbf572ec", "time_utc": "2024-08-21T08:54:50+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.2}, {"id": "5c75dbb5-a734-4e3d-a98e-abb12a5188c5", "time_utc": "2024-08-21T08:59:04+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.1}, {"id": "982985e3-671d-4723-b4a6-a193ff42afa3", "time_utc": "2024-08-21T09:05:48+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.1}]}, {"unique_id": "model.elementary_tutorial.stg_payments", "schema": "public", "name": "stg_payments", "status": "success", "last_exec_time": 0.1, "median_exec_time": 0.1, "compiled_code": "-- depends_on: \"demo2_0821\".\"public\".\"payments_validation\"\n\n\n    with source as (\n        select * from \"demo2_0821\".\"public\".\"payments_training\"\n    ),\n\n\nrenamed as (\n\n    select\n        id as payment_id,\n        order_id,\n        payment_method,\n\n        -- `amount` is currently stored in cents, so we convert it to dollars\n        amount / 100 as amount\n\n    from source\n\n)\n\nselect * from renamed", "last_generated_at": "2024-08-21T09:05:48+00:00", "exec_time_change_rate": 0.0, "totals": {"errors": 0, "success": 3}, "runs": [{"id": "c88edba8-ce38-48ad-81d1-78f6bbf572ec", "time_utc": "2024-08-21T08:54:50+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.1}, {"id": "5c75dbb5-a734-4e3d-a98e-abb12a5188c5", "time_utc": "2024-08-21T08:59:04+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.1}, {"id": "982985e3-671d-4723-b4a6-a193ff42afa3", "time_utc": "2024-08-21T09:05:48+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.1}]}, {"unique_id": "model.elementary_tutorial.stg_signups", "schema": "public", "name": "stg_signups", "status": "success", "last_exec_time": 0.2, "median_exec_time": 0.1, "compiled_code": "-- depends_on: \"demo2_0821\".\"public\".\"signups_validation\"\n\n\n    with source as (\n        select * from \"demo2_0821\".\"public\".\"signups_training\"\n    ),\n\n\nrenamed as (\n\n    select\n        id as signup_id,\n        user_id as customer_id,\n        user_email as customer_email,\n        hashed_password,\n        signup_date\n\n    from source\n\n)\n\nselect * from renamed", "last_generated_at": "2024-08-21T09:05:48+00:00", "exec_time_change_rate": 100.0, "totals": {"errors": 0, "success": 3}, "runs": [{"id": "c88edba8-ce38-48ad-81d1-78f6bbf572ec", "time_utc": "2024-08-21T08:54:50+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.1}, {"id": "5c75dbb5-a734-4e3d-a98e-abb12a5188c5", "time_utc": "2024-08-21T08:59:04+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.1}, {"id": "982985e3-671d-4723-b4a6-a193ff42afa3", "time_utc": "2024-08-21T09:05:48+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.2}]}, {"unique_id": "model.elementary_tutorial.test_practice", "schema": "public", "name": "test_practice", "status": "success", "last_exec_time": 0.1, "median_exec_time": 0.1, "compiled_code": "-- depends_on: \"demo2_0821\".\"public\".\"customers_validation\"\n\nwith source as (\n    select * from \"demo2_0821\".\"public\".\"test_training\"\n),\n\nrenamed as (\n    select\n    *\n    from source\n)\n\nselect * from renamed", "last_generated_at": "2024-08-21T09:05:48+00:00", "exec_time_change_rate": 0.0, "totals": {"errors": 0, "success": 3}, "runs": [{"id": "c88edba8-ce38-48ad-81d1-78f6bbf572ec", "time_utc": "2024-08-21T08:54:50+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.1}, {"id": "5c75dbb5-a734-4e3d-a98e-abb12a5188c5", "time_utc": "2024-08-21T08:59:04+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.1}, {"id": "982985e3-671d-4723-b4a6-a193ff42afa3", "time_utc": "2024-08-21T09:05:48+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.1}]}, {"unique_id": "model.elementary_tutorial.test_volume", "schema": "public", "name": "test_volume", "status": "success", "last_exec_time": 0.1, "median_exec_time": 0.1, "compiled_code": "-- depends_on: \"demo2_0821\".\"public\".\"test_dataset\"\n\nwith source as (\n    select * from \"demo2_0821\".\"public\".\"test_dataset\"\n),\n\nrenamed as (\n    select\n    *\n    from source\n)\n\nselect * from renamed", "last_generated_at": "2024-08-21T09:05:48+00:00", "exec_time_change_rate": 0.0, "totals": {"errors": 0, "success": 3}, "runs": [{"id": "c88edba8-ce38-48ad-81d1-78f6bbf572ec", "time_utc": "2024-08-21T08:54:50+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.1}, {"id": "5c75dbb5-a734-4e3d-a98e-abb12a5188c5", "time_utc": "2024-08-21T08:59:04+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.1}, {"id": "982985e3-671d-4723-b4a6-a193ff42afa3", "time_utc": "2024-08-21T09:05:48+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.1}]}, {"unique_id": "model.elementary_tutorial.orders", "schema": "public", "name": "orders", "status": "success", "last_exec_time": 0.1, "median_exec_time": 0.1, "compiled_code": "\n\nwith orders as (\n\n    select * from \"demo2_0821\".\"public\".\"stg_orders\"\n\n),\n\npayments as (\n\n    select * from \"demo2_0821\".\"public\".\"stg_payments\"\n\n),\n\norder_payments as (\n\n    select\n        order_id,\n\n        sum(case when payment_method = 'credit_card' then amount else 0 end) as credit_card_amount,\n        sum(case when payment_method = 'coupon' then amount else 0 end) as coupon_amount,\n        sum(case when payment_method = 'bank_transfer' then amount else 0 end) as bank_transfer_amount,\n        sum(case when payment_method = 'gift_card' then amount else 0 end) as gift_card_amount,\n        sum(amount) as total_amount\n\n    from payments\n\n    group by order_id\n\n),\n\nfinal as (\n\n    select\n        orders.order_id,\n        orders.customer_id,\n        orders.order_date,\n        orders.status,\n\n        order_payments.credit_card_amount,\n\n        order_payments.coupon_amount,\n\n        order_payments.bank_transfer_amount,\n\n        order_payments.gift_card_amount,\n\n        order_payments.total_amount as amount\n\n    from orders\n\n\n    left join order_payments\n        on orders.order_id = order_payments.order_id\n\n)\n\nselect * from final", "last_generated_at": "2024-08-21T09:05:48+00:00", "exec_time_change_rate": 0.0, "totals": {"errors": 0, "success": 3}, "runs": [{"id": "c88edba8-ce38-48ad-81d1-78f6bbf572ec", "time_utc": "2024-08-21T08:54:50+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.1}, {"id": "5c75dbb5-a734-4e3d-a98e-abb12a5188c5", "time_utc": "2024-08-21T08:59:04+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.1}, {"id": "982985e3-671d-4723-b4a6-a193ff42afa3", "time_utc": "2024-08-21T09:05:48+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.1}]}, {"unique_id": "model.elementary_tutorial.customers", "schema": "public", "name": "customers", "status": "success", "last_exec_time": 0.1, "median_exec_time": 0.1, "compiled_code": "with customers as (\n\n    select * from \"demo2_0821\".\"public\".\"stg_customers\"\n\n),\n\norders as (\n\n    select * from \"demo2_0821\".\"public\".\"stg_orders\"\n\n),\n\npayments as (\n\n    select * from \"demo2_0821\".\"public\".\"stg_payments\"\n\n),\n\nsignups as (\n\n    select * from \"demo2_0821\".\"public\".\"stg_signups\"\n),\n\ncustomer_orders as (\n\n        select\n        customer_id,\n\n        min(order_date) as first_order,\n        max(order_date) as most_recent_order,\n        count(order_id) as number_of_orders\n    from orders\n\n    group by customer_id\n\n),\n\ncustomer_payments as (\n\n    select\n        orders.customer_id,\n        sum(amount) as total_amount\n\n    from payments\n\n    left join orders on\n         payments.order_id = orders.order_id\n\n    group by orders.customer_id\n\n),\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order,\n        customer_orders.most_recent_order,\n        case\n            when customer_orders.number_of_orders is null then 0\n            else customer_orders.number_of_orders\n        end as number_of_orders,\n        customer_payments.total_amount as customer_lifetime_value,\n        signups.customer_email,\n        \n        signups.signup_date\n\n    from customers\n\n    left join customer_orders\n        on customers.customer_id = customer_orders.customer_id\n\n    left join customer_payments\n        on  customers.customer_id = customer_payments.customer_id\n\n    left join signups\n        on customers.customer_id = signups.customer_id\n\n)\n\nselect * from final", "last_generated_at": "2024-08-21T09:05:48+00:00", "exec_time_change_rate": 0.0, "totals": {"errors": 0, "success": 3}, "runs": [{"id": "c88edba8-ce38-48ad-81d1-78f6bbf572ec", "time_utc": "2024-08-21T08:54:50+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.2}, {"id": "5c75dbb5-a734-4e3d-a98e-abb12a5188c5", "time_utc": "2024-08-21T08:59:04+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.1}, {"id": "982985e3-671d-4723-b4a6-a193ff42afa3", "time_utc": "2024-08-21T09:05:48+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.1}]}, {"unique_id": "model.elementary_tutorial.test4_column_anomaly", "schema": "public", "name": "test4_column_anomaly", "status": "success", "last_exec_time": 0.1, "median_exec_time": 0.1, "compiled_code": "with orders as (\n\n    select * from \"demo2_0821\".\"public\".\"test_practice\"\n\n),\n\nfinal as (\n\n    select\n    *\n    from orders\n)\n\nselect * from final", "last_generated_at": "2024-08-21T09:05:48+00:00", "exec_time_change_rate": 0.0, "totals": {"errors": 0, "success": 3}, "runs": [{"id": "c88edba8-ce38-48ad-81d1-78f6bbf572ec", "time_utc": "2024-08-21T08:54:50+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.1}, {"id": "5c75dbb5-a734-4e3d-a98e-abb12a5188c5", "time_utc": "2024-08-21T08:59:04+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.1}, {"id": "982985e3-671d-4723-b4a6-a193ff42afa3", "time_utc": "2024-08-21T09:05:48+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.1}]}, {"unique_id": "model.elementary_tutorial.test4_volume_anomaly", "schema": "public", "name": "test4_volume_anomaly", "status": "success", "last_exec_time": 0.1, "median_exec_time": 0.1, "compiled_code": "with orders as (\n\n    select * from \"demo2_0821\".\"public\".\"test_volume\"\n\n),\n\nfinal as (\n\n    select\n    *\n    from orders\n)\n\nselect * from final", "last_generated_at": "2024-08-21T09:05:48+00:00", "exec_time_change_rate": 0.0, "totals": {"errors": 0, "success": 3}, "runs": [{"id": "c88edba8-ce38-48ad-81d1-78f6bbf572ec", "time_utc": "2024-08-21T08:54:50+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.1}, {"id": "5c75dbb5-a734-4e3d-a98e-abb12a5188c5", "time_utc": "2024-08-21T08:59:04+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.1}, {"id": "982985e3-671d-4723-b4a6-a193ff42afa3", "time_utc": "2024-08-21T09:05:48+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.1}]}, {"unique_id": "model.elementary_tutorial.returned_orders", "schema": "public", "name": "returned_orders", "status": "success", "last_exec_time": 0.1, "median_exec_time": 0.1, "compiled_code": "\n\nwith orders as (\n    select *\n    from \"demo2_0821\".\"public\".\"orders\"\n)\n\nselect *\nfrom orders\nwhere status = 'return_pending' or status = 'returned'", "last_generated_at": "2024-08-21T09:05:48+00:00", "exec_time_change_rate": 0.0, "totals": {"errors": 0, "success": 3}, "runs": [{"id": "c88edba8-ce38-48ad-81d1-78f6bbf572ec", "time_utc": "2024-08-21T08:54:50+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.1}, {"id": "5c75dbb5-a734-4e3d-a98e-abb12a5188c5", "time_utc": "2024-08-21T08:59:04+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.1}, {"id": "982985e3-671d-4723-b4a6-a193ff42afa3", "time_utc": "2024-08-21T09:05:48+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.1}]}, {"unique_id": "model.elementary_tutorial.test4schema", "schema": "public", "name": "test4schema", "status": "success", "last_exec_time": 0.1, "median_exec_time": 0.1, "compiled_code": "with orders as (\n\n    select * from \"demo2_0821\".\"public\".\"test4_column_anomaly\"\n\n),\n\nfinal as (\n\n    select\n    age\n    from orders\n)\n\nselect * from final", "last_generated_at": "2024-08-21T09:05:48+00:00", "exec_time_change_rate": 0.0, "totals": {"errors": 0, "success": 3}, "runs": [{"id": "c88edba8-ce38-48ad-81d1-78f6bbf572ec", "time_utc": "2024-08-21T08:54:50+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.1}, {"id": "5c75dbb5-a734-4e3d-a98e-abb12a5188c5", "time_utc": "2024-08-21T08:59:04+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.1}, {"id": "982985e3-671d-4723-b4a6-a193ff42afa3", "time_utc": "2024-08-21T09:05:48+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.1}]}], "model_runs_totals": {"model.elementary_tutorial.stg_customers": {"errors": 0, "warnings": 0, "passed": 3, "failures": 0}, "model.elementary_tutorial.stg_orders": {"errors": 0, "warnings": 0, "passed": 3, "failures": 0}, "model.elementary_tutorial.stg_payments": {"errors": 0, "warnings": 0, "passed": 3, "failures": 0}, "model.elementary_tutorial.stg_signups": {"errors": 0, "warnings": 0, "passed": 3, "failures": 0}, "model.elementary_tutorial.test_practice": {"errors": 0, "warnings": 0, "passed": 3, "failures": 0}, "model.elementary_tutorial.test_volume": {"errors": 0, "warnings": 0, "passed": 3, "failures": 0}, "model.elementary_tutorial.orders": {"errors": 0, "warnings": 0, "passed": 3, "failures": 0}, "model.elementary_tutorial.customers": {"errors": 0, "warnings": 0, "passed": 3, "failures": 0}, "model.elementary_tutorial.test4_column_anomaly": {"errors": 0, "warnings": 0, "passed": 3, "failures": 0}, "model.elementary_tutorial.test4_volume_anomaly": {"errors": 0, "warnings": 0, "passed": 3, "failures": 0}, "model.elementary_tutorial.returned_orders": {"errors": 0, "warnings": 0, "passed": 3, "failures": 0}, "model.elementary_tutorial.test4schema": {"errors": 0, "warnings": 0, "passed": 3, "failures": 0}}, "filters": {"test_results": [{"name": "failures", "display_name": "Failures", "model_unique_ids": ["test.elementary_tutorial.test4_dbt_test", "model.elementary_tutorial.test_practice", "model.elementary_tutorial.test4_column_anomaly"]}, {"name": "warnings", "display_name": "Warnings", "model_unique_ids": ["model.elementary_tutorial.test4_column_anomaly"]}, {"name": "passed", "display_name": "Passed", "model_unique_ids": ["model.elementary_tutorial.orders", "model.elementary_tutorial.test4schema", "model.elementary_tutorial.customers", "model.elementary_tutorial.test4_column_anomaly", "model.elementary_tutorial.test4_volume_anomaly", "model.elementary_tutorial.returned_orders"]}, {"name": "no_test", "display_name": "No Tests", "model_unique_ids": ["model.elementary_tutorial.stg_orders", "model.elementary_tutorial.stg_signups", "model.elementary_tutorial.stg_payments", "model.elementary_tutorial.test_volume", "model.elementary_tutorial.stg_customers"]}], "test_runs": [{"name": "failures", "display_name": "Failures", "model_unique_ids": ["test.elementary_tutorial.test4_dbt_test", "model.elementary_tutorial.test_practice", "model.elementary_tutorial.test4_column_anomaly"]}, {"name": "warnings", "display_name": "Warnings", "model_unique_ids": ["model.elementary_tutorial.test4schema", "model.elementary_tutorial.test4_column_anomaly"]}, {"name": "passed", "display_name": "Passed", "model_unique_ids": ["model.elementary_tutorial.orders", "model.elementary_tutorial.test4schema", "model.elementary_tutorial.customers", "model.elementary_tutorial.test4_column_anomaly", "model.elementary_tutorial.test4_volume_anomaly", "model.elementary_tutorial.returned_orders"]}, {"name": "no_test", "display_name": "No Tests", "model_unique_ids": ["model.elementary_tutorial.stg_orders", "model.elementary_tutorial.stg_signups", "model.elementary_tutorial.stg_payments", "model.elementary_tutorial.test_volume", "model.elementary_tutorial.stg_customers"]}], "model_runs": [{"name": "success", "display_name": "Successful Runs", "model_unique_ids": ["model.elementary_tutorial.stg_orders", "model.elementary_tutorial.stg_signups", "model.elementary_tutorial.test4schema", "model.elementary_tutorial.stg_payments", "model.elementary_tutorial.test_volume", "model.elementary_tutorial.customers", "model.elementary_tutorial.stg_customers", "model.elementary_tutorial.test4_volume_anomaly", "model.elementary_tutorial.test_practice", "model.elementary_tutorial.test4_column_anomaly", "model.elementary_tutorial.orders", "model.elementary_tutorial.returned_orders"]}]}, "lineage": {"nodes": [{"id": "model.elementary_tutorial.returned_orders", "type": "model", "sub_type": "view"}, {"id": "model.elementary_tutorial.test4_volume_anomaly", "type": "model", "sub_type": "view"}, {"id": "model.elementary_tutorial.customers", "type": "model", "sub_type": "view"}, {"id": "model.elementary_tutorial.orders", "type": "model", "sub_type": "view"}, {"id": "model.elementary_tutorial.test4_column_anomaly", "type": "model", "sub_type": "view"}, {"id": "model.elementary_tutorial.stg_customers", "type": "model", "sub_type": "view"}, {"id": "model.elementary_tutorial.test_practice", "type": "model", "sub_type": "view"}, {"id": "model.elementary_tutorial.stg_payments", "type": "model", "sub_type": "view"}, {"id": "model.elementary_tutorial.stg_orders", "type": "model", "sub_type": "view"}, {"id": "model.elementary_tutorial.stg_signups", "type": "model", "sub_type": "view"}, {"id": "model.elementary_tutorial.test_volume", "type": "model", "sub_type": "view"}, {"id": "model.elementary_tutorial.test4schema", "type": "model", "sub_type": "view"}], "edges": [["model.elementary_tutorial.returned_orders", "model.elementary_tutorial.orders"], ["model.elementary_tutorial.orders", "model.elementary_tutorial.stg_orders"], ["model.elementary_tutorial.orders", "model.elementary_tutorial.stg_payments"], ["model.elementary_tutorial.test4_volume_anomaly", "model.elementary_tutorial.test_volume"], ["model.elementary_tutorial.customers", "model.elementary_tutorial.stg_customers"], ["model.elementary_tutorial.customers", "model.elementary_tutorial.stg_orders"], ["model.elementary_tutorial.customers", "model.elementary_tutorial.stg_payments"], ["model.elementary_tutorial.customers", "model.elementary_tutorial.stg_signups"], ["model.elementary_tutorial.test4_column_anomaly", "model.elementary_tutorial.test_practice"], ["model.elementary_tutorial.test4schema", "model.elementary_tutorial.test4_column_anomaly"]]}, "invocations": [{"invocation_id": "982985e3-671d-4723-b4a6-a193ff42afa3", "detected_at": null, "command": "run", "selected": "", "full_refresh": false, "job_url": null, "job_name": null, "job_id": null, "orchestrator": null}], "resources_latest_invocation": {"model.elementary.alerts_anomaly_detection": "982985e3-671d-4723-b4a6-a193ff42afa3", "model.elementary.alerts_dbt_models": "982985e3-671d-4723-b4a6-a193ff42afa3", "model.elementary.alerts_dbt_source_freshness": "982985e3-671d-4723-b4a6-a193ff42afa3", "model.elementary.alerts_dbt_tests": "982985e3-671d-4723-b4a6-a193ff42afa3", "model.elementary.alerts_schema_changes": "982985e3-671d-4723-b4a6-a193ff42afa3", "model.elementary.anomaly_threshold_sensitivity": "982985e3-671d-4723-b4a6-a193ff42afa3", "model.elementary.data_monitoring_metrics": "982985e3-671d-4723-b4a6-a193ff42afa3", "model.elementary.dbt_artifacts_hashes": "982985e3-671d-4723-b4a6-a193ff42afa3", "model.elementary.dbt_columns": "982985e3-671d-4723-b4a6-a193ff42afa3", "model.elementary.dbt_exposures": "982985e3-671d-4723-b4a6-a193ff42afa3", "model.elementary.dbt_invocations": "982985e3-671d-4723-b4a6-a193ff42afa3", "model.elementary.dbt_metrics": "982985e3-671d-4723-b4a6-a193ff42afa3", "model.elementary.dbt_models": "982985e3-671d-4723-b4a6-a193ff42afa3", "model.elementary.dbt_run_results": "982985e3-671d-4723-b4a6-a193ff42afa3", "model.elementary.dbt_seeds": "982985e3-671d-4723-b4a6-a193ff42afa3", "model.elementary.dbt_snapshots": "982985e3-671d-4723-b4a6-a193ff42afa3", "model.elementary.dbt_source_freshness_results": "982985e3-671d-4723-b4a6-a193ff42afa3", "model.elementary.dbt_sources": "982985e3-671d-4723-b4a6-a193ff42afa3", "model.elementary.dbt_tests": "982985e3-671d-4723-b4a6-a193ff42afa3", "model.elementary.elementary_test_results": "982985e3-671d-4723-b4a6-a193ff42afa3", "model.elementary.job_run_results": "982985e3-671d-4723-b4a6-a193ff42afa3", "model.elementary.metadata": "982985e3-671d-4723-b4a6-a193ff42afa3", "model.elementary.metrics_anomaly_score": "982985e3-671d-4723-b4a6-a193ff42afa3", "model.elementary.model_run_results": "982985e3-671d-4723-b4a6-a193ff42afa3", "model.elementary.monitors_runs": "982985e3-671d-4723-b4a6-a193ff42afa3", "model.elementary.schema_columns_snapshot": "982985e3-671d-4723-b4a6-a193ff42afa3", "model.elementary.snapshot_run_results": "982985e3-671d-4723-b4a6-a193ff42afa3", "model.elementary.test_result_rows": "982985e3-671d-4723-b4a6-a193ff42afa3", "model.elementary_tutorial.customers": "982985e3-671d-4723-b4a6-a193ff42afa3", "model.elementary_tutorial.orders": "982985e3-671d-4723-b4a6-a193ff42afa3", "model.elementary_tutorial.returned_orders": "982985e3-671d-4723-b4a6-a193ff42afa3", "model.elementary_tutorial.stg_customers": "982985e3-671d-4723-b4a6-a193ff42afa3", "model.elementary_tutorial.stg_orders": "982985e3-671d-4723-b4a6-a193ff42afa3", "model.elementary_tutorial.stg_payments": "982985e3-671d-4723-b4a6-a193ff42afa3", "model.elementary_tutorial.stg_signups": "982985e3-671d-4723-b4a6-a193ff42afa3", "model.elementary_tutorial.test4_column_anomaly": "982985e3-671d-4723-b4a6-a193ff42afa3", "model.elementary_tutorial.test4schema": "982985e3-671d-4723-b4a6-a193ff42afa3", "model.elementary_tutorial.test4_volume_anomaly": "982985e3-671d-4723-b4a6-a193ff42afa3", "model.elementary_tutorial.test_practice": "982985e3-671d-4723-b4a6-a193ff42afa3", "model.elementary_tutorial.test_volume": "982985e3-671d-4723-b4a6-a193ff42afa3"}, "invocations_job_identification": {}, "env": {"project_name": "elementary_tutorial", "env": "dev", "warehouse_type": "postgres"}, "tracking": {"posthog_api_key": "phc_56XBEzZmh02mGkadqLiYW51eECyYKWPyecVwkGdGUfg", "report_generator_anonymous_user_id": "47e68f9f-108e-4fe3-88cb-b43b9e5726c8", "anonymous_warehouse_id": "49960de5880e8c687434170f6476605b8fe4aeb9a28632c7995cf3ba831d9763"}}