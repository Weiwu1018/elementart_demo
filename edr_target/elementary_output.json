{"creation_time": "2024-08-19T01:29:44+00:00", "days_back": 7, "models": {"model.elementary_tutorial.returned_orders": {"name": "returned_orders", "unique_id": "model.elementary_tutorial.returned_orders", "owners": [], "tags": ["finance"], "package_name": "elementary_tutorial", "description": "This table contains all of the returned orders", "full_path": "models/returned_orders.sql", "meta": {}, "materialization": "view", "database_name": "elementary_demo", "schema_name": "public", "table_name": "returned_orders", "patch_path": "elementary_tutorial://models/schema.yml", "model_name": "returned_orders", "normalized_full_path": "elementary_tutorial/models/returned_orders.sql", "fqn": "elementary_demo.public.returned_orders", "artifact_type": "model"}, "model.elementary_tutorial.test4_volume_anomaly": {"name": "test4_volume_anomaly", "unique_id": "model.elementary_tutorial.test4_volume_anomaly", "owners": [], "tags": ["PII"], "package_name": "elementary_tutorial", "description": "This table has basic information about a customer", "full_path": "models/test4_volume_anomaly.sql", "meta": {}, "materialization": "view", "database_name": "elementary_demo", "schema_name": "public", "table_name": "test4_volume_anomaly", "patch_path": "elementary_tutorial://models/schema.yml", "model_name": "test4_volume_anomaly", "normalized_full_path": "elementary_tutorial/models/test4_volume_anomaly.sql", "fqn": "elementary_demo.public.test4_volume_anomaly", "artifact_type": "model"}, "model.elementary_tutorial.customers": {"name": "customers", "unique_id": "model.elementary_tutorial.customers", "owners": [], "tags": ["PII"], "package_name": "elementary_tutorial", "description": "This table has basic information about a customer, as well as some derived facts based on a customer's orders", "full_path": "models/customers.sql", "meta": {}, "materialization": "view", "database_name": "elementary_demo", "schema_name": "public", "table_name": "customers", "patch_path": "elementary_tutorial://models/schema.yml", "model_name": "customers", "normalized_full_path": "elementary_tutorial/models/customers.sql", "fqn": "elementary_demo.public.customers", "artifact_type": "model"}, "model.elementary_tutorial.orders": {"name": "orders", "unique_id": "model.elementary_tutorial.orders", "owners": [], "tags": ["finance"], "package_name": "elementary_tutorial", "description": "This table has basic information about orders, as well as some derived facts based on payments", "full_path": "models/orders.sql", "meta": {}, "materialization": "view", "database_name": "elementary_demo", "schema_name": "public", "table_name": "orders", "patch_path": "elementary_tutorial://models/schema.yml", "model_name": "orders", "normalized_full_path": "elementary_tutorial/models/orders.sql", "fqn": "elementary_demo.public.orders", "artifact_type": "model"}, "model.elementary_tutorial.test4_column_anomaly": {"name": "test4_column_anomaly", "unique_id": "model.elementary_tutorial.test4_column_anomaly", "owners": [], "tags": ["PII"], "package_name": "elementary_tutorial", "description": "This table has basic information about a customer, as well as some derived facts based on a customer's orders", "full_path": "models/test4_column_anomaly.sql", "meta": {}, "materialization": "view", "database_name": "elementary_demo", "schema_name": "public", "table_name": "test4_column_anomaly", "patch_path": "elementary_tutorial://models/schema.yml", "model_name": "test4_column_anomaly", "normalized_full_path": "elementary_tutorial/models/test4_column_anomaly.sql", "fqn": "elementary_demo.public.test4_column_anomaly", "artifact_type": "model"}, "model.elementary_tutorial.stg_customers": {"name": "stg_customers", "unique_id": "model.elementary_tutorial.stg_customers", "owners": [], "tags": [], "package_name": "elementary_tutorial", "description": "", "full_path": "models/staging/stg_customers.sql", "meta": {}, "materialization": "view", "database_name": "elementary_demo", "schema_name": "public", "table_name": "stg_customers", "patch_path": null, "model_name": "stg_customers", "normalized_full_path": "elementary_tutorial/models/staging/stg_customers.sql", "fqn": "elementary_demo.public.stg_customers", "artifact_type": "model"}, "model.elementary_tutorial.test_practice": {"name": "test_practice", "unique_id": "model.elementary_tutorial.test_practice", "owners": [], "tags": [], "package_name": "elementary_tutorial", "description": "", "full_path": "models/staging/test_practice.sql", "meta": {}, "materialization": "view", "database_name": "elementary_demo", "schema_name": "public", "table_name": "test_practice", "patch_path": null, "model_name": "test_practice", "normalized_full_path": "elementary_tutorial/models/staging/test_practice.sql", "fqn": "elementary_demo.public.test_practice", "artifact_type": "model"}, "model.elementary_tutorial.stg_payments": {"name": "stg_payments", "unique_id": "model.elementary_tutorial.stg_payments", "owners": [], "tags": [], "package_name": "elementary_tutorial", "description": "", "full_path": "models/staging/stg_payments.sql", "meta": {}, "materialization": "view", "database_name": "elementary_demo", "schema_name": "public", "table_name": "stg_payments", "patch_path": null, "model_name": "stg_payments", "normalized_full_path": "elementary_tutorial/models/staging/stg_payments.sql", "fqn": "elementary_demo.public.stg_payments", "artifact_type": "model"}, "model.elementary_tutorial.stg_orders": {"name": "stg_orders", "unique_id": "model.elementary_tutorial.stg_orders", "owners": [], "tags": [], "package_name": "elementary_tutorial", "description": "", "full_path": "models/staging/stg_orders.sql", "meta": {}, "materialization": "view", "database_name": "elementary_demo", "schema_name": "public", "table_name": "stg_orders", "patch_path": null, "model_name": "stg_orders", "normalized_full_path": "elementary_tutorial/models/staging/stg_orders.sql", "fqn": "elementary_demo.public.stg_orders", "artifact_type": "model"}, "model.elementary_tutorial.stg_signups": {"name": "stg_signups", "unique_id": "model.elementary_tutorial.stg_signups", "owners": [], "tags": [], "package_name": "elementary_tutorial", "description": "", "full_path": "models/staging/stg_signups.sql", "meta": {}, "materialization": "view", "database_name": "elementary_demo", "schema_name": "public", "table_name": "stg_signups", "patch_path": null, "model_name": "stg_signups", "normalized_full_path": "elementary_tutorial/models/staging/stg_signups.sql", "fqn": "elementary_demo.public.stg_signups", "artifact_type": "model"}, "model.elementary_tutorial.test_volume": {"name": "test_volume", "unique_id": "model.elementary_tutorial.test_volume", "owners": [], "tags": [], "package_name": "elementary_tutorial", "description": "", "full_path": "models/staging/test_volume.sql", "meta": {}, "materialization": "view", "database_name": "elementary_demo", "schema_name": "public", "table_name": "test_volume", "patch_path": null, "model_name": "test_volume", "normalized_full_path": "elementary_tutorial/models/staging/test_volume.sql", "fqn": "elementary_demo.public.test_volume", "artifact_type": "model"}, "model.elementary_tutorial.test4schema": {"name": "test4schema", "unique_id": "model.elementary_tutorial.test4schema", "owners": [], "tags": ["PII"], "package_name": "elementary_tutorial", "description": "This table has basic information about a customer, as well as some derived facts based on a customer's orders", "full_path": "models/test4schema.sql", "meta": {}, "materialization": "view", "database_name": "elementary_demo", "schema_name": "public", "table_name": "test4schema", "patch_path": "elementary_tutorial://models/schema.yml", "model_name": "test4schema", "normalized_full_path": "elementary_tutorial/models/test4schema.sql", "fqn": "elementary_demo.public.test4schema", "artifact_type": "model"}}, "groups": {"dbt": {"elementary_tutorial": {"models": {"__files__": [{"node_id": "model.elementary_tutorial.returned_orders", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.test4_volume_anomaly", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.customers", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.orders", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.test4_column_anomaly", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.test4schema", "resource_type": "model"}], "staging": {"__files__": [{"node_id": "model.elementary_tutorial.stg_customers", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.test_practice", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.stg_payments", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.stg_orders", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.stg_signups", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.test_volume", "resource_type": "model"}]}}, "tests": {"__files__": [{"node_id": "test.elementary_tutorial.test4_dbt_test", "resource_type": "test"}]}}}, "tags": {"finance": [{"node_id": "model.elementary_tutorial.returned_orders", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.orders", "resource_type": "model"}], "PII": [{"node_id": "model.elementary_tutorial.test4_volume_anomaly", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.customers", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.test4_column_anomaly", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.test4schema", "resource_type": "model"}], "No tags": [{"node_id": "model.elementary_tutorial.stg_customers", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.test_practice", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.stg_payments", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.stg_orders", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.stg_signups", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.test_volume", "resource_type": "model"}, {"node_id": "test.elementary_tutorial.test4_dbt_test", "resource_type": "test"}]}, "owners": {"No owners": [{"node_id": "model.elementary_tutorial.returned_orders", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.test4_volume_anomaly", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.customers", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.orders", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.test4_column_anomaly", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.stg_customers", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.test_practice", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.stg_payments", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.stg_orders", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.stg_signups", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.test_volume", "resource_type": "model"}, {"node_id": "model.elementary_tutorial.test4schema", "resource_type": "model"}, {"node_id": "test.elementary_tutorial.test4_dbt_test", "resource_type": "test"}]}}, "invocation": {"invocation_id": null, "detected_at": null, "command": null, "selected": null, "full_refresh": null, "job_url": null, "job_name": null, "job_id": null, "orchestrator": null}, "test_results": {"model.elementary_tutorial.test_practice": [{"metadata": {"test_unique_id": "test.elementary_tutorial.test4_dbt_test", "elementary_unique_id": "test.elementary_tutorial.test4_dbt_test.None.singular", "database_name": "elementary_demo", "schema_name": "public", "table_name": "test_practice", "column_name": null, "test_name": "test4_dbt_test", "test_display_name": "Test4 Dbt Test", "original_path": "tests/test4_dbt_test.sql", "latest_run_time": "2024-08-19T09:28:26+08:00", "latest_run_time_utc": "2024-08-19T01:28:26+00:00", "latest_run_status": "fail", "model_unique_id": "model.elementary_tutorial.test_practice", "table_unique_id": "elementary_demo.public.test_practice", "test_type": "dbt_test", "test_sub_type": "singular", "test_query": "-- tests/check_record_count.sql\n\nwith actual_count as (\n    select\n        count(*) as actual_count\n    from \"elementary_demo\".\"public\".\"test_practice\"\n),\nexpected_count as (\n    select 300 as expected_count\n)\n\nselect\n    actual_count,\n    expected_count\nfrom actual_count, expected_count\nwhere actual_count != expected_count", "test_params": {}, "test_created_at": null, "description": null, "result": {"result_description": "Got 1 result, configured to fail if != 0", "result_query": "-- tests/check_record_count.sql\n\nwith actual_count as (\n    select\n        count(*) as actual_count\n    from \"elementary_demo\".\"public\".\"test_practice\"\n),\nexpected_count as (\n    select 300 as expected_count\n)\n\nselect\n    actual_count,\n    expected_count\nfrom actual_count, expected_count\nwhere actual_count != expected_count"}, "configuration": {"test_name": "test4_dbt_test", "test_params": {}}, "test_tags": [], "normalized_full_path": "elementary_tutorial/tests/test4_dbt_test.sql"}, "test_results": {"display_name": "test4_dbt_test", "results_sample": [{"actual_count": 518, "expected_count": 300}], "error_message": "Got 1 result, configured to fail if != 0", "failed_rows_count": 1}}], "test.elementary_tutorial.test4_dbt_test": [{"metadata": {"test_unique_id": "test.elementary_tutorial.test4_dbt_test", "elementary_unique_id": "test.elementary_tutorial.test4_dbt_test.None.singular", "database_name": "elementary_demo", "schema_name": "public", "table_name": "test_practice", "column_name": null, "test_name": "test4_dbt_test", "test_display_name": "Test4 Dbt Test", "original_path": "tests/test4_dbt_test.sql", "latest_run_time": "2024-08-19T09:28:26+08:00", "latest_run_time_utc": "2024-08-19T01:28:26+00:00", "latest_run_status": "fail", "model_unique_id": "model.elementary_tutorial.test_practice", "table_unique_id": "elementary_demo.public.test_practice", "test_type": "dbt_test", "test_sub_type": "singular", "test_query": "-- tests/check_record_count.sql\n\nwith actual_count as (\n    select\n        count(*) as actual_count\n    from \"elementary_demo\".\"public\".\"test_practice\"\n),\nexpected_count as (\n    select 300 as expected_count\n)\n\nselect\n    actual_count,\n    expected_count\nfrom actual_count, expected_count\nwhere actual_count != expected_count", "test_params": {}, "test_created_at": null, "description": null, "result": {"result_description": "Got 1 result, configured to fail if != 0", "result_query": "-- tests/check_record_count.sql\n\nwith actual_count as (\n    select\n        count(*) as actual_count\n    from \"elementary_demo\".\"public\".\"test_practice\"\n),\nexpected_count as (\n    select 300 as expected_count\n)\n\nselect\n    actual_count,\n    expected_count\nfrom actual_count, expected_count\nwhere actual_count != expected_count"}, "configuration": {"test_name": "test4_dbt_test", "test_params": {}}, "test_tags": [], "normalized_full_path": "elementary_tutorial/tests/test4_dbt_test.sql"}, "test_results": {"display_name": "test4_dbt_test", "results_sample": [{"actual_count": 518, "expected_count": 300}], "error_message": "Got 1 result, configured to fail if != 0", "failed_rows_count": 1}}], "model.elementary_tutorial.orders": [{"metadata": {"test_unique_id": "test.elementary_tutorial.elementary_dimension_anomalies_orders_status.a5036d4371", "elementary_unique_id": "test.elementary_tutorial.elementary_dimension_anomalies_orders_status.a5036d4371", "database_name": "elementary_demo", "schema_name": "public", "table_name": "orders", "column_name": null, "test_name": "dimension_anomalies", "test_display_name": "Dimension Anomalies", "original_path": "models/schema.yml", "latest_run_time": "2024-08-19T09:28:26+08:00", "latest_run_time_utc": "2024-08-19T01:28:26+00:00", "latest_run_status": "pass", "model_unique_id": "model.elementary_tutorial.orders", "table_unique_id": "elementary_demo.public.orders", "test_type": "anomaly_detection", "test_sub_type": "generic", "test_query": "select * from (with anomaly_scores as (\n        select\n            id,\n            metric_id,\n            test_execution_id,\n            test_unique_id,\n            detected_at,\n            full_table_name,\n            column_name,\n            metric_name,\n            anomaly_score,\n            anomaly_score_threshold,\n            anomalous_value,\n            bucket_start,\n            bucket_end,\n            bucket_seasonality,\n            metric_value,\n            min_metric_value,\n            max_metric_value,\n            training_avg,\n            training_stddev,\n            training_set_size,\n            training_start,\n            training_end,\n            dimension,\n            dimension_value,\n            \n    case\n        when dimension is not null and column_name is null then \n    'The last ' || metric_name || ' value for dimension ' || dimension || ' - ' ||\n    case when dimension_value is null then 'NULL' else dimension_value end || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when dimension is not null and column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value for dimension ' || dimension || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when metric_name = 'freshness' then \n    'Last update was at ' || anomalous_value || ', ' || cast(abs(round(cast(metric_value/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours ago. Usually the table is updated within ' || cast(abs(round(cast(training_avg/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours.'\n\n        when column_name is null then \n    'The last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        else null\n    end as anomaly_description\n,\n            max(bucket_end) over (partition by test_execution_id) as max_bucket_end\n        from \"elementary_demo\".\"public\".\"test_a5036d4371_eleme__anomaly_scores__tmp_20240819012824913908\"\n      ),\n      anomaly_scores_with_is_anomalous as (\n        select\n          *,\ncase when\n          (\n            \n  (anomaly_score is not null and\n  (\n    \n  (\n    metric_value = 0 and \n    \n      1 = 2\n    \n  )\n or\n    (\n      case when metric_name IN \n        ( 'freshness' ,  'event_freshness'  )\n then\n            anomaly_score > 3\n    else\n        \n        abs(anomaly_score) > 3\n    \n\n     end and\n      (\n  \n  \n  \n  \n    \n        (1 = 1)\n    \n\n    and\n\n    \n        (1 = 1)\n    \n  \n  )\n    )\n  ))\n\n          )\n          and bucket_end >= \n    cast(max_bucket_end as timestamp) + cast('-2' as integer) * INTERVAL '1 day'\n\n          then TRUE else FALSE end as is_anomalous\n        from anomaly_scores\n      ),\n\n      final_results as (\n          select\n          metric_value as value,\n          training_avg as average,\n          \n          case\n          when is_anomalous = TRUE and 'both' = 'spike' then\n          lag(metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when is_anomalous = TRUE and 'both' != 'spike' then\n          lag(min_metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when 'both' = 'spike' then metric_value\n          else min_metric_value end as min_value,\n          case\n          when is_anomalous = TRUE and 'both' = 'drop' then\n          lag(metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when is_anomalous = TRUE and 'both' != 'drop' then\n          lag(max_metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when 'both' = 'drop' then metric_value\n          else max_metric_value end as max_value,\n          bucket_start as start_time,\n          bucket_end as end_time,\n          *\n        from anomaly_scores_with_is_anomalous\n        order by bucket_end, dimension_value\n      )\n\n      select * from final_results\n      where 1 = 1) results\n    where is_anomalous = true", "test_params": {"dimensions": ["status"], "model": "{{ get_where_subquery(ref('orders')) }}"}, "test_created_at": null, "description": "Monitors the frequency of values in the configured dimensions over time.", "result": {"result_description": null, "result_query": "select * from (with anomaly_scores as (\n        select\n            id,\n            metric_id,\n            test_execution_id,\n            test_unique_id,\n            detected_at,\n            full_table_name,\n            column_name,\n            metric_name,\n            anomaly_score,\n            anomaly_score_threshold,\n            anomalous_value,\n            bucket_start,\n            bucket_end,\n            bucket_seasonality,\n            metric_value,\n            min_metric_value,\n            max_metric_value,\n            training_avg,\n            training_stddev,\n            training_set_size,\n            training_start,\n            training_end,\n            dimension,\n            dimension_value,\n            \n    case\n        when dimension is not null and column_name is null then \n    'The last ' || metric_name || ' value for dimension ' || dimension || ' - ' ||\n    case when dimension_value is null then 'NULL' else dimension_value end || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when dimension is not null and column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value for dimension ' || dimension || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when metric_name = 'freshness' then \n    'Last update was at ' || anomalous_value || ', ' || cast(abs(round(cast(metric_value/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours ago. Usually the table is updated within ' || cast(abs(round(cast(training_avg/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours.'\n\n        when column_name is null then \n    'The last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        else null\n    end as anomaly_description\n,\n            max(bucket_end) over (partition by test_execution_id) as max_bucket_end\n        from \"elementary_demo\".\"public\".\"test_a5036d4371_eleme__anomaly_scores__tmp_20240819012824913908\"\n      ),\n      anomaly_scores_with_is_anomalous as (\n        select\n          *,\ncase when\n          (\n            \n  (anomaly_score is not null and\n  (\n    \n  (\n    metric_value = 0 and \n    \n      1 = 2\n    \n  )\n or\n    (\n      case when metric_name IN \n        ( 'freshness' ,  'event_freshness'  )\n then\n            anomaly_score > 3\n    else\n        \n        abs(anomaly_score) > 3\n    \n\n     end and\n      (\n  \n  \n  \n  \n    \n        (1 = 1)\n    \n\n    and\n\n    \n        (1 = 1)\n    \n  \n  )\n    )\n  ))\n\n          )\n          and bucket_end >= \n    cast(max_bucket_end as timestamp) + cast('-2' as integer) * INTERVAL '1 day'\n\n          then TRUE else FALSE end as is_anomalous\n        from anomaly_scores\n      ),\n\n      final_results as (\n          select\n          metric_value as value,\n          training_avg as average,\n          \n          case\n          when is_anomalous = TRUE and 'both' = 'spike' then\n          lag(metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when is_anomalous = TRUE and 'both' != 'spike' then\n          lag(min_metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when 'both' = 'spike' then metric_value\n          else min_metric_value end as min_value,\n          case\n          when is_anomalous = TRUE and 'both' = 'drop' then\n          lag(metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when is_anomalous = TRUE and 'both' != 'drop' then\n          lag(max_metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when 'both' = 'drop' then metric_value\n          else max_metric_value end as max_value,\n          bucket_start as start_time,\n          bucket_end as end_time,\n          *\n        from anomaly_scores_with_is_anomalous\n        order by bucket_end, dimension_value\n      )\n\n      select * from final_results\n      where 1 = 1) results\n    where is_anomalous = true"}, "configuration": {"test_name": "dimension_anomalies", "timestamp_column": null, "testing_timeframe": "1 day", "anomaly_threshold": null}, "test_tags": ["elementary-tests"], "normalized_full_path": "elementary_tutorial/models/schema.yml"}, "test_results": {"display_name": "Generic", "metrics": {"headers": [{"id": "anomalous_value_timestamp", "display_name": "timestamp", "type": "date"}, {"id": "anomalous_value_generic", "display_name": "generic", "type": "int"}, {"id": "anomalous_value_average_generic", "display_name": "average generic", "type": "int"}], "test_rows_sample": []}, "result_description": null}}], "model.elementary_tutorial.test4schema": [{"metadata": {"test_unique_id": "test.elementary_tutorial.elementary_schema_changes_test4schema_.5b49e3c366", "elementary_unique_id": "test.elementary_tutorial.elementary_schema_changes_test4schema_.5b49e3c366", "database_name": "elementary_demo", "schema_name": "public", "table_name": "test4schema", "column_name": null, "test_name": "schema_changes", "test_display_name": "Schema Changes", "original_path": "models/schema.yml", "latest_run_time": "2024-08-19T09:28:26+08:00", "latest_run_time_utc": "2024-08-19T01:28:26+00:00", "latest_run_status": "pass", "model_unique_id": "model.elementary_tutorial.test4schema", "table_unique_id": "elementary_demo.public.test4schema", "test_type": "schema_change", "test_sub_type": "generic", "test_query": "select * from \"elementary_demo\".\"public\".\"test_5b49e3c36__schema_changes_alerts__tmp_20240819012825218126\"", "test_params": {"model": "{{ get_where_subquery(ref('test4schema')) }}"}, "test_created_at": null, "description": "Monitors schema changes on the table of deleted, added, type changed columns over time. The test will fail if the table's schema changed from the previous execution of the test.", "result": {"result_description": null, "result_query": "select * from \"elementary_demo\".\"public\".\"test_5b49e3c36__schema_changes_alerts__tmp_20240819012825218126\""}, "configuration": {"test_name": "schema_changes", "timestamp_column": null, "testing_timeframe": "1 day", "anomaly_threshold": null}, "test_tags": ["elementary", "elementary-tests"], "normalized_full_path": "elementary_tutorial/models/schema.yml"}, "test_results": {"display_name": "generic", "metrics": null, "result_description": null}}], "model.elementary_tutorial.test4_column_anomaly": [{"metadata": {"test_unique_id": "test.elementary_tutorial.elementary_column_anomalies_test4_column_anomaly_1__null_count__name.5c88e6fb20", "elementary_unique_id": "test.elementary_tutorial.elementary_column_anomalies_test4_column_anomaly_1__null_count__name.5c88e6fb20.name.generic", "database_name": "elementary_demo", "schema_name": "public", "table_name": "test4_column_anomaly", "column_name": "name", "test_name": "column_anomalies", "test_display_name": "Column Anomalies", "original_path": "models/schema.yml", "latest_run_time": "2024-08-19T09:28:26+08:00", "latest_run_time_utc": "2024-08-19T01:28:26+00:00", "latest_run_status": "pass", "model_unique_id": "model.elementary_tutorial.test4_column_anomaly", "table_unique_id": "elementary_demo.public.test4_column_anomaly", "test_type": "anomaly_detection", "test_sub_type": "generic", "test_query": "select * from (with anomaly_scores as (\n        select\n            id,\n            metric_id,\n            test_execution_id,\n            test_unique_id,\n            detected_at,\n            full_table_name,\n            column_name,\n            metric_name,\n            anomaly_score,\n            anomaly_score_threshold,\n            anomalous_value,\n            bucket_start,\n            bucket_end,\n            bucket_seasonality,\n            metric_value,\n            min_metric_value,\n            max_metric_value,\n            training_avg,\n            training_stddev,\n            training_set_size,\n            training_start,\n            training_end,\n            dimension,\n            dimension_value,\n            \n    case\n        when dimension is not null and column_name is null then \n    'The last ' || metric_name || ' value for dimension ' || dimension || ' - ' ||\n    case when dimension_value is null then 'NULL' else dimension_value end || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when dimension is not null and column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value for dimension ' || dimension || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when metric_name = 'freshness' then \n    'Last update was at ' || anomalous_value || ', ' || cast(abs(round(cast(metric_value/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours ago. Usually the table is updated within ' || cast(abs(round(cast(training_avg/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours.'\n\n        when column_name is null then \n    'The last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        else null\n    end as anomaly_description\n,\n            max(bucket_end) over (partition by test_execution_id) as max_bucket_end\n        from \"elementary_demo\".\"public\".\"test_5c88e6fb20_eleme__anomaly_scores__tmp_20240819012824424360\"\n      ),\n      anomaly_scores_with_is_anomalous as (\n        select\n          *,\ncase when\n          (\n            \n  (anomaly_score is not null and\n  (\n    \n  (\n    metric_value = 0 and \n    \n      1 = 2\n    \n  )\n or\n    (\n      case when metric_name IN \n        ( 'freshness' ,  'event_freshness'  )\n then\n            anomaly_score > 1\n    else\n        \n        abs(anomaly_score) > 1\n    \n\n     end and\n      (\n  \n  \n  \n  \n    \n        (1 = 1)\n    \n\n    and\n\n    \n        (1 = 1)\n    \n  \n  )\n    )\n  ))\n\n          )\n          and bucket_end >= \n    cast(max_bucket_end as timestamp) + cast('-2' as integer) * INTERVAL '1 day'\n\n          then TRUE else FALSE end as is_anomalous\n        from anomaly_scores\n      ),\n\n      final_results as (\n          select\n          metric_value as value,\n          training_avg as average,\n          \n          case\n          when is_anomalous = TRUE and 'both' = 'spike' then\n          lag(metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when is_anomalous = TRUE and 'both' != 'spike' then\n          lag(min_metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when 'both' = 'spike' then metric_value\n          else min_metric_value end as min_value,\n          case\n          when is_anomalous = TRUE and 'both' = 'drop' then\n          lag(metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when is_anomalous = TRUE and 'both' != 'drop' then\n          lag(max_metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when 'both' = 'drop' then metric_value\n          else max_metric_value end as max_value,\n          bucket_start as start_time,\n          bucket_end as end_time,\n          *\n        from anomaly_scores_with_is_anomalous\n        order by bucket_end, dimension_value\n      )\n\n      select * from final_results\n      where 1 = 1) results\n    where is_anomalous = true", "test_params": {"column_anomalies": ["null_count"], "anomaly_sensitivity": 1, "column_name": "name", "model": "{{ get_where_subquery(ref('test4_column_anomaly')) }}"}, "test_created_at": null, "description": "Column-level anomaly monitors (null_count, null_percent, zero_count, string_length, variance, etc.) on the column according to its data type.", "result": {"result_description": null, "result_query": "select * from (with anomaly_scores as (\n        select\n            id,\n            metric_id,\n            test_execution_id,\n            test_unique_id,\n            detected_at,\n            full_table_name,\n            column_name,\n            metric_name,\n            anomaly_score,\n            anomaly_score_threshold,\n            anomalous_value,\n            bucket_start,\n            bucket_end,\n            bucket_seasonality,\n            metric_value,\n            min_metric_value,\n            max_metric_value,\n            training_avg,\n            training_stddev,\n            training_set_size,\n            training_start,\n            training_end,\n            dimension,\n            dimension_value,\n            \n    case\n        when dimension is not null and column_name is null then \n    'The last ' || metric_name || ' value for dimension ' || dimension || ' - ' ||\n    case when dimension_value is null then 'NULL' else dimension_value end || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when dimension is not null and column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value for dimension ' || dimension || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when metric_name = 'freshness' then \n    'Last update was at ' || anomalous_value || ', ' || cast(abs(round(cast(metric_value/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours ago. Usually the table is updated within ' || cast(abs(round(cast(training_avg/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours.'\n\n        when column_name is null then \n    'The last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        else null\n    end as anomaly_description\n,\n            max(bucket_end) over (partition by test_execution_id) as max_bucket_end\n        from \"elementary_demo\".\"public\".\"test_5c88e6fb20_eleme__anomaly_scores__tmp_20240819012824424360\"\n      ),\n      anomaly_scores_with_is_anomalous as (\n        select\n          *,\ncase when\n          (\n            \n  (anomaly_score is not null and\n  (\n    \n  (\n    metric_value = 0 and \n    \n      1 = 2\n    \n  )\n or\n    (\n      case when metric_name IN \n        ( 'freshness' ,  'event_freshness'  )\n then\n            anomaly_score > 1\n    else\n        \n        abs(anomaly_score) > 1\n    \n\n     end and\n      (\n  \n  \n  \n  \n    \n        (1 = 1)\n    \n\n    and\n\n    \n        (1 = 1)\n    \n  \n  )\n    )\n  ))\n\n          )\n          and bucket_end >= \n    cast(max_bucket_end as timestamp) + cast('-2' as integer) * INTERVAL '1 day'\n\n          then TRUE else FALSE end as is_anomalous\n        from anomaly_scores\n      ),\n\n      final_results as (\n          select\n          metric_value as value,\n          training_avg as average,\n          \n          case\n          when is_anomalous = TRUE and 'both' = 'spike' then\n          lag(metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when is_anomalous = TRUE and 'both' != 'spike' then\n          lag(min_metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when 'both' = 'spike' then metric_value\n          else min_metric_value end as min_value,\n          case\n          when is_anomalous = TRUE and 'both' = 'drop' then\n          lag(metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when is_anomalous = TRUE and 'both' != 'drop' then\n          lag(max_metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when 'both' = 'drop' then metric_value\n          else max_metric_value end as max_value,\n          bucket_start as start_time,\n          bucket_end as end_time,\n          *\n        from anomaly_scores_with_is_anomalous\n        order by bucket_end, dimension_value\n      )\n\n      select * from final_results\n      where 1 = 1) results\n    where is_anomalous = true"}, "configuration": {"test_name": "column_anomalies", "timestamp_column": null, "testing_timeframe": "1 day", "anomaly_threshold": 1}, "test_tags": ["column_anomalies", "elementary-tests"], "normalized_full_path": "elementary_tutorial/models/schema.yml"}, "test_results": {"display_name": "Generic", "metrics": [], "result_description": null}}, {"metadata": {"test_unique_id": "test.elementary_tutorial.elementary_column_anomalies_test4_column_anomaly_1__zero_count__max__age.21be7f55a1", "elementary_unique_id": "test.elementary_tutorial.elementary_column_anomalies_test4_column_anomaly_1__zero_count__max__age.21be7f55a1.age.generic", "database_name": "elementary_demo", "schema_name": "public", "table_name": "test4_column_anomaly", "column_name": "age", "test_name": "column_anomalies", "test_display_name": "Column Anomalies", "original_path": "models/schema.yml", "latest_run_time": "2024-08-19T09:28:26+08:00", "latest_run_time_utc": "2024-08-19T01:28:26+00:00", "latest_run_status": "pass", "model_unique_id": "model.elementary_tutorial.test4_column_anomaly", "table_unique_id": "elementary_demo.public.test4_column_anomaly", "test_type": "anomaly_detection", "test_sub_type": "generic", "test_query": "select * from (with anomaly_scores as (\n        select\n            id,\n            metric_id,\n            test_execution_id,\n            test_unique_id,\n            detected_at,\n            full_table_name,\n            column_name,\n            metric_name,\n            anomaly_score,\n            anomaly_score_threshold,\n            anomalous_value,\n            bucket_start,\n            bucket_end,\n            bucket_seasonality,\n            metric_value,\n            min_metric_value,\n            max_metric_value,\n            training_avg,\n            training_stddev,\n            training_set_size,\n            training_start,\n            training_end,\n            dimension,\n            dimension_value,\n            \n    case\n        when dimension is not null and column_name is null then \n    'The last ' || metric_name || ' value for dimension ' || dimension || ' - ' ||\n    case when dimension_value is null then 'NULL' else dimension_value end || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when dimension is not null and column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value for dimension ' || dimension || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when metric_name = 'freshness' then \n    'Last update was at ' || anomalous_value || ', ' || cast(abs(round(cast(metric_value/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours ago. Usually the table is updated within ' || cast(abs(round(cast(training_avg/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours.'\n\n        when column_name is null then \n    'The last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        else null\n    end as anomaly_description\n,\n            max(bucket_end) over (partition by test_execution_id) as max_bucket_end\n        from \"elementary_demo\".\"public\".\"test_21be7f55a1_eleme__anomaly_scores__tmp_20240819012824655440\"\n      ),\n      anomaly_scores_with_is_anomalous as (\n        select\n          *,\ncase when\n          (\n            \n  (anomaly_score is not null and\n  (\n    \n  (\n    metric_value = 0 and \n    \n      1 = 2\n    \n  )\n or\n    (\n      case when metric_name IN \n        ( 'freshness' ,  'event_freshness'  )\n then\n            anomaly_score > 1\n    else\n        \n        abs(anomaly_score) > 1\n    \n\n     end and\n      (\n  \n  \n  \n  \n    \n        (1 = 1)\n    \n\n    and\n\n    \n        (1 = 1)\n    \n  \n  )\n    )\n  ))\n\n          )\n          and bucket_end >= \n    cast(max_bucket_end as timestamp) + cast('-2' as integer) * INTERVAL '1 day'\n\n          then TRUE else FALSE end as is_anomalous\n        from anomaly_scores\n      ),\n\n      final_results as (\n          select\n          metric_value as value,\n          training_avg as average,\n          \n          case\n          when is_anomalous = TRUE and 'both' = 'spike' then\n          lag(metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when is_anomalous = TRUE and 'both' != 'spike' then\n          lag(min_metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when 'both' = 'spike' then metric_value\n          else min_metric_value end as min_value,\n          case\n          when is_anomalous = TRUE and 'both' = 'drop' then\n          lag(metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when is_anomalous = TRUE and 'both' != 'drop' then\n          lag(max_metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when 'both' = 'drop' then metric_value\n          else max_metric_value end as max_value,\n          bucket_start as start_time,\n          bucket_end as end_time,\n          *\n        from anomaly_scores_with_is_anomalous\n        order by bucket_end, dimension_value\n      )\n\n      select * from final_results\n      where 1 = 1) results\n    where is_anomalous = true", "test_params": {"column_anomalies": ["zero_count", "max"], "anomaly_sensitivity": 1, "column_name": "age", "model": "{{ get_where_subquery(ref('test4_column_anomaly')) }}"}, "test_created_at": null, "description": "Column-level anomaly monitors (null_count, null_percent, zero_count, string_length, variance, etc.) on the column according to its data type.", "result": {"result_description": null, "result_query": "select * from (with anomaly_scores as (\n        select\n            id,\n            metric_id,\n            test_execution_id,\n            test_unique_id,\n            detected_at,\n            full_table_name,\n            column_name,\n            metric_name,\n            anomaly_score,\n            anomaly_score_threshold,\n            anomalous_value,\n            bucket_start,\n            bucket_end,\n            bucket_seasonality,\n            metric_value,\n            min_metric_value,\n            max_metric_value,\n            training_avg,\n            training_stddev,\n            training_set_size,\n            training_start,\n            training_end,\n            dimension,\n            dimension_value,\n            \n    case\n        when dimension is not null and column_name is null then \n    'The last ' || metric_name || ' value for dimension ' || dimension || ' - ' ||\n    case when dimension_value is null then 'NULL' else dimension_value end || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when dimension is not null and column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value for dimension ' || dimension || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when metric_name = 'freshness' then \n    'Last update was at ' || anomalous_value || ', ' || cast(abs(round(cast(metric_value/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours ago. Usually the table is updated within ' || cast(abs(round(cast(training_avg/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours.'\n\n        when column_name is null then \n    'The last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        else null\n    end as anomaly_description\n,\n            max(bucket_end) over (partition by test_execution_id) as max_bucket_end\n        from \"elementary_demo\".\"public\".\"test_21be7f55a1_eleme__anomaly_scores__tmp_20240819012824655440\"\n      ),\n      anomaly_scores_with_is_anomalous as (\n        select\n          *,\ncase when\n          (\n            \n  (anomaly_score is not null and\n  (\n    \n  (\n    metric_value = 0 and \n    \n      1 = 2\n    \n  )\n or\n    (\n      case when metric_name IN \n        ( 'freshness' ,  'event_freshness'  )\n then\n            anomaly_score > 1\n    else\n        \n        abs(anomaly_score) > 1\n    \n\n     end and\n      (\n  \n  \n  \n  \n    \n        (1 = 1)\n    \n\n    and\n\n    \n        (1 = 1)\n    \n  \n  )\n    )\n  ))\n\n          )\n          and bucket_end >= \n    cast(max_bucket_end as timestamp) + cast('-2' as integer) * INTERVAL '1 day'\n\n          then TRUE else FALSE end as is_anomalous\n        from anomaly_scores\n      ),\n\n      final_results as (\n          select\n          metric_value as value,\n          training_avg as average,\n          \n          case\n          when is_anomalous = TRUE and 'both' = 'spike' then\n          lag(metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when is_anomalous = TRUE and 'both' != 'spike' then\n          lag(min_metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when 'both' = 'spike' then metric_value\n          else min_metric_value end as min_value,\n          case\n          when is_anomalous = TRUE and 'both' = 'drop' then\n          lag(metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when is_anomalous = TRUE and 'both' != 'drop' then\n          lag(max_metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when 'both' = 'drop' then metric_value\n          else max_metric_value end as max_value,\n          bucket_start as start_time,\n          bucket_end as end_time,\n          *\n        from anomaly_scores_with_is_anomalous\n        order by bucket_end, dimension_value\n      )\n\n      select * from final_results\n      where 1 = 1) results\n    where is_anomalous = true"}, "configuration": {"test_name": "column_anomalies", "timestamp_column": null, "testing_timeframe": "1 day", "anomaly_threshold": 1}, "test_tags": ["column_test", "elementary-tests"], "normalized_full_path": "elementary_tutorial/models/schema.yml"}, "test_results": {"display_name": "Generic", "metrics": [], "result_description": null}}], "model.elementary_tutorial.test4_volume_anomaly": [{"metadata": {"test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_test4_volume_anomaly_1.22dd1cb7dd", "elementary_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_test4_volume_anomaly_1.22dd1cb7dd.None.generic", "database_name": "elementary_demo", "schema_name": "public", "table_name": "test4_volume_anomaly", "column_name": null, "test_name": "volume_anomalies", "test_display_name": "Volume Anomalies", "original_path": "models/schema.yml", "latest_run_time": "2024-08-18T11:49:49+08:00", "latest_run_time_utc": "2024-08-18T03:49:49+00:00", "latest_run_status": "error", "model_unique_id": "model.elementary_tutorial.test4_volume_anomaly", "table_unique_id": "elementary_demo.public.test4_volume_anomaly", "test_type": "anomaly_detection", "test_sub_type": "generic", "test_query": null, "test_params": {"anomaly_sensitivity": 1, "model": "{{ get_where_subquery(ref('test4_volume_anomaly')) }}"}, "test_created_at": null, "description": "Monitors the row count of your table over time.", "result": {"result_description": "Database Error in test elementary_volume_anomalies_test4_volume_anomaly_1 (models/schema.yml)\n  relation \"public.test4_volume_anomaly\" does not exist\n  LINE 20:         from \"elementary_demo\".\"public\".\"test4_volume_anomal...\n                        ^", "result_query": null}, "configuration": {"test_name": "volume_anomalies", "timestamp_column": null, "testing_timeframe": "1 day", "anomaly_threshold": 1}, "test_tags": ["column_test", "elementary-tests"], "normalized_full_path": "elementary_tutorial/models/schema.yml"}, "test_results": {"display_name": "Generic", "metrics": null, "result_description": "Database Error in test elementary_volume_anomalies_test4_volume_anomaly_1 (models/schema.yml)\n  relation \"public.test4_volume_anomaly\" does not exist\n  LINE 20:         from \"elementary_demo\".\"public\".\"test4_volume_anomal...\n                        ^"}}, {"metadata": {"test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_test4_volume_anomaly_1.22dd1cb7dd", "elementary_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_test4_volume_anomaly_1.22dd1cb7dd.None.row_count", "database_name": "elementary_demo", "schema_name": "public", "table_name": "test4_volume_anomaly", "column_name": null, "test_name": "volume_anomalies", "test_display_name": "Volume Anomalies", "original_path": "models/schema.yml", "latest_run_time": "2024-08-19T09:28:26+08:00", "latest_run_time_utc": "2024-08-19T01:28:26+00:00", "latest_run_status": "pass", "model_unique_id": "model.elementary_tutorial.test4_volume_anomaly", "table_unique_id": "elementary_demo.public.test4_volume_anomaly", "test_type": "anomaly_detection", "test_sub_type": "row_count", "test_query": "select * from (None) results\n      where\n        anomaly_score is not null and\n        upper(full_table_name) = upper(cast('ELEMENTARY_DEMO.PUBLIC.TEST4_VOLUME_ANOMALY' as varchar(4096))) and\n        metric_name = cast('row_count' as varchar(4096))", "test_params": {"anomaly_sensitivity": 1, "model": "{{ get_where_subquery(ref('test4_volume_anomaly')) }}", "timestamp_column": "birth", "where_expression": null, "anomaly_direction": "both", "time_bucket": {"period": "day", "count": 1}, "days_back": 14, "backfill_days": 2, "seasonality": null, "freshness_column": null, "event_timestamp_column": null, "dimensions": null, "ignore_small_changes": {"spike_failure_percent_threshold": null, "drop_failure_percent_threshold": null}, "fail_on_zero": false, "detection_delay": {"period": "hour", "count": 0}, "anomaly_exclude_metrics": null, "exclude_final_results": "1 = 1"}, "test_created_at": null, "description": "Monitors the row count of your table over time.", "result": {"result_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "result_query": "select * from (None) results\n      where\n        anomaly_score is not null and\n        upper(full_table_name) = upper(cast('ELEMENTARY_DEMO.PUBLIC.TEST4_VOLUME_ANOMALY' as varchar(4096))) and\n        metric_name = cast('row_count' as varchar(4096))"}, "configuration": {"test_name": "volume_anomalies", "timestamp_column": "birth", "testing_timeframe": "1 day", "anomaly_threshold": 1}, "test_tags": ["column_test", "elementary-tests"], "normalized_full_path": "elementary_tutorial/models/schema.yml"}, "test_results": {"display_name": "Row Count", "metrics": [{"value": 0.0, "average": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-06T00:00:00", "end_time": "2024-08-07T00:00:00", "id": "7448d01a1400b2840fe06311e2d569c8", "metric_id": "f28dd51e77e8fd353131130d253b0a6e", "test_execution_id": "e97da402-d3d2-4204-a365-a99740471e0e.test.elementary_tutorial.elementary_volume_anomalies_test4_volume_anomaly_1.22dd1cb7dd", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_test4_volume_anomaly_1.22dd1cb7dd", "detected_at": "2024-08-19T01:28:25.977772", "full_table_name": "ELEMENTARY_DEMO.PUBLIC.TEST4_VOLUME_ANOMALY", "column_name": null, "metric_name": "row_count", "anomaly_score": 0.0, "anomaly_score_threshold": 1, "anomalous_value": null, "bucket_start": "2024-08-06T00:00:00", "bucket_end": "2024-08-07T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 0.0, "training_avg": 0.0, "training_stddev": 0.0, "training_set_size": 2, "training_start": "2024-08-06T00:00:00", "training_end": "2024-08-07T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2024-08-19T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-07T00:00:00", "end_time": "2024-08-08T00:00:00", "id": "b7c7b327c56e431fe0b5553bccff7330", "metric_id": "60c5a4592ade0f2a929c09c2bcb48259", "test_execution_id": "e97da402-d3d2-4204-a365-a99740471e0e.test.elementary_tutorial.elementary_volume_anomalies_test4_volume_anomaly_1.22dd1cb7dd", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_test4_volume_anomaly_1.22dd1cb7dd", "detected_at": "2024-08-19T01:28:25.977772", "full_table_name": "ELEMENTARY_DEMO.PUBLIC.TEST4_VOLUME_ANOMALY", "column_name": null, "metric_name": "row_count", "anomaly_score": 0.0, "anomaly_score_threshold": 1, "anomalous_value": null, "bucket_start": "2024-08-07T00:00:00", "bucket_end": "2024-08-08T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 0.0, "training_avg": 0.0, "training_stddev": 0.0, "training_set_size": 3, "training_start": "2024-08-06T00:00:00", "training_end": "2024-08-08T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2024-08-19T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-08T00:00:00", "end_time": "2024-08-09T00:00:00", "id": "6bdfb80fc686900d9288f37720e38e63", "metric_id": "4613998431e4e67c099ae2354ad14987", "test_execution_id": "e97da402-d3d2-4204-a365-a99740471e0e.test.elementary_tutorial.elementary_volume_anomalies_test4_volume_anomaly_1.22dd1cb7dd", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_test4_volume_anomaly_1.22dd1cb7dd", "detected_at": "2024-08-19T01:28:25.977772", "full_table_name": "ELEMENTARY_DEMO.PUBLIC.TEST4_VOLUME_ANOMALY", "column_name": null, "metric_name": "row_count", "anomaly_score": 0.0, "anomaly_score_threshold": 1, "anomalous_value": null, "bucket_start": "2024-08-08T00:00:00", "bucket_end": "2024-08-09T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 0.0, "training_avg": 0.0, "training_stddev": 0.0, "training_set_size": 4, "training_start": "2024-08-06T00:00:00", "training_end": "2024-08-09T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2024-08-19T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-09T00:00:00", "end_time": "2024-08-10T00:00:00", "id": "dee302ac281a82c62d5bf4ceefcb1cd8", "metric_id": "a09d7175c7a82b047a9b66ad242aef1d", "test_execution_id": "e97da402-d3d2-4204-a365-a99740471e0e.test.elementary_tutorial.elementary_volume_anomalies_test4_volume_anomaly_1.22dd1cb7dd", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_test4_volume_anomaly_1.22dd1cb7dd", "detected_at": "2024-08-19T01:28:25.977772", "full_table_name": "ELEMENTARY_DEMO.PUBLIC.TEST4_VOLUME_ANOMALY", "column_name": null, "metric_name": "row_count", "anomaly_score": 0.0, "anomaly_score_threshold": 1, "anomalous_value": null, "bucket_start": "2024-08-09T00:00:00", "bucket_end": "2024-08-10T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 0.0, "training_avg": 0.0, "training_stddev": 0.0, "training_set_size": 5, "training_start": "2024-08-06T00:00:00", "training_end": "2024-08-10T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2024-08-19T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-10T00:00:00", "end_time": "2024-08-11T00:00:00", "id": "aaa4c1f6b3426803b1ffc26a5458ab2d", "metric_id": "9bdfc120aec594b6f59a2832060199d1", "test_execution_id": "e97da402-d3d2-4204-a365-a99740471e0e.test.elementary_tutorial.elementary_volume_anomalies_test4_volume_anomaly_1.22dd1cb7dd", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_test4_volume_anomaly_1.22dd1cb7dd", "detected_at": "2024-08-19T01:28:25.977772", "full_table_name": "ELEMENTARY_DEMO.PUBLIC.TEST4_VOLUME_ANOMALY", "column_name": null, "metric_name": "row_count", "anomaly_score": 0.0, "anomaly_score_threshold": 1, "anomalous_value": null, "bucket_start": "2024-08-10T00:00:00", "bucket_end": "2024-08-11T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 0.0, "training_avg": 0.0, "training_stddev": 0.0, "training_set_size": 6, "training_start": "2024-08-06T00:00:00", "training_end": "2024-08-11T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2024-08-19T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-11T00:00:00", "end_time": "2024-08-12T00:00:00", "id": "45988bd3569f7c50567bce3977636f28", "metric_id": "01ca5a20ea8213cc6bf5818f2c629880", "test_execution_id": "e97da402-d3d2-4204-a365-a99740471e0e.test.elementary_tutorial.elementary_volume_anomalies_test4_volume_anomaly_1.22dd1cb7dd", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_test4_volume_anomaly_1.22dd1cb7dd", "detected_at": "2024-08-19T01:28:25.977772", "full_table_name": "ELEMENTARY_DEMO.PUBLIC.TEST4_VOLUME_ANOMALY", "column_name": null, "metric_name": "row_count", "anomaly_score": 0.0, "anomaly_score_threshold": 1, "anomalous_value": null, "bucket_start": "2024-08-11T00:00:00", "bucket_end": "2024-08-12T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 0.0, "training_avg": 0.0, "training_stddev": 0.0, "training_set_size": 7, "training_start": "2024-08-06T00:00:00", "training_end": "2024-08-12T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2024-08-19T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-12T00:00:00", "end_time": "2024-08-13T00:00:00", "id": "b040fa5d85c8b4f205c9261dca731617", "metric_id": "044a1d1bb80a5b691fd860d9b9c7381d", "test_execution_id": "e97da402-d3d2-4204-a365-a99740471e0e.test.elementary_tutorial.elementary_volume_anomalies_test4_volume_anomaly_1.22dd1cb7dd", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_test4_volume_anomaly_1.22dd1cb7dd", "detected_at": "2024-08-19T01:28:25.977772", "full_table_name": "ELEMENTARY_DEMO.PUBLIC.TEST4_VOLUME_ANOMALY", "column_name": null, "metric_name": "row_count", "anomaly_score": 0.0, "anomaly_score_threshold": 1, "anomalous_value": null, "bucket_start": "2024-08-12T00:00:00", "bucket_end": "2024-08-13T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 0.0, "training_avg": 0.0, "training_stddev": 0.0, "training_set_size": 8, "training_start": "2024-08-06T00:00:00", "training_end": "2024-08-13T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2024-08-19T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-13T00:00:00", "end_time": "2024-08-14T00:00:00", "id": "3bb86c7087a5db8bdd639340f04b5e3b", "metric_id": "ee733f387dc7e170207523eedc253065", "test_execution_id": "e97da402-d3d2-4204-a365-a99740471e0e.test.elementary_tutorial.elementary_volume_anomalies_test4_volume_anomaly_1.22dd1cb7dd", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_test4_volume_anomaly_1.22dd1cb7dd", "detected_at": "2024-08-19T01:28:25.977772", "full_table_name": "ELEMENTARY_DEMO.PUBLIC.TEST4_VOLUME_ANOMALY", "column_name": null, "metric_name": "row_count", "anomaly_score": 0.0, "anomaly_score_threshold": 1, "anomalous_value": null, "bucket_start": "2024-08-13T00:00:00", "bucket_end": "2024-08-14T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 0.0, "training_avg": 0.0, "training_stddev": 0.0, "training_set_size": 9, "training_start": "2024-08-06T00:00:00", "training_end": "2024-08-14T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2024-08-19T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-14T00:00:00", "end_time": "2024-08-15T00:00:00", "id": "7d1182615ccd7881acc5c8f964ea444c", "metric_id": "8308f79901229ab7bdae71781bcb3ec5", "test_execution_id": "e97da402-d3d2-4204-a365-a99740471e0e.test.elementary_tutorial.elementary_volume_anomalies_test4_volume_anomaly_1.22dd1cb7dd", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_test4_volume_anomaly_1.22dd1cb7dd", "detected_at": "2024-08-19T01:28:25.977772", "full_table_name": "ELEMENTARY_DEMO.PUBLIC.TEST4_VOLUME_ANOMALY", "column_name": null, "metric_name": "row_count", "anomaly_score": 0.0, "anomaly_score_threshold": 1, "anomalous_value": null, "bucket_start": "2024-08-14T00:00:00", "bucket_end": "2024-08-15T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 0.0, "training_avg": 0.0, "training_stddev": 0.0, "training_set_size": 10, "training_start": "2024-08-06T00:00:00", "training_end": "2024-08-15T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2024-08-19T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-15T00:00:00", "end_time": "2024-08-16T00:00:00", "id": "284aebf13819e8ff2acc0de79f1eb0bd", "metric_id": "3af5ae63fd6e46d10191543b139c3ee7", "test_execution_id": "e97da402-d3d2-4204-a365-a99740471e0e.test.elementary_tutorial.elementary_volume_anomalies_test4_volume_anomaly_1.22dd1cb7dd", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_test4_volume_anomaly_1.22dd1cb7dd", "detected_at": "2024-08-19T01:28:25.977772", "full_table_name": "ELEMENTARY_DEMO.PUBLIC.TEST4_VOLUME_ANOMALY", "column_name": null, "metric_name": "row_count", "anomaly_score": 0.0, "anomaly_score_threshold": 1, "anomalous_value": null, "bucket_start": "2024-08-15T00:00:00", "bucket_end": "2024-08-16T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 0.0, "training_avg": 0.0, "training_stddev": 0.0, "training_set_size": 11, "training_start": "2024-08-06T00:00:00", "training_end": "2024-08-16T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2024-08-19T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-16T00:00:00", "end_time": "2024-08-17T00:00:00", "id": "8257ae763d84b811026390f405d3bfb2", "metric_id": "a46c0dda369eed182b91239536efe3fe", "test_execution_id": "e97da402-d3d2-4204-a365-a99740471e0e.test.elementary_tutorial.elementary_volume_anomalies_test4_volume_anomaly_1.22dd1cb7dd", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_test4_volume_anomaly_1.22dd1cb7dd", "detected_at": "2024-08-19T01:28:25.977772", "full_table_name": "ELEMENTARY_DEMO.PUBLIC.TEST4_VOLUME_ANOMALY", "column_name": null, "metric_name": "row_count", "anomaly_score": 0.0, "anomaly_score_threshold": 1, "anomalous_value": null, "bucket_start": "2024-08-16T00:00:00", "bucket_end": "2024-08-17T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 0.0, "training_avg": 0.0, "training_stddev": 0.0, "training_set_size": 12, "training_start": "2024-08-06T00:00:00", "training_end": "2024-08-17T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2024-08-19T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-17T00:00:00", "end_time": "2024-08-18T00:00:00", "id": "2321600116e7f6d3e58c687100d2c9e7", "metric_id": "9c7402fcd63a31301bdfa27bfba523a5", "test_execution_id": "e97da402-d3d2-4204-a365-a99740471e0e.test.elementary_tutorial.elementary_volume_anomalies_test4_volume_anomaly_1.22dd1cb7dd", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_test4_volume_anomaly_1.22dd1cb7dd", "detected_at": "2024-08-19T01:28:25.977772", "full_table_name": "ELEMENTARY_DEMO.PUBLIC.TEST4_VOLUME_ANOMALY", "column_name": null, "metric_name": "row_count", "anomaly_score": 0.0, "anomaly_score_threshold": 1, "anomalous_value": null, "bucket_start": "2024-08-17T00:00:00", "bucket_end": "2024-08-18T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 0.0, "training_avg": 0.0, "training_stddev": 0.0, "training_set_size": 13, "training_start": "2024-08-06T00:00:00", "training_end": "2024-08-18T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2024-08-19T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-18T00:00:00", "end_time": "2024-08-19T00:00:00", "id": "864cc8b61d08faf1d9eaf0e957ef76ae", "metric_id": "b090cc048d4391c69533e8a6b7c6b42b", "test_execution_id": "e97da402-d3d2-4204-a365-a99740471e0e.test.elementary_tutorial.elementary_volume_anomalies_test4_volume_anomaly_1.22dd1cb7dd", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_test4_volume_anomaly_1.22dd1cb7dd", "detected_at": "2024-08-19T01:28:25.977772", "full_table_name": "ELEMENTARY_DEMO.PUBLIC.TEST4_VOLUME_ANOMALY", "column_name": null, "metric_name": "row_count", "anomaly_score": 0.0, "anomaly_score_threshold": 1, "anomalous_value": null, "bucket_start": "2024-08-18T00:00:00", "bucket_end": "2024-08-19T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 0.0, "training_avg": 0.0, "training_stddev": 0.0, "training_set_size": 14, "training_start": "2024-08-06T00:00:00", "training_end": "2024-08-19T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2024-08-19T00:00:00", "is_anomalous": false}], "result_description": "The last row_count value is 0.000. The average for this metric is 0.000."}}], "model.elementary_tutorial.returned_orders": [{"metadata": {"test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "elementary_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e.None.generic", "database_name": "elementary_demo", "schema_name": "public", "table_name": "returned_orders", "column_name": null, "test_name": "volume_anomalies", "test_display_name": "Volume Anomalies", "original_path": "models/schema.yml", "latest_run_time": "2024-08-18T11:49:49+08:00", "latest_run_time_utc": "2024-08-18T03:49:49+00:00", "latest_run_status": "error", "model_unique_id": "model.elementary_tutorial.returned_orders", "table_unique_id": "elementary_demo.public.returned_orders", "test_type": "anomaly_detection", "test_sub_type": "generic", "test_query": null, "test_params": {"timestamp_column": "order_date", "model": "{{ get_where_subquery(ref('returned_orders')) }}"}, "test_created_at": null, "description": "Monitors the row count of your table over time.", "result": {"result_description": "Database Error in test elementary_volume_anomalies_returned_orders_order_date (models/schema.yml)\n  relation \"public.returned_orders\" does not exist\n  LINE 20:         from \"elementary_demo\".\"public\".\"returned_orders\"\n                        ^", "result_query": null}, "configuration": {"test_name": "volume_anomalies", "timestamp_column": "order_date", "testing_timeframe": "1 day", "anomaly_threshold": null}, "test_tags": ["elementary-tests", "table_anomalies"], "normalized_full_path": "elementary_tutorial/models/schema.yml"}, "test_results": {"display_name": "Generic", "metrics": null, "result_description": "Database Error in test elementary_volume_anomalies_returned_orders_order_date (models/schema.yml)\n  relation \"public.returned_orders\" does not exist\n  LINE 20:         from \"elementary_demo\".\"public\".\"returned_orders\"\n                        ^"}}, {"metadata": {"test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "elementary_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e.None.row_count", "database_name": "elementary_demo", "schema_name": "public", "table_name": "returned_orders", "column_name": null, "test_name": "volume_anomalies", "test_display_name": "Volume Anomalies", "original_path": "models/schema.yml", "latest_run_time": "2024-08-19T09:28:25+08:00", "latest_run_time_utc": "2024-08-19T01:28:25+00:00", "latest_run_status": "pass", "model_unique_id": "model.elementary_tutorial.returned_orders", "table_unique_id": "elementary_demo.public.returned_orders", "test_type": "anomaly_detection", "test_sub_type": "row_count", "test_query": "select * from (None) results\n      where\n        anomaly_score is not null and\n        upper(full_table_name) = upper(cast('ELEMENTARY_DEMO.PUBLIC.RETURNED_ORDERS' as varchar(4096))) and\n        metric_name = cast('row_count' as varchar(4096))", "test_params": {"timestamp_column": "order_date", "model": "{{ get_where_subquery(ref('returned_orders')) }}", "where_expression": null, "anomaly_sensitivity": 3, "anomaly_direction": "both", "time_bucket": {"period": "day", "count": 1}, "days_back": 14, "backfill_days": 2, "seasonality": null, "freshness_column": null, "event_timestamp_column": null, "dimensions": null, "ignore_small_changes": {"spike_failure_percent_threshold": null, "drop_failure_percent_threshold": null}, "fail_on_zero": false, "detection_delay": {"period": "hour", "count": 0}, "anomaly_exclude_metrics": null, "exclude_final_results": "1 = 1"}, "test_created_at": null, "description": "Monitors the row count of your table over time.", "result": {"result_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "result_query": "select * from (None) results\n      where\n        anomaly_score is not null and\n        upper(full_table_name) = upper(cast('ELEMENTARY_DEMO.PUBLIC.RETURNED_ORDERS' as varchar(4096))) and\n        metric_name = cast('row_count' as varchar(4096))"}, "configuration": {"test_name": "volume_anomalies", "timestamp_column": "order_date", "testing_timeframe": "1 day", "anomaly_threshold": 3}, "test_tags": ["elementary-tests", "table_anomalies"], "normalized_full_path": "elementary_tutorial/models/schema.yml"}, "test_results": {"display_name": "Row Count", "metrics": [{"value": 0.0, "average": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-06T00:00:00", "end_time": "2024-08-07T00:00:00", "id": "307d0147fc5edf0cdcdc58c3c582cad0", "metric_id": "03e9a12599a7dbcffbf3995093017e86", "test_execution_id": "e97da402-d3d2-4204-a365-a99740471e0e.test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "detected_at": "2024-08-19T01:28:25.747225", "full_table_name": "ELEMENTARY_DEMO.PUBLIC.RETURNED_ORDERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0.0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2024-08-06T00:00:00", "bucket_end": "2024-08-07T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 0.0, "training_avg": 0.0, "training_stddev": 0.0, "training_set_size": 2, "training_start": "2024-08-06T00:00:00", "training_end": "2024-08-07T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2024-08-19T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-07T00:00:00", "end_time": "2024-08-08T00:00:00", "id": "4aafd076572bd90ddd4f273f53bc44cb", "metric_id": "1b7f24e69d1649ed88f3b5f6226632f2", "test_execution_id": "e97da402-d3d2-4204-a365-a99740471e0e.test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "detected_at": "2024-08-19T01:28:25.747225", "full_table_name": "ELEMENTARY_DEMO.PUBLIC.RETURNED_ORDERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0.0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2024-08-07T00:00:00", "bucket_end": "2024-08-08T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 0.0, "training_avg": 0.0, "training_stddev": 0.0, "training_set_size": 3, "training_start": "2024-08-06T00:00:00", "training_end": "2024-08-08T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2024-08-19T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-08T00:00:00", "end_time": "2024-08-09T00:00:00", "id": "367d6ddce1229d80c2cda9d9fec69320", "metric_id": "a9d224a7f5c239021ddcd026ea072f88", "test_execution_id": "e97da402-d3d2-4204-a365-a99740471e0e.test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "detected_at": "2024-08-19T01:28:25.747225", "full_table_name": "ELEMENTARY_DEMO.PUBLIC.RETURNED_ORDERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0.0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2024-08-08T00:00:00", "bucket_end": "2024-08-09T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 0.0, "training_avg": 0.0, "training_stddev": 0.0, "training_set_size": 4, "training_start": "2024-08-06T00:00:00", "training_end": "2024-08-09T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2024-08-19T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-09T00:00:00", "end_time": "2024-08-10T00:00:00", "id": "2ed61ad70f9fa2c5465240acca50a88e", "metric_id": "7591e13c969d0002d0393e712be67513", "test_execution_id": "e97da402-d3d2-4204-a365-a99740471e0e.test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "detected_at": "2024-08-19T01:28:25.747225", "full_table_name": "ELEMENTARY_DEMO.PUBLIC.RETURNED_ORDERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0.0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2024-08-09T00:00:00", "bucket_end": "2024-08-10T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 0.0, "training_avg": 0.0, "training_stddev": 0.0, "training_set_size": 5, "training_start": "2024-08-06T00:00:00", "training_end": "2024-08-10T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2024-08-19T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-10T00:00:00", "end_time": "2024-08-11T00:00:00", "id": "24db1aa100105952c3c8db84a53d2dc9", "metric_id": "131ea4ae018e068a309e5fc44a78095b", "test_execution_id": "e97da402-d3d2-4204-a365-a99740471e0e.test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "detected_at": "2024-08-19T01:28:25.747225", "full_table_name": "ELEMENTARY_DEMO.PUBLIC.RETURNED_ORDERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0.0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2024-08-10T00:00:00", "bucket_end": "2024-08-11T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 0.0, "training_avg": 0.0, "training_stddev": 0.0, "training_set_size": 6, "training_start": "2024-08-06T00:00:00", "training_end": "2024-08-11T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2024-08-19T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-11T00:00:00", "end_time": "2024-08-12T00:00:00", "id": "9c477b1417c2aef1a1bfb02ede3873bc", "metric_id": "239858bb809374ec3f28c20851564c5b", "test_execution_id": "e97da402-d3d2-4204-a365-a99740471e0e.test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "detected_at": "2024-08-19T01:28:25.747225", "full_table_name": "ELEMENTARY_DEMO.PUBLIC.RETURNED_ORDERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0.0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2024-08-11T00:00:00", "bucket_end": "2024-08-12T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 0.0, "training_avg": 0.0, "training_stddev": 0.0, "training_set_size": 7, "training_start": "2024-08-06T00:00:00", "training_end": "2024-08-12T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2024-08-19T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-12T00:00:00", "end_time": "2024-08-13T00:00:00", "id": "a1423233e126f3f930eba5187ff3c639", "metric_id": "e8786ffb158877193bd1e4135a0833db", "test_execution_id": "e97da402-d3d2-4204-a365-a99740471e0e.test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "detected_at": "2024-08-19T01:28:25.747225", "full_table_name": "ELEMENTARY_DEMO.PUBLIC.RETURNED_ORDERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0.0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2024-08-12T00:00:00", "bucket_end": "2024-08-13T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 0.0, "training_avg": 0.0, "training_stddev": 0.0, "training_set_size": 8, "training_start": "2024-08-06T00:00:00", "training_end": "2024-08-13T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2024-08-19T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-13T00:00:00", "end_time": "2024-08-14T00:00:00", "id": "d38d90afe3c6cbca9265000c5566cf0f", "metric_id": "72ee9e855dcfa15d6f5501ef239624ca", "test_execution_id": "e97da402-d3d2-4204-a365-a99740471e0e.test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "detected_at": "2024-08-19T01:28:25.747225", "full_table_name": "ELEMENTARY_DEMO.PUBLIC.RETURNED_ORDERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0.0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2024-08-13T00:00:00", "bucket_end": "2024-08-14T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 0.0, "training_avg": 0.0, "training_stddev": 0.0, "training_set_size": 9, "training_start": "2024-08-06T00:00:00", "training_end": "2024-08-14T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2024-08-19T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-14T00:00:00", "end_time": "2024-08-15T00:00:00", "id": "81f38850e53174704979e34b30ee42c1", "metric_id": "d4164fdb92aea38d604dd0c293fdea7e", "test_execution_id": "e97da402-d3d2-4204-a365-a99740471e0e.test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "detected_at": "2024-08-19T01:28:25.747225", "full_table_name": "ELEMENTARY_DEMO.PUBLIC.RETURNED_ORDERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0.0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2024-08-14T00:00:00", "bucket_end": "2024-08-15T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 0.0, "training_avg": 0.0, "training_stddev": 0.0, "training_set_size": 10, "training_start": "2024-08-06T00:00:00", "training_end": "2024-08-15T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2024-08-19T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-15T00:00:00", "end_time": "2024-08-16T00:00:00", "id": "1e5cafb49e30a2ac0208dc3217c94f43", "metric_id": "2df1d1e9c672d5f0d4b17681b6e74ba2", "test_execution_id": "e97da402-d3d2-4204-a365-a99740471e0e.test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "detected_at": "2024-08-19T01:28:25.747225", "full_table_name": "ELEMENTARY_DEMO.PUBLIC.RETURNED_ORDERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0.0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2024-08-15T00:00:00", "bucket_end": "2024-08-16T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 0.0, "training_avg": 0.0, "training_stddev": 0.0, "training_set_size": 11, "training_start": "2024-08-06T00:00:00", "training_end": "2024-08-16T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2024-08-19T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-16T00:00:00", "end_time": "2024-08-17T00:00:00", "id": "f40f1d255c894b1495ee6fc868abc5fd", "metric_id": "4bb5c9888cdab0d7542a5192f1cd2a19", "test_execution_id": "e97da402-d3d2-4204-a365-a99740471e0e.test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "detected_at": "2024-08-19T01:28:25.747225", "full_table_name": "ELEMENTARY_DEMO.PUBLIC.RETURNED_ORDERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0.0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2024-08-16T00:00:00", "bucket_end": "2024-08-17T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 0.0, "training_avg": 0.0, "training_stddev": 0.0, "training_set_size": 12, "training_start": "2024-08-06T00:00:00", "training_end": "2024-08-17T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2024-08-19T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-17T00:00:00", "end_time": "2024-08-18T00:00:00", "id": "0a4a83fa9a0e62d3f6493790136e595c", "metric_id": "afd18b6ea7151ad852e866395a8fb2f0", "test_execution_id": "e97da402-d3d2-4204-a365-a99740471e0e.test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "detected_at": "2024-08-19T01:28:25.747225", "full_table_name": "ELEMENTARY_DEMO.PUBLIC.RETURNED_ORDERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0.0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2024-08-17T00:00:00", "bucket_end": "2024-08-18T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 0.0, "training_avg": 0.0, "training_stddev": 0.0, "training_set_size": 13, "training_start": "2024-08-06T00:00:00", "training_end": "2024-08-18T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2024-08-19T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-18T00:00:00", "end_time": "2024-08-19T00:00:00", "id": "14570cd9457c0222a5fe58de5d9cdf04", "metric_id": "114c6a12a57dd7b31969e8a38c973c55", "test_execution_id": "e97da402-d3d2-4204-a365-a99740471e0e.test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "detected_at": "2024-08-19T01:28:25.747225", "full_table_name": "ELEMENTARY_DEMO.PUBLIC.RETURNED_ORDERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0.0, "anomaly_score_threshold": 3, "anomalous_value": null, "bucket_start": "2024-08-18T00:00:00", "bucket_end": "2024-08-19T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 0.0, "training_avg": 0.0, "training_stddev": 0.0, "training_set_size": 14, "training_start": "2024-08-06T00:00:00", "training_end": "2024-08-19T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2024-08-19T00:00:00", "is_anomalous": false}], "result_description": "The last row_count value is 0.000. The average for this metric is 0.000."}}], "model.elementary_tutorial.customers": [{"metadata": {"test_unique_id": "test.elementary_tutorial.elementary_column_anomalies_customers_zero_count__number_of_orders__signup_date.e012735381", "elementary_unique_id": "test.elementary_tutorial.elementary_column_anomalies_customers_zero_count__number_of_orders__signup_date.e012735381.number_of_orders.generic", "database_name": "elementary_demo", "schema_name": "public", "table_name": "customers", "column_name": "number_of_orders", "test_name": "column_anomalies", "test_display_name": "Column Anomalies", "original_path": "models/schema.yml", "latest_run_time": "2024-08-19T09:28:26+08:00", "latest_run_time_utc": "2024-08-19T01:28:26+00:00", "latest_run_status": "pass", "model_unique_id": "model.elementary_tutorial.customers", "table_unique_id": "elementary_demo.public.customers", "test_type": "anomaly_detection", "test_sub_type": "generic", "test_query": "select * from (with anomaly_scores as (\n        select\n            id,\n            metric_id,\n            test_execution_id,\n            test_unique_id,\n            detected_at,\n            full_table_name,\n            column_name,\n            metric_name,\n            anomaly_score,\n            anomaly_score_threshold,\n            anomalous_value,\n            bucket_start,\n            bucket_end,\n            bucket_seasonality,\n            metric_value,\n            min_metric_value,\n            max_metric_value,\n            training_avg,\n            training_stddev,\n            training_set_size,\n            training_start,\n            training_end,\n            dimension,\n            dimension_value,\n            \n    case\n        when dimension is not null and column_name is null then \n    'The last ' || metric_name || ' value for dimension ' || dimension || ' - ' ||\n    case when dimension_value is null then 'NULL' else dimension_value end || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when dimension is not null and column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value for dimension ' || dimension || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when metric_name = 'freshness' then \n    'Last update was at ' || anomalous_value || ', ' || cast(abs(round(cast(metric_value/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours ago. Usually the table is updated within ' || cast(abs(round(cast(training_avg/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours.'\n\n        when column_name is null then \n    'The last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        else null\n    end as anomaly_description\n,\n            max(bucket_end) over (partition by test_execution_id) as max_bucket_end\n        from \"elementary_demo\".\"public\".\"test_e012735381_eleme__anomaly_scores__tmp_20240819012823992585\"\n      ),\n      anomaly_scores_with_is_anomalous as (\n        select\n          *,\ncase when\n          (\n            \n  (anomaly_score is not null and\n  (\n    \n  (\n    metric_value = 0 and \n    \n      1 = 2\n    \n  )\n or\n    (\n      case when metric_name IN \n        ( 'freshness' ,  'event_freshness'  )\n then\n            anomaly_score > 3\n    else\n        \n        abs(anomaly_score) > 3\n    \n\n     end and\n      (\n  \n  \n  \n  \n    \n        (1 = 1)\n    \n\n    and\n\n    \n        (1 = 1)\n    \n  \n  )\n    )\n  ))\n\n          )\n          and bucket_end >= \n    cast(max_bucket_end as timestamp) + cast('-2' as integer) * INTERVAL '1 day'\n\n          then TRUE else FALSE end as is_anomalous\n        from anomaly_scores\n      ),\n\n      final_results as (\n          select\n          metric_value as value,\n          training_avg as average,\n          \n          case\n          when is_anomalous = TRUE and 'both' = 'spike' then\n          lag(metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when is_anomalous = TRUE and 'both' != 'spike' then\n          lag(min_metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when 'both' = 'spike' then metric_value\n          else min_metric_value end as min_value,\n          case\n          when is_anomalous = TRUE and 'both' = 'drop' then\n          lag(metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when is_anomalous = TRUE and 'both' != 'drop' then\n          lag(max_metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when 'both' = 'drop' then metric_value\n          else max_metric_value end as max_value,\n          bucket_start as start_time,\n          bucket_end as end_time,\n          *\n        from anomaly_scores_with_is_anomalous\n        order by bucket_end, dimension_value\n      )\n\n      select * from final_results\n      where 1 = 1) results\n    where is_anomalous = true", "test_params": {"column_anomalies": ["zero_count"], "timestamp_column": "signup_date", "column_name": "number_of_orders", "model": "{{ get_where_subquery(ref('customers')) }}"}, "test_created_at": null, "description": "Column-level anomaly monitors (null_count, null_percent, zero_count, string_length, variance, etc.) on the column according to its data type.", "result": {"result_description": null, "result_query": "select * from (with anomaly_scores as (\n        select\n            id,\n            metric_id,\n            test_execution_id,\n            test_unique_id,\n            detected_at,\n            full_table_name,\n            column_name,\n            metric_name,\n            anomaly_score,\n            anomaly_score_threshold,\n            anomalous_value,\n            bucket_start,\n            bucket_end,\n            bucket_seasonality,\n            metric_value,\n            min_metric_value,\n            max_metric_value,\n            training_avg,\n            training_stddev,\n            training_set_size,\n            training_start,\n            training_end,\n            dimension,\n            dimension_value,\n            \n    case\n        when dimension is not null and column_name is null then \n    'The last ' || metric_name || ' value for dimension ' || dimension || ' - ' ||\n    case when dimension_value is null then 'NULL' else dimension_value end || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when dimension is not null and column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value for dimension ' || dimension || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when metric_name = 'freshness' then \n    'Last update was at ' || anomalous_value || ', ' || cast(abs(round(cast(metric_value/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours ago. Usually the table is updated within ' || cast(abs(round(cast(training_avg/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours.'\n\n        when column_name is null then \n    'The last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        else null\n    end as anomaly_description\n,\n            max(bucket_end) over (partition by test_execution_id) as max_bucket_end\n        from \"elementary_demo\".\"public\".\"test_e012735381_eleme__anomaly_scores__tmp_20240819012823992585\"\n      ),\n      anomaly_scores_with_is_anomalous as (\n        select\n          *,\ncase when\n          (\n            \n  (anomaly_score is not null and\n  (\n    \n  (\n    metric_value = 0 and \n    \n      1 = 2\n    \n  )\n or\n    (\n      case when metric_name IN \n        ( 'freshness' ,  'event_freshness'  )\n then\n            anomaly_score > 3\n    else\n        \n        abs(anomaly_score) > 3\n    \n\n     end and\n      (\n  \n  \n  \n  \n    \n        (1 = 1)\n    \n\n    and\n\n    \n        (1 = 1)\n    \n  \n  )\n    )\n  ))\n\n          )\n          and bucket_end >= \n    cast(max_bucket_end as timestamp) + cast('-2' as integer) * INTERVAL '1 day'\n\n          then TRUE else FALSE end as is_anomalous\n        from anomaly_scores\n      ),\n\n      final_results as (\n          select\n          metric_value as value,\n          training_avg as average,\n          \n          case\n          when is_anomalous = TRUE and 'both' = 'spike' then\n          lag(metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when is_anomalous = TRUE and 'both' != 'spike' then\n          lag(min_metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when 'both' = 'spike' then metric_value\n          else min_metric_value end as min_value,\n          case\n          when is_anomalous = TRUE and 'both' = 'drop' then\n          lag(metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when is_anomalous = TRUE and 'both' != 'drop' then\n          lag(max_metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when 'both' = 'drop' then metric_value\n          else max_metric_value end as max_value,\n          bucket_start as start_time,\n          bucket_end as end_time,\n          *\n        from anomaly_scores_with_is_anomalous\n        order by bucket_end, dimension_value\n      )\n\n      select * from final_results\n      where 1 = 1) results\n    where is_anomalous = true"}, "configuration": {"test_name": "column_anomalies", "timestamp_column": "signup_date", "testing_timeframe": "1 day", "anomaly_threshold": null}, "test_tags": ["column_anomalies", "elementary-tests"], "normalized_full_path": "elementary_tutorial/models/schema.yml"}, "test_results": {"display_name": "Generic", "metrics": [], "result_description": null}}, {"metadata": {"test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_customers_1.f225f4677c", "elementary_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_customers_1.f225f4677c.None.generic", "database_name": "elementary_demo", "schema_name": "public", "table_name": "customers", "column_name": null, "test_name": "volume_anomalies", "test_display_name": "Volume Anomalies", "original_path": "models/schema.yml", "latest_run_time": "2024-08-18T11:49:49+08:00", "latest_run_time_utc": "2024-08-18T03:49:49+00:00", "latest_run_status": "error", "model_unique_id": "model.elementary_tutorial.customers", "table_unique_id": "elementary_demo.public.customers", "test_type": "anomaly_detection", "test_sub_type": "generic", "test_query": null, "test_params": {"anomaly_sensitivity": 1, "model": "{{ get_where_subquery(ref('customers')) }}"}, "test_created_at": null, "description": "Monitors the row count of your table over time.", "result": {"result_description": "Database Error in test elementary_volume_anomalies_customers_1 (models/schema.yml)\n  relation \"public.customers\" does not exist\n  LINE 20:         from \"elementary_demo\".\"public\".\"customers\"\n                        ^", "result_query": null}, "configuration": {"test_name": "volume_anomalies", "timestamp_column": null, "testing_timeframe": "1 day", "anomaly_threshold": 1}, "test_tags": ["elementary-tests", "volume_anomalies"], "normalized_full_path": "elementary_tutorial/models/schema.yml"}, "test_results": {"display_name": "Generic", "metrics": null, "result_description": "Database Error in test elementary_volume_anomalies_customers_1 (models/schema.yml)\n  relation \"public.customers\" does not exist\n  LINE 20:         from \"elementary_demo\".\"public\".\"customers\"\n                        ^"}}, {"metadata": {"test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_customers_1.f225f4677c", "elementary_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_customers_1.f225f4677c.None.row_count", "database_name": "elementary_demo", "schema_name": "public", "table_name": "customers", "column_name": null, "test_name": "volume_anomalies", "test_display_name": "Volume Anomalies", "original_path": "models/schema.yml", "latest_run_time": "2024-08-19T09:28:25+08:00", "latest_run_time_utc": "2024-08-19T01:28:25+00:00", "latest_run_status": "pass", "model_unique_id": "model.elementary_tutorial.customers", "table_unique_id": "elementary_demo.public.customers", "test_type": "anomaly_detection", "test_sub_type": "row_count", "test_query": "select * from (None) results\n      where\n        anomaly_score is not null and\n        upper(full_table_name) = upper(cast('ELEMENTARY_DEMO.PUBLIC.CUSTOMERS' as varchar(4096))) and\n        metric_name = cast('row_count' as varchar(4096))", "test_params": {"anomaly_sensitivity": 1, "model": "{{ get_where_subquery(ref('customers')) }}", "timestamp_column": "signup_date", "where_expression": null, "anomaly_direction": "both", "time_bucket": {"period": "day", "count": 1}, "days_back": 14, "backfill_days": 2, "seasonality": null, "freshness_column": null, "event_timestamp_column": null, "dimensions": null, "ignore_small_changes": {"spike_failure_percent_threshold": null, "drop_failure_percent_threshold": null}, "fail_on_zero": false, "detection_delay": {"period": "hour", "count": 0}, "anomaly_exclude_metrics": null, "exclude_final_results": "1 = 1"}, "test_created_at": null, "description": "Monitors the row count of your table over time.", "result": {"result_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "result_query": "select * from (None) results\n      where\n        anomaly_score is not null and\n        upper(full_table_name) = upper(cast('ELEMENTARY_DEMO.PUBLIC.CUSTOMERS' as varchar(4096))) and\n        metric_name = cast('row_count' as varchar(4096))"}, "configuration": {"test_name": "volume_anomalies", "timestamp_column": "signup_date", "testing_timeframe": "1 day", "anomaly_threshold": 1}, "test_tags": ["elementary-tests", "volume_anomalies"], "normalized_full_path": "elementary_tutorial/models/schema.yml"}, "test_results": {"display_name": "Row Count", "metrics": [{"value": 0.0, "average": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-06T00:00:00", "end_time": "2024-08-07T00:00:00", "id": "3f0b1a60b79c579ae25555f6caf0b003", "metric_id": "5ee2e76c2b195a27d8cc28c0448876f1", "test_execution_id": "e97da402-d3d2-4204-a365-a99740471e0e.test.elementary_tutorial.elementary_volume_anomalies_customers_1.f225f4677c", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_customers_1.f225f4677c", "detected_at": "2024-08-19T01:28:25.477349", "full_table_name": "ELEMENTARY_DEMO.PUBLIC.CUSTOMERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0.0, "anomaly_score_threshold": 1, "anomalous_value": null, "bucket_start": "2024-08-06T00:00:00", "bucket_end": "2024-08-07T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 0.0, "training_avg": 0.0, "training_stddev": 0.0, "training_set_size": 2, "training_start": "2024-08-06T00:00:00", "training_end": "2024-08-07T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2024-08-19T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-07T00:00:00", "end_time": "2024-08-08T00:00:00", "id": "f53dbe2a6f0bec2b487d7e2f71d5600f", "metric_id": "6cb0dee9a2c341cc62aea0014972600b", "test_execution_id": "e97da402-d3d2-4204-a365-a99740471e0e.test.elementary_tutorial.elementary_volume_anomalies_customers_1.f225f4677c", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_customers_1.f225f4677c", "detected_at": "2024-08-19T01:28:25.477349", "full_table_name": "ELEMENTARY_DEMO.PUBLIC.CUSTOMERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0.0, "anomaly_score_threshold": 1, "anomalous_value": null, "bucket_start": "2024-08-07T00:00:00", "bucket_end": "2024-08-08T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 0.0, "training_avg": 0.0, "training_stddev": 0.0, "training_set_size": 3, "training_start": "2024-08-06T00:00:00", "training_end": "2024-08-08T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2024-08-19T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-08T00:00:00", "end_time": "2024-08-09T00:00:00", "id": "ce3d27b554255a7a72ea9ed4bedc48dc", "metric_id": "f1f12367d7ab929a79af1a251aa5155b", "test_execution_id": "e97da402-d3d2-4204-a365-a99740471e0e.test.elementary_tutorial.elementary_volume_anomalies_customers_1.f225f4677c", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_customers_1.f225f4677c", "detected_at": "2024-08-19T01:28:25.477349", "full_table_name": "ELEMENTARY_DEMO.PUBLIC.CUSTOMERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0.0, "anomaly_score_threshold": 1, "anomalous_value": null, "bucket_start": "2024-08-08T00:00:00", "bucket_end": "2024-08-09T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 0.0, "training_avg": 0.0, "training_stddev": 0.0, "training_set_size": 4, "training_start": "2024-08-06T00:00:00", "training_end": "2024-08-09T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2024-08-19T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-09T00:00:00", "end_time": "2024-08-10T00:00:00", "id": "e13871de05861bcc5f5d2ff8bdf4b3e4", "metric_id": "f05a739d8287e839b046073239817820", "test_execution_id": "e97da402-d3d2-4204-a365-a99740471e0e.test.elementary_tutorial.elementary_volume_anomalies_customers_1.f225f4677c", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_customers_1.f225f4677c", "detected_at": "2024-08-19T01:28:25.477349", "full_table_name": "ELEMENTARY_DEMO.PUBLIC.CUSTOMERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0.0, "anomaly_score_threshold": 1, "anomalous_value": null, "bucket_start": "2024-08-09T00:00:00", "bucket_end": "2024-08-10T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 0.0, "training_avg": 0.0, "training_stddev": 0.0, "training_set_size": 5, "training_start": "2024-08-06T00:00:00", "training_end": "2024-08-10T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2024-08-19T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-10T00:00:00", "end_time": "2024-08-11T00:00:00", "id": "6a6b58028be75cbca643e0d75687b8fd", "metric_id": "5e7f381c14823f9afa7612a2a2813436", "test_execution_id": "e97da402-d3d2-4204-a365-a99740471e0e.test.elementary_tutorial.elementary_volume_anomalies_customers_1.f225f4677c", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_customers_1.f225f4677c", "detected_at": "2024-08-19T01:28:25.477349", "full_table_name": "ELEMENTARY_DEMO.PUBLIC.CUSTOMERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0.0, "anomaly_score_threshold": 1, "anomalous_value": null, "bucket_start": "2024-08-10T00:00:00", "bucket_end": "2024-08-11T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 0.0, "training_avg": 0.0, "training_stddev": 0.0, "training_set_size": 6, "training_start": "2024-08-06T00:00:00", "training_end": "2024-08-11T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2024-08-19T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-11T00:00:00", "end_time": "2024-08-12T00:00:00", "id": "52a924a6e3af73ff668195c2f402330c", "metric_id": "daa3a599b8d614aaf8391f5e749f2a0f", "test_execution_id": "e97da402-d3d2-4204-a365-a99740471e0e.test.elementary_tutorial.elementary_volume_anomalies_customers_1.f225f4677c", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_customers_1.f225f4677c", "detected_at": "2024-08-19T01:28:25.477349", "full_table_name": "ELEMENTARY_DEMO.PUBLIC.CUSTOMERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0.0, "anomaly_score_threshold": 1, "anomalous_value": null, "bucket_start": "2024-08-11T00:00:00", "bucket_end": "2024-08-12T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 0.0, "training_avg": 0.0, "training_stddev": 0.0, "training_set_size": 7, "training_start": "2024-08-06T00:00:00", "training_end": "2024-08-12T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2024-08-19T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-12T00:00:00", "end_time": "2024-08-13T00:00:00", "id": "6d6b40644eef4e0733fb3caa56535450", "metric_id": "8cd6573a0d8d66f93f9097739b3aa83f", "test_execution_id": "e97da402-d3d2-4204-a365-a99740471e0e.test.elementary_tutorial.elementary_volume_anomalies_customers_1.f225f4677c", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_customers_1.f225f4677c", "detected_at": "2024-08-19T01:28:25.477349", "full_table_name": "ELEMENTARY_DEMO.PUBLIC.CUSTOMERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0.0, "anomaly_score_threshold": 1, "anomalous_value": null, "bucket_start": "2024-08-12T00:00:00", "bucket_end": "2024-08-13T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 0.0, "training_avg": 0.0, "training_stddev": 0.0, "training_set_size": 8, "training_start": "2024-08-06T00:00:00", "training_end": "2024-08-13T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2024-08-19T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-13T00:00:00", "end_time": "2024-08-14T00:00:00", "id": "c5ad0225cf124b1a8ab864523b714056", "metric_id": "fe4f3ddac9752640082ff6386a220880", "test_execution_id": "e97da402-d3d2-4204-a365-a99740471e0e.test.elementary_tutorial.elementary_volume_anomalies_customers_1.f225f4677c", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_customers_1.f225f4677c", "detected_at": "2024-08-19T01:28:25.477349", "full_table_name": "ELEMENTARY_DEMO.PUBLIC.CUSTOMERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0.0, "anomaly_score_threshold": 1, "anomalous_value": null, "bucket_start": "2024-08-13T00:00:00", "bucket_end": "2024-08-14T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 0.0, "training_avg": 0.0, "training_stddev": 0.0, "training_set_size": 9, "training_start": "2024-08-06T00:00:00", "training_end": "2024-08-14T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2024-08-19T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-14T00:00:00", "end_time": "2024-08-15T00:00:00", "id": "49c42a0a6352a8f4905b9574bcd2dd5b", "metric_id": "20e355daba866f4442e49da44556c196", "test_execution_id": "e97da402-d3d2-4204-a365-a99740471e0e.test.elementary_tutorial.elementary_volume_anomalies_customers_1.f225f4677c", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_customers_1.f225f4677c", "detected_at": "2024-08-19T01:28:25.477349", "full_table_name": "ELEMENTARY_DEMO.PUBLIC.CUSTOMERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0.0, "anomaly_score_threshold": 1, "anomalous_value": null, "bucket_start": "2024-08-14T00:00:00", "bucket_end": "2024-08-15T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 0.0, "training_avg": 0.0, "training_stddev": 0.0, "training_set_size": 10, "training_start": "2024-08-06T00:00:00", "training_end": "2024-08-15T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2024-08-19T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-15T00:00:00", "end_time": "2024-08-16T00:00:00", "id": "15926dc7016db6ac1caa7d9c6f630410", "metric_id": "88462266bc22925621afe0e7220a29b6", "test_execution_id": "e97da402-d3d2-4204-a365-a99740471e0e.test.elementary_tutorial.elementary_volume_anomalies_customers_1.f225f4677c", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_customers_1.f225f4677c", "detected_at": "2024-08-19T01:28:25.477349", "full_table_name": "ELEMENTARY_DEMO.PUBLIC.CUSTOMERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0.0, "anomaly_score_threshold": 1, "anomalous_value": null, "bucket_start": "2024-08-15T00:00:00", "bucket_end": "2024-08-16T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 0.0, "training_avg": 0.0, "training_stddev": 0.0, "training_set_size": 11, "training_start": "2024-08-06T00:00:00", "training_end": "2024-08-16T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2024-08-19T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-16T00:00:00", "end_time": "2024-08-17T00:00:00", "id": "a6f88be04557bf0024e5b7d2a8787716", "metric_id": "de34d7be98ab635ba1fa41048328e40e", "test_execution_id": "e97da402-d3d2-4204-a365-a99740471e0e.test.elementary_tutorial.elementary_volume_anomalies_customers_1.f225f4677c", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_customers_1.f225f4677c", "detected_at": "2024-08-19T01:28:25.477349", "full_table_name": "ELEMENTARY_DEMO.PUBLIC.CUSTOMERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0.0, "anomaly_score_threshold": 1, "anomalous_value": null, "bucket_start": "2024-08-16T00:00:00", "bucket_end": "2024-08-17T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 0.0, "training_avg": 0.0, "training_stddev": 0.0, "training_set_size": 12, "training_start": "2024-08-06T00:00:00", "training_end": "2024-08-17T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2024-08-19T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-17T00:00:00", "end_time": "2024-08-18T00:00:00", "id": "bbb01f8c07d1d6aa552a6cb1c55c7b85", "metric_id": "efbdd90ba3dc22377c5bf2378106056c", "test_execution_id": "e97da402-d3d2-4204-a365-a99740471e0e.test.elementary_tutorial.elementary_volume_anomalies_customers_1.f225f4677c", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_customers_1.f225f4677c", "detected_at": "2024-08-19T01:28:25.477349", "full_table_name": "ELEMENTARY_DEMO.PUBLIC.CUSTOMERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0.0, "anomaly_score_threshold": 1, "anomalous_value": null, "bucket_start": "2024-08-17T00:00:00", "bucket_end": "2024-08-18T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 0.0, "training_avg": 0.0, "training_stddev": 0.0, "training_set_size": 13, "training_start": "2024-08-06T00:00:00", "training_end": "2024-08-18T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2024-08-19T00:00:00", "is_anomalous": false}, {"value": 0.0, "average": 0.0, "min_value": 0.0, "max_value": 0.0, "start_time": "2024-08-18T00:00:00", "end_time": "2024-08-19T00:00:00", "id": "7bf8f9e1ea888d79168f449db1f67e68", "metric_id": "ccad8a39413fdd721961a218c96c2ed2", "test_execution_id": "e97da402-d3d2-4204-a365-a99740471e0e.test.elementary_tutorial.elementary_volume_anomalies_customers_1.f225f4677c", "test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_customers_1.f225f4677c", "detected_at": "2024-08-19T01:28:25.477349", "full_table_name": "ELEMENTARY_DEMO.PUBLIC.CUSTOMERS", "column_name": null, "metric_name": "row_count", "anomaly_score": 0.0, "anomaly_score_threshold": 1, "anomalous_value": null, "bucket_start": "2024-08-18T00:00:00", "bucket_end": "2024-08-19T00:00:00", "bucket_seasonality": "no_seasonality", "metric_value": 0.0, "min_metric_value": 0.0, "max_metric_value": 0.0, "training_avg": 0.0, "training_stddev": 0.0, "training_set_size": 14, "training_start": "2024-08-06T00:00:00", "training_end": "2024-08-19T00:00:00", "dimension": null, "dimension_value": null, "anomaly_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "max_bucket_end": "2024-08-19T00:00:00", "is_anomalous": false}], "result_description": "The last row_count value is 0.000. The average for this metric is 0.000."}}]}, "test_results_totals": {"model.elementary_tutorial.test_practice": {"errors": 0, "warnings": 0, "passed": 0, "failures": 1}, "test.elementary_tutorial.test4_dbt_test": {"errors": 0, "warnings": 0, "passed": 0, "failures": 1}, "model.elementary_tutorial.orders": {"errors": 0, "warnings": 0, "passed": 1, "failures": 0}, "model.elementary_tutorial.test4schema": {"errors": 0, "warnings": 0, "passed": 1, "failures": 0}, "model.elementary_tutorial.test4_column_anomaly": {"errors": 0, "warnings": 0, "passed": 2, "failures": 0}, "model.elementary_tutorial.test4_volume_anomaly": {"errors": 1, "warnings": 0, "passed": 1, "failures": 0}, "model.elementary_tutorial.returned_orders": {"errors": 1, "warnings": 0, "passed": 1, "failures": 0}, "model.elementary_tutorial.customers": {"errors": 1, "warnings": 0, "passed": 2, "failures": 0}}, "test_runs": {"model.elementary_tutorial.test_practice": [{"metadata": {"test_unique_id": "test.elementary_tutorial.test4_dbt_test", "elementary_unique_id": "test.elementary_tutorial.test4_dbt_test.None.singular", "database_name": "elementary_demo", "schema_name": "public", "table_name": "test_practice", "column_name": null, "test_name": "test4_dbt_test", "test_display_name": "Test4 Dbt Test", "original_path": "tests/test4_dbt_test.sql", "latest_run_time": "2024-08-19T09:28:26+08:00", "latest_run_time_utc": "2024-08-19T01:28:26+00:00", "latest_run_status": "fail", "model_unique_id": "model.elementary_tutorial.test_practice", "table_unique_id": "elementary_demo.public.test_practice", "test_type": "dbt_test", "test_sub_type": "singular", "test_query": "-- tests/check_record_count.sql\n\nwith actual_count as (\n    select\n        count(*) as actual_count\n    from \"elementary_demo\".\"public\".\"test_practice\"\n),\nexpected_count as (\n    select 300 as expected_count\n)\n\nselect\n    actual_count,\n    expected_count\nfrom actual_count, expected_count\nwhere actual_count != expected_count", "test_params": {}, "test_created_at": null, "description": null, "result": {"result_description": "Got 1 result, configured to fail if != 0", "result_query": "-- tests/check_record_count.sql\n\nwith actual_count as (\n    select\n        count(*) as actual_count\n    from \"elementary_demo\".\"public\".\"test_practice\"\n),\nexpected_count as (\n    select 300 as expected_count\n)\n\nselect\n    actual_count,\n    expected_count\nfrom actual_count, expected_count\nwhere actual_count != expected_count"}, "configuration": {"test_name": "test4_dbt_test", "test_params": {}}, "test_tags": [], "normalized_full_path": "elementary_tutorial/tests/test4_dbt_test.sql"}, "test_runs": {"fail_rate": 1.0, "totals": {"errors": 1, "warnings": 0, "passed": 0, "failures": 3}, "invocations": [{"affected_rows": null, "time_utc": "2024-08-18T03:49:49+00:00", "id": "563b9e97-5eee-4b1f-b4c4-34b0549d51be", "status": "error", "execution_time": null}, {"affected_rows": 1, "time_utc": "2024-08-18T03:51:12+00:00", "id": "20ee100f-662e-401a-b32f-d932912ea4c0", "status": "fail", "execution_time": null}, {"affected_rows": 1, "time_utc": "2024-08-18T08:21:29+00:00", "id": "ca67f4f7-7982-477f-83c1-5297dd78bbe9", "status": "fail", "execution_time": null}, {"affected_rows": 1, "time_utc": "2024-08-19T01:28:26+00:00", "id": "e97da402-d3d2-4204-a365-a99740471e0e", "status": "fail", "execution_time": null}], "description": "There were 3 failures, 1 errors and no warnings on the last 4 test runs."}, "median_exec_time": 0.0, "last_exec_time": null}], "test.elementary_tutorial.test4_dbt_test": [{"metadata": {"test_unique_id": "test.elementary_tutorial.test4_dbt_test", "elementary_unique_id": "test.elementary_tutorial.test4_dbt_test.None.singular", "database_name": "elementary_demo", "schema_name": "public", "table_name": "test_practice", "column_name": null, "test_name": "test4_dbt_test", "test_display_name": "Test4 Dbt Test", "original_path": "tests/test4_dbt_test.sql", "latest_run_time": "2024-08-19T09:28:26+08:00", "latest_run_time_utc": "2024-08-19T01:28:26+00:00", "latest_run_status": "fail", "model_unique_id": "model.elementary_tutorial.test_practice", "table_unique_id": "elementary_demo.public.test_practice", "test_type": "dbt_test", "test_sub_type": "singular", "test_query": "-- tests/check_record_count.sql\n\nwith actual_count as (\n    select\n        count(*) as actual_count\n    from \"elementary_demo\".\"public\".\"test_practice\"\n),\nexpected_count as (\n    select 300 as expected_count\n)\n\nselect\n    actual_count,\n    expected_count\nfrom actual_count, expected_count\nwhere actual_count != expected_count", "test_params": {}, "test_created_at": null, "description": null, "result": {"result_description": "Got 1 result, configured to fail if != 0", "result_query": "-- tests/check_record_count.sql\n\nwith actual_count as (\n    select\n        count(*) as actual_count\n    from \"elementary_demo\".\"public\".\"test_practice\"\n),\nexpected_count as (\n    select 300 as expected_count\n)\n\nselect\n    actual_count,\n    expected_count\nfrom actual_count, expected_count\nwhere actual_count != expected_count"}, "configuration": {"test_name": "test4_dbt_test", "test_params": {}}, "test_tags": [], "normalized_full_path": "elementary_tutorial/tests/test4_dbt_test.sql"}, "test_runs": {"fail_rate": 1.0, "totals": {"errors": 1, "warnings": 0, "passed": 0, "failures": 3}, "invocations": [{"affected_rows": null, "time_utc": "2024-08-18T03:49:49+00:00", "id": "563b9e97-5eee-4b1f-b4c4-34b0549d51be", "status": "error", "execution_time": null}, {"affected_rows": 1, "time_utc": "2024-08-18T03:51:12+00:00", "id": "20ee100f-662e-401a-b32f-d932912ea4c0", "status": "fail", "execution_time": null}, {"affected_rows": 1, "time_utc": "2024-08-18T08:21:29+00:00", "id": "ca67f4f7-7982-477f-83c1-5297dd78bbe9", "status": "fail", "execution_time": null}, {"affected_rows": 1, "time_utc": "2024-08-19T01:28:26+00:00", "id": "e97da402-d3d2-4204-a365-a99740471e0e", "status": "fail", "execution_time": null}], "description": "There were 3 failures, 1 errors and no warnings on the last 4 test runs."}, "median_exec_time": 0.0, "last_exec_time": null}], "model.elementary_tutorial.orders": [{"metadata": {"test_unique_id": "test.elementary_tutorial.elementary_dimension_anomalies_orders_status.a5036d4371", "elementary_unique_id": "test.elementary_tutorial.elementary_dimension_anomalies_orders_status.a5036d4371", "database_name": "elementary_demo", "schema_name": "public", "table_name": "orders", "column_name": null, "test_name": "dimension_anomalies", "test_display_name": "Dimension Anomalies", "original_path": "models/schema.yml", "latest_run_time": "2024-08-19T09:28:26+08:00", "latest_run_time_utc": "2024-08-19T01:28:26+00:00", "latest_run_status": "pass", "model_unique_id": "model.elementary_tutorial.orders", "table_unique_id": "elementary_demo.public.orders", "test_type": "anomaly_detection", "test_sub_type": "generic", "test_query": "select * from (with anomaly_scores as (\n        select\n            id,\n            metric_id,\n            test_execution_id,\n            test_unique_id,\n            detected_at,\n            full_table_name,\n            column_name,\n            metric_name,\n            anomaly_score,\n            anomaly_score_threshold,\n            anomalous_value,\n            bucket_start,\n            bucket_end,\n            bucket_seasonality,\n            metric_value,\n            min_metric_value,\n            max_metric_value,\n            training_avg,\n            training_stddev,\n            training_set_size,\n            training_start,\n            training_end,\n            dimension,\n            dimension_value,\n            \n    case\n        when dimension is not null and column_name is null then \n    'The last ' || metric_name || ' value for dimension ' || dimension || ' - ' ||\n    case when dimension_value is null then 'NULL' else dimension_value end || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when dimension is not null and column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value for dimension ' || dimension || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when metric_name = 'freshness' then \n    'Last update was at ' || anomalous_value || ', ' || cast(abs(round(cast(metric_value/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours ago. Usually the table is updated within ' || cast(abs(round(cast(training_avg/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours.'\n\n        when column_name is null then \n    'The last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        else null\n    end as anomaly_description\n,\n            max(bucket_end) over (partition by test_execution_id) as max_bucket_end\n        from \"elementary_demo\".\"public\".\"test_a5036d4371_eleme__anomaly_scores__tmp_20240819012824913908\"\n      ),\n      anomaly_scores_with_is_anomalous as (\n        select\n          *,\ncase when\n          (\n            \n  (anomaly_score is not null and\n  (\n    \n  (\n    metric_value = 0 and \n    \n      1 = 2\n    \n  )\n or\n    (\n      case when metric_name IN \n        ( 'freshness' ,  'event_freshness'  )\n then\n            anomaly_score > 3\n    else\n        \n        abs(anomaly_score) > 3\n    \n\n     end and\n      (\n  \n  \n  \n  \n    \n        (1 = 1)\n    \n\n    and\n\n    \n        (1 = 1)\n    \n  \n  )\n    )\n  ))\n\n          )\n          and bucket_end >= \n    cast(max_bucket_end as timestamp) + cast('-2' as integer) * INTERVAL '1 day'\n\n          then TRUE else FALSE end as is_anomalous\n        from anomaly_scores\n      ),\n\n      final_results as (\n          select\n          metric_value as value,\n          training_avg as average,\n          \n          case\n          when is_anomalous = TRUE and 'both' = 'spike' then\n          lag(metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when is_anomalous = TRUE and 'both' != 'spike' then\n          lag(min_metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when 'both' = 'spike' then metric_value\n          else min_metric_value end as min_value,\n          case\n          when is_anomalous = TRUE and 'both' = 'drop' then\n          lag(metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when is_anomalous = TRUE and 'both' != 'drop' then\n          lag(max_metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when 'both' = 'drop' then metric_value\n          else max_metric_value end as max_value,\n          bucket_start as start_time,\n          bucket_end as end_time,\n          *\n        from anomaly_scores_with_is_anomalous\n        order by bucket_end, dimension_value\n      )\n\n      select * from final_results\n      where 1 = 1) results\n    where is_anomalous = true", "test_params": {"dimensions": ["status"], "model": "{{ get_where_subquery(ref('orders')) }}"}, "test_created_at": null, "description": "Monitors the frequency of values in the configured dimensions over time.", "result": {"result_description": null, "result_query": "select * from (with anomaly_scores as (\n        select\n            id,\n            metric_id,\n            test_execution_id,\n            test_unique_id,\n            detected_at,\n            full_table_name,\n            column_name,\n            metric_name,\n            anomaly_score,\n            anomaly_score_threshold,\n            anomalous_value,\n            bucket_start,\n            bucket_end,\n            bucket_seasonality,\n            metric_value,\n            min_metric_value,\n            max_metric_value,\n            training_avg,\n            training_stddev,\n            training_set_size,\n            training_start,\n            training_end,\n            dimension,\n            dimension_value,\n            \n    case\n        when dimension is not null and column_name is null then \n    'The last ' || metric_name || ' value for dimension ' || dimension || ' - ' ||\n    case when dimension_value is null then 'NULL' else dimension_value end || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when dimension is not null and column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value for dimension ' || dimension || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when metric_name = 'freshness' then \n    'Last update was at ' || anomalous_value || ', ' || cast(abs(round(cast(metric_value/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours ago. Usually the table is updated within ' || cast(abs(round(cast(training_avg/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours.'\n\n        when column_name is null then \n    'The last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        else null\n    end as anomaly_description\n,\n            max(bucket_end) over (partition by test_execution_id) as max_bucket_end\n        from \"elementary_demo\".\"public\".\"test_a5036d4371_eleme__anomaly_scores__tmp_20240819012824913908\"\n      ),\n      anomaly_scores_with_is_anomalous as (\n        select\n          *,\ncase when\n          (\n            \n  (anomaly_score is not null and\n  (\n    \n  (\n    metric_value = 0 and \n    \n      1 = 2\n    \n  )\n or\n    (\n      case when metric_name IN \n        ( 'freshness' ,  'event_freshness'  )\n then\n            anomaly_score > 3\n    else\n        \n        abs(anomaly_score) > 3\n    \n\n     end and\n      (\n  \n  \n  \n  \n    \n        (1 = 1)\n    \n\n    and\n\n    \n        (1 = 1)\n    \n  \n  )\n    )\n  ))\n\n          )\n          and bucket_end >= \n    cast(max_bucket_end as timestamp) + cast('-2' as integer) * INTERVAL '1 day'\n\n          then TRUE else FALSE end as is_anomalous\n        from anomaly_scores\n      ),\n\n      final_results as (\n          select\n          metric_value as value,\n          training_avg as average,\n          \n          case\n          when is_anomalous = TRUE and 'both' = 'spike' then\n          lag(metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when is_anomalous = TRUE and 'both' != 'spike' then\n          lag(min_metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when 'both' = 'spike' then metric_value\n          else min_metric_value end as min_value,\n          case\n          when is_anomalous = TRUE and 'both' = 'drop' then\n          lag(metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when is_anomalous = TRUE and 'both' != 'drop' then\n          lag(max_metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when 'both' = 'drop' then metric_value\n          else max_metric_value end as max_value,\n          bucket_start as start_time,\n          bucket_end as end_time,\n          *\n        from anomaly_scores_with_is_anomalous\n        order by bucket_end, dimension_value\n      )\n\n      select * from final_results\n      where 1 = 1) results\n    where is_anomalous = true"}, "configuration": {"test_name": "dimension_anomalies", "timestamp_column": null, "testing_timeframe": "1 day", "anomaly_threshold": null}, "test_tags": ["elementary-tests"], "normalized_full_path": "elementary_tutorial/models/schema.yml"}, "test_runs": {"fail_rate": 0.25, "totals": {"errors": 1, "warnings": 0, "passed": 3, "failures": 0}, "invocations": [{"affected_rows": null, "time_utc": "2024-08-18T03:49:49+00:00", "id": "563b9e97-5eee-4b1f-b4c4-34b0549d51be", "status": "error", "execution_time": null}, {"affected_rows": null, "time_utc": "2024-08-18T03:51:13+00:00", "id": "20ee100f-662e-401a-b32f-d932912ea4c0", "status": "pass", "execution_time": null}, {"affected_rows": null, "time_utc": "2024-08-18T08:21:30+00:00", "id": "ca67f4f7-7982-477f-83c1-5297dd78bbe9", "status": "pass", "execution_time": null}, {"affected_rows": null, "time_utc": "2024-08-19T01:28:26+00:00", "id": "e97da402-d3d2-4204-a365-a99740471e0e", "status": "pass", "execution_time": null}], "description": "There were no failures, 1 errors and no warnings on the last 4 test runs."}, "median_exec_time": 0.0, "last_exec_time": null}], "model.elementary_tutorial.test4schema": [{"metadata": {"test_unique_id": "test.elementary_tutorial.elementary_schema_changes_test4schema_.5b49e3c366", "elementary_unique_id": "test.elementary_tutorial.elementary_schema_changes_test4schema_.5b49e3c366", "database_name": "elementary_demo", "schema_name": "public", "table_name": "test4schema", "column_name": null, "test_name": "schema_changes", "test_display_name": "Schema Changes", "original_path": "models/schema.yml", "latest_run_time": "2024-08-19T09:28:26+08:00", "latest_run_time_utc": "2024-08-19T01:28:26+00:00", "latest_run_status": "pass", "model_unique_id": "model.elementary_tutorial.test4schema", "table_unique_id": "elementary_demo.public.test4schema", "test_type": "schema_change", "test_sub_type": "generic", "test_query": "select * from \"elementary_demo\".\"public\".\"test_5b49e3c36__schema_changes_alerts__tmp_20240819012825218126\"", "test_params": {"model": "{{ get_where_subquery(ref('test4schema')) }}"}, "test_created_at": null, "description": "Monitors schema changes on the table of deleted, added, type changed columns over time. The test will fail if the table's schema changed from the previous execution of the test.", "result": {"result_description": null, "result_query": "select * from \"elementary_demo\".\"public\".\"test_5b49e3c36__schema_changes_alerts__tmp_20240819012825218126\""}, "configuration": {"test_name": "schema_changes", "timestamp_column": null, "testing_timeframe": "1 day", "anomaly_threshold": null}, "test_tags": ["elementary", "elementary-tests"], "normalized_full_path": "elementary_tutorial/models/schema.yml"}, "test_runs": {"fail_rate": 0.25, "totals": {"errors": 1, "warnings": 1, "passed": 2, "failures": 0}, "invocations": [{"affected_rows": null, "time_utc": "2024-08-18T03:49:49+00:00", "id": "563b9e97-5eee-4b1f-b4c4-34b0549d51be", "status": "error", "execution_time": null}, {"affected_rows": null, "time_utc": "2024-08-18T03:51:13+00:00", "id": "20ee100f-662e-401a-b32f-d932912ea4c0", "status": "pass", "execution_time": null}, {"affected_rows": null, "time_utc": "2024-08-18T08:21:28+00:00", "id": "ca67f4f7-7982-477f-83c1-5297dd78bbe9", "status": "warn", "execution_time": null}, {"affected_rows": null, "time_utc": "2024-08-19T01:28:26+00:00", "id": "e97da402-d3d2-4204-a365-a99740471e0e", "status": "pass", "execution_time": null}], "description": "There were no failures, 1 errors and 1 warnings on the last 4 test runs."}, "median_exec_time": 0.0, "last_exec_time": null}], "model.elementary_tutorial.test4_column_anomaly": [{"metadata": {"test_unique_id": "test.elementary_tutorial.elementary_column_anomalies_test4_column_anomaly_1__null_count__name.5c88e6fb20", "elementary_unique_id": "test.elementary_tutorial.elementary_column_anomalies_test4_column_anomaly_1__null_count__name.5c88e6fb20.name.generic", "database_name": "elementary_demo", "schema_name": "public", "table_name": "test4_column_anomaly", "column_name": "name", "test_name": "column_anomalies", "test_display_name": "Column Anomalies", "original_path": "models/schema.yml", "latest_run_time": "2024-08-19T09:28:26+08:00", "latest_run_time_utc": "2024-08-19T01:28:26+00:00", "latest_run_status": "pass", "model_unique_id": "model.elementary_tutorial.test4_column_anomaly", "table_unique_id": "elementary_demo.public.test4_column_anomaly", "test_type": "anomaly_detection", "test_sub_type": "generic", "test_query": "select * from (with anomaly_scores as (\n        select\n            id,\n            metric_id,\n            test_execution_id,\n            test_unique_id,\n            detected_at,\n            full_table_name,\n            column_name,\n            metric_name,\n            anomaly_score,\n            anomaly_score_threshold,\n            anomalous_value,\n            bucket_start,\n            bucket_end,\n            bucket_seasonality,\n            metric_value,\n            min_metric_value,\n            max_metric_value,\n            training_avg,\n            training_stddev,\n            training_set_size,\n            training_start,\n            training_end,\n            dimension,\n            dimension_value,\n            \n    case\n        when dimension is not null and column_name is null then \n    'The last ' || metric_name || ' value for dimension ' || dimension || ' - ' ||\n    case when dimension_value is null then 'NULL' else dimension_value end || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when dimension is not null and column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value for dimension ' || dimension || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when metric_name = 'freshness' then \n    'Last update was at ' || anomalous_value || ', ' || cast(abs(round(cast(metric_value/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours ago. Usually the table is updated within ' || cast(abs(round(cast(training_avg/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours.'\n\n        when column_name is null then \n    'The last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        else null\n    end as anomaly_description\n,\n            max(bucket_end) over (partition by test_execution_id) as max_bucket_end\n        from \"elementary_demo\".\"public\".\"test_5c88e6fb20_eleme__anomaly_scores__tmp_20240819012824424360\"\n      ),\n      anomaly_scores_with_is_anomalous as (\n        select\n          *,\ncase when\n          (\n            \n  (anomaly_score is not null and\n  (\n    \n  (\n    metric_value = 0 and \n    \n      1 = 2\n    \n  )\n or\n    (\n      case when metric_name IN \n        ( 'freshness' ,  'event_freshness'  )\n then\n            anomaly_score > 1\n    else\n        \n        abs(anomaly_score) > 1\n    \n\n     end and\n      (\n  \n  \n  \n  \n    \n        (1 = 1)\n    \n\n    and\n\n    \n        (1 = 1)\n    \n  \n  )\n    )\n  ))\n\n          )\n          and bucket_end >= \n    cast(max_bucket_end as timestamp) + cast('-2' as integer) * INTERVAL '1 day'\n\n          then TRUE else FALSE end as is_anomalous\n        from anomaly_scores\n      ),\n\n      final_results as (\n          select\n          metric_value as value,\n          training_avg as average,\n          \n          case\n          when is_anomalous = TRUE and 'both' = 'spike' then\n          lag(metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when is_anomalous = TRUE and 'both' != 'spike' then\n          lag(min_metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when 'both' = 'spike' then metric_value\n          else min_metric_value end as min_value,\n          case\n          when is_anomalous = TRUE and 'both' = 'drop' then\n          lag(metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when is_anomalous = TRUE and 'both' != 'drop' then\n          lag(max_metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when 'both' = 'drop' then metric_value\n          else max_metric_value end as max_value,\n          bucket_start as start_time,\n          bucket_end as end_time,\n          *\n        from anomaly_scores_with_is_anomalous\n        order by bucket_end, dimension_value\n      )\n\n      select * from final_results\n      where 1 = 1) results\n    where is_anomalous = true", "test_params": {"column_anomalies": ["null_count"], "anomaly_sensitivity": 1, "column_name": "name", "model": "{{ get_where_subquery(ref('test4_column_anomaly')) }}"}, "test_created_at": null, "description": "Column-level anomaly monitors (null_count, null_percent, zero_count, string_length, variance, etc.) on the column according to its data type.", "result": {"result_description": null, "result_query": "select * from (with anomaly_scores as (\n        select\n            id,\n            metric_id,\n            test_execution_id,\n            test_unique_id,\n            detected_at,\n            full_table_name,\n            column_name,\n            metric_name,\n            anomaly_score,\n            anomaly_score_threshold,\n            anomalous_value,\n            bucket_start,\n            bucket_end,\n            bucket_seasonality,\n            metric_value,\n            min_metric_value,\n            max_metric_value,\n            training_avg,\n            training_stddev,\n            training_set_size,\n            training_start,\n            training_end,\n            dimension,\n            dimension_value,\n            \n    case\n        when dimension is not null and column_name is null then \n    'The last ' || metric_name || ' value for dimension ' || dimension || ' - ' ||\n    case when dimension_value is null then 'NULL' else dimension_value end || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when dimension is not null and column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value for dimension ' || dimension || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when metric_name = 'freshness' then \n    'Last update was at ' || anomalous_value || ', ' || cast(abs(round(cast(metric_value/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours ago. Usually the table is updated within ' || cast(abs(round(cast(training_avg/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours.'\n\n        when column_name is null then \n    'The last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        else null\n    end as anomaly_description\n,\n            max(bucket_end) over (partition by test_execution_id) as max_bucket_end\n        from \"elementary_demo\".\"public\".\"test_5c88e6fb20_eleme__anomaly_scores__tmp_20240819012824424360\"\n      ),\n      anomaly_scores_with_is_anomalous as (\n        select\n          *,\ncase when\n          (\n            \n  (anomaly_score is not null and\n  (\n    \n  (\n    metric_value = 0 and \n    \n      1 = 2\n    \n  )\n or\n    (\n      case when metric_name IN \n        ( 'freshness' ,  'event_freshness'  )\n then\n            anomaly_score > 1\n    else\n        \n        abs(anomaly_score) > 1\n    \n\n     end and\n      (\n  \n  \n  \n  \n    \n        (1 = 1)\n    \n\n    and\n\n    \n        (1 = 1)\n    \n  \n  )\n    )\n  ))\n\n          )\n          and bucket_end >= \n    cast(max_bucket_end as timestamp) + cast('-2' as integer) * INTERVAL '1 day'\n\n          then TRUE else FALSE end as is_anomalous\n        from anomaly_scores\n      ),\n\n      final_results as (\n          select\n          metric_value as value,\n          training_avg as average,\n          \n          case\n          when is_anomalous = TRUE and 'both' = 'spike' then\n          lag(metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when is_anomalous = TRUE and 'both' != 'spike' then\n          lag(min_metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when 'both' = 'spike' then metric_value\n          else min_metric_value end as min_value,\n          case\n          when is_anomalous = TRUE and 'both' = 'drop' then\n          lag(metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when is_anomalous = TRUE and 'both' != 'drop' then\n          lag(max_metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when 'both' = 'drop' then metric_value\n          else max_metric_value end as max_value,\n          bucket_start as start_time,\n          bucket_end as end_time,\n          *\n        from anomaly_scores_with_is_anomalous\n        order by bucket_end, dimension_value\n      )\n\n      select * from final_results\n      where 1 = 1) results\n    where is_anomalous = true"}, "configuration": {"test_name": "column_anomalies", "timestamp_column": null, "testing_timeframe": "1 day", "anomaly_threshold": 1}, "test_tags": ["column_anomalies", "elementary-tests"], "normalized_full_path": "elementary_tutorial/models/schema.yml"}, "test_runs": {"fail_rate": 0.25, "totals": {"errors": 1, "warnings": 0, "passed": 3, "failures": 0}, "invocations": [{"affected_rows": null, "time_utc": "2024-08-18T03:49:49+00:00", "id": "563b9e97-5eee-4b1f-b4c4-34b0549d51be", "status": "error", "execution_time": null}, {"affected_rows": null, "time_utc": "2024-08-18T03:51:13+00:00", "id": "20ee100f-662e-401a-b32f-d932912ea4c0", "status": "pass", "execution_time": null}, {"affected_rows": null, "time_utc": "2024-08-18T08:21:30+00:00", "id": "ca67f4f7-7982-477f-83c1-5297dd78bbe9", "status": "pass", "execution_time": null}, {"affected_rows": null, "time_utc": "2024-08-19T01:28:26+00:00", "id": "e97da402-d3d2-4204-a365-a99740471e0e", "status": "pass", "execution_time": null}], "description": "There were no failures, 1 errors and no warnings on the last 4 test runs."}, "median_exec_time": 0.0, "last_exec_time": null}, {"metadata": {"test_unique_id": "test.elementary_tutorial.elementary_column_anomalies_test4_column_anomaly_1__zero_count__max__age.21be7f55a1", "elementary_unique_id": "test.elementary_tutorial.elementary_column_anomalies_test4_column_anomaly_1__zero_count__max__age.21be7f55a1.age.generic", "database_name": "elementary_demo", "schema_name": "public", "table_name": "test4_column_anomaly", "column_name": "age", "test_name": "column_anomalies", "test_display_name": "Column Anomalies", "original_path": "models/schema.yml", "latest_run_time": "2024-08-19T09:28:26+08:00", "latest_run_time_utc": "2024-08-19T01:28:26+00:00", "latest_run_status": "pass", "model_unique_id": "model.elementary_tutorial.test4_column_anomaly", "table_unique_id": "elementary_demo.public.test4_column_anomaly", "test_type": "anomaly_detection", "test_sub_type": "generic", "test_query": "select * from (with anomaly_scores as (\n        select\n            id,\n            metric_id,\n            test_execution_id,\n            test_unique_id,\n            detected_at,\n            full_table_name,\n            column_name,\n            metric_name,\n            anomaly_score,\n            anomaly_score_threshold,\n            anomalous_value,\n            bucket_start,\n            bucket_end,\n            bucket_seasonality,\n            metric_value,\n            min_metric_value,\n            max_metric_value,\n            training_avg,\n            training_stddev,\n            training_set_size,\n            training_start,\n            training_end,\n            dimension,\n            dimension_value,\n            \n    case\n        when dimension is not null and column_name is null then \n    'The last ' || metric_name || ' value for dimension ' || dimension || ' - ' ||\n    case when dimension_value is null then 'NULL' else dimension_value end || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when dimension is not null and column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value for dimension ' || dimension || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when metric_name = 'freshness' then \n    'Last update was at ' || anomalous_value || ', ' || cast(abs(round(cast(metric_value/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours ago. Usually the table is updated within ' || cast(abs(round(cast(training_avg/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours.'\n\n        when column_name is null then \n    'The last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        else null\n    end as anomaly_description\n,\n            max(bucket_end) over (partition by test_execution_id) as max_bucket_end\n        from \"elementary_demo\".\"public\".\"test_21be7f55a1_eleme__anomaly_scores__tmp_20240819012824655440\"\n      ),\n      anomaly_scores_with_is_anomalous as (\n        select\n          *,\ncase when\n          (\n            \n  (anomaly_score is not null and\n  (\n    \n  (\n    metric_value = 0 and \n    \n      1 = 2\n    \n  )\n or\n    (\n      case when metric_name IN \n        ( 'freshness' ,  'event_freshness'  )\n then\n            anomaly_score > 1\n    else\n        \n        abs(anomaly_score) > 1\n    \n\n     end and\n      (\n  \n  \n  \n  \n    \n        (1 = 1)\n    \n\n    and\n\n    \n        (1 = 1)\n    \n  \n  )\n    )\n  ))\n\n          )\n          and bucket_end >= \n    cast(max_bucket_end as timestamp) + cast('-2' as integer) * INTERVAL '1 day'\n\n          then TRUE else FALSE end as is_anomalous\n        from anomaly_scores\n      ),\n\n      final_results as (\n          select\n          metric_value as value,\n          training_avg as average,\n          \n          case\n          when is_anomalous = TRUE and 'both' = 'spike' then\n          lag(metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when is_anomalous = TRUE and 'both' != 'spike' then\n          lag(min_metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when 'both' = 'spike' then metric_value\n          else min_metric_value end as min_value,\n          case\n          when is_anomalous = TRUE and 'both' = 'drop' then\n          lag(metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when is_anomalous = TRUE and 'both' != 'drop' then\n          lag(max_metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when 'both' = 'drop' then metric_value\n          else max_metric_value end as max_value,\n          bucket_start as start_time,\n          bucket_end as end_time,\n          *\n        from anomaly_scores_with_is_anomalous\n        order by bucket_end, dimension_value\n      )\n\n      select * from final_results\n      where 1 = 1) results\n    where is_anomalous = true", "test_params": {"column_anomalies": ["zero_count", "max"], "anomaly_sensitivity": 1, "column_name": "age", "model": "{{ get_where_subquery(ref('test4_column_anomaly')) }}"}, "test_created_at": null, "description": "Column-level anomaly monitors (null_count, null_percent, zero_count, string_length, variance, etc.) on the column according to its data type.", "result": {"result_description": null, "result_query": "select * from (with anomaly_scores as (\n        select\n            id,\n            metric_id,\n            test_execution_id,\n            test_unique_id,\n            detected_at,\n            full_table_name,\n            column_name,\n            metric_name,\n            anomaly_score,\n            anomaly_score_threshold,\n            anomalous_value,\n            bucket_start,\n            bucket_end,\n            bucket_seasonality,\n            metric_value,\n            min_metric_value,\n            max_metric_value,\n            training_avg,\n            training_stddev,\n            training_set_size,\n            training_start,\n            training_end,\n            dimension,\n            dimension_value,\n            \n    case\n        when dimension is not null and column_name is null then \n    'The last ' || metric_name || ' value for dimension ' || dimension || ' - ' ||\n    case when dimension_value is null then 'NULL' else dimension_value end || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when dimension is not null and column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value for dimension ' || dimension || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when metric_name = 'freshness' then \n    'Last update was at ' || anomalous_value || ', ' || cast(abs(round(cast(metric_value/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours ago. Usually the table is updated within ' || cast(abs(round(cast(training_avg/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours.'\n\n        when column_name is null then \n    'The last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        else null\n    end as anomaly_description\n,\n            max(bucket_end) over (partition by test_execution_id) as max_bucket_end\n        from \"elementary_demo\".\"public\".\"test_21be7f55a1_eleme__anomaly_scores__tmp_20240819012824655440\"\n      ),\n      anomaly_scores_with_is_anomalous as (\n        select\n          *,\ncase when\n          (\n            \n  (anomaly_score is not null and\n  (\n    \n  (\n    metric_value = 0 and \n    \n      1 = 2\n    \n  )\n or\n    (\n      case when metric_name IN \n        ( 'freshness' ,  'event_freshness'  )\n then\n            anomaly_score > 1\n    else\n        \n        abs(anomaly_score) > 1\n    \n\n     end and\n      (\n  \n  \n  \n  \n    \n        (1 = 1)\n    \n\n    and\n\n    \n        (1 = 1)\n    \n  \n  )\n    )\n  ))\n\n          )\n          and bucket_end >= \n    cast(max_bucket_end as timestamp) + cast('-2' as integer) * INTERVAL '1 day'\n\n          then TRUE else FALSE end as is_anomalous\n        from anomaly_scores\n      ),\n\n      final_results as (\n          select\n          metric_value as value,\n          training_avg as average,\n          \n          case\n          when is_anomalous = TRUE and 'both' = 'spike' then\n          lag(metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when is_anomalous = TRUE and 'both' != 'spike' then\n          lag(min_metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when 'both' = 'spike' then metric_value\n          else min_metric_value end as min_value,\n          case\n          when is_anomalous = TRUE and 'both' = 'drop' then\n          lag(metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when is_anomalous = TRUE and 'both' != 'drop' then\n          lag(max_metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when 'both' = 'drop' then metric_value\n          else max_metric_value end as max_value,\n          bucket_start as start_time,\n          bucket_end as end_time,\n          *\n        from anomaly_scores_with_is_anomalous\n        order by bucket_end, dimension_value\n      )\n\n      select * from final_results\n      where 1 = 1) results\n    where is_anomalous = true"}, "configuration": {"test_name": "column_anomalies", "timestamp_column": null, "testing_timeframe": "1 day", "anomaly_threshold": 1}, "test_tags": ["column_test", "elementary-tests"], "normalized_full_path": "elementary_tutorial/models/schema.yml"}, "test_runs": {"fail_rate": 0.25, "totals": {"errors": 1, "warnings": 0, "passed": 3, "failures": 0}, "invocations": [{"affected_rows": null, "time_utc": "2024-08-18T03:49:49+00:00", "id": "563b9e97-5eee-4b1f-b4c4-34b0549d51be", "status": "error", "execution_time": null}, {"affected_rows": null, "time_utc": "2024-08-18T03:51:13+00:00", "id": "20ee100f-662e-401a-b32f-d932912ea4c0", "status": "pass", "execution_time": null}, {"affected_rows": null, "time_utc": "2024-08-18T08:21:30+00:00", "id": "ca67f4f7-7982-477f-83c1-5297dd78bbe9", "status": "pass", "execution_time": null}, {"affected_rows": null, "time_utc": "2024-08-19T01:28:26+00:00", "id": "e97da402-d3d2-4204-a365-a99740471e0e", "status": "pass", "execution_time": null}], "description": "There were no failures, 1 errors and no warnings on the last 4 test runs."}, "median_exec_time": 0.0, "last_exec_time": null}], "model.elementary_tutorial.test4_volume_anomaly": [{"metadata": {"test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_test4_volume_anomaly_1.22dd1cb7dd", "elementary_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_test4_volume_anomaly_1.22dd1cb7dd.None.generic", "database_name": "elementary_demo", "schema_name": "public", "table_name": "test4_volume_anomaly", "column_name": null, "test_name": "volume_anomalies", "test_display_name": "Volume Anomalies", "original_path": "models/schema.yml", "latest_run_time": "2024-08-18T11:49:49+08:00", "latest_run_time_utc": "2024-08-18T03:49:49+00:00", "latest_run_status": "error", "model_unique_id": "model.elementary_tutorial.test4_volume_anomaly", "table_unique_id": "elementary_demo.public.test4_volume_anomaly", "test_type": "anomaly_detection", "test_sub_type": "generic", "test_query": null, "test_params": {"anomaly_sensitivity": 1, "model": "{{ get_where_subquery(ref('test4_volume_anomaly')) }}"}, "test_created_at": null, "description": "Monitors the row count of your table over time.", "result": {"result_description": "Database Error in test elementary_volume_anomalies_test4_volume_anomaly_1 (models/schema.yml)\n  relation \"public.test4_volume_anomaly\" does not exist\n  LINE 20:         from \"elementary_demo\".\"public\".\"test4_volume_anomal...\n                        ^", "result_query": null}, "configuration": {"test_name": "volume_anomalies", "timestamp_column": null, "testing_timeframe": "1 day", "anomaly_threshold": 1}, "test_tags": ["column_test", "elementary-tests"], "normalized_full_path": "elementary_tutorial/models/schema.yml"}, "test_runs": {"fail_rate": 1.0, "totals": {"errors": 1, "warnings": 0, "passed": 0, "failures": 0}, "invocations": [{"affected_rows": null, "time_utc": "2024-08-18T03:49:49+00:00", "id": "563b9e97-5eee-4b1f-b4c4-34b0549d51be", "status": "error", "execution_time": null}], "description": "There were no failures, 1 errors and no warnings on the last 1 test runs."}, "median_exec_time": 0.0, "last_exec_time": null}, {"metadata": {"test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_test4_volume_anomaly_1.22dd1cb7dd", "elementary_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_test4_volume_anomaly_1.22dd1cb7dd.None.row_count", "database_name": "elementary_demo", "schema_name": "public", "table_name": "test4_volume_anomaly", "column_name": null, "test_name": "volume_anomalies", "test_display_name": "Volume Anomalies", "original_path": "models/schema.yml", "latest_run_time": "2024-08-19T09:28:26+08:00", "latest_run_time_utc": "2024-08-19T01:28:26+00:00", "latest_run_status": "pass", "model_unique_id": "model.elementary_tutorial.test4_volume_anomaly", "table_unique_id": "elementary_demo.public.test4_volume_anomaly", "test_type": "anomaly_detection", "test_sub_type": "row_count", "test_query": "select * from (None) results\n      where\n        anomaly_score is not null and\n        upper(full_table_name) = upper(cast('ELEMENTARY_DEMO.PUBLIC.TEST4_VOLUME_ANOMALY' as varchar(4096))) and\n        metric_name = cast('row_count' as varchar(4096))", "test_params": {"anomaly_sensitivity": 1, "model": "{{ get_where_subquery(ref('test4_volume_anomaly')) }}", "timestamp_column": "birth", "where_expression": null, "anomaly_direction": "both", "time_bucket": {"period": "day", "count": 1}, "days_back": 14, "backfill_days": 2, "seasonality": null, "freshness_column": null, "event_timestamp_column": null, "dimensions": null, "ignore_small_changes": {"spike_failure_percent_threshold": null, "drop_failure_percent_threshold": null}, "fail_on_zero": false, "detection_delay": {"period": "hour", "count": 0}, "anomaly_exclude_metrics": null, "exclude_final_results": "1 = 1"}, "test_created_at": null, "description": "Monitors the row count of your table over time.", "result": {"result_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "result_query": "select * from (None) results\n      where\n        anomaly_score is not null and\n        upper(full_table_name) = upper(cast('ELEMENTARY_DEMO.PUBLIC.TEST4_VOLUME_ANOMALY' as varchar(4096))) and\n        metric_name = cast('row_count' as varchar(4096))"}, "configuration": {"test_name": "volume_anomalies", "timestamp_column": "birth", "testing_timeframe": "1 day", "anomaly_threshold": 1}, "test_tags": ["column_test", "elementary-tests"], "normalized_full_path": "elementary_tutorial/models/schema.yml"}, "test_runs": {"fail_rate": 0.0, "totals": {"errors": 0, "warnings": 0, "passed": 3, "failures": 0}, "invocations": [{"affected_rows": null, "time_utc": "2024-08-18T03:51:12+00:00", "id": "20ee100f-662e-401a-b32f-d932912ea4c0", "status": "pass", "execution_time": null}, {"affected_rows": null, "time_utc": "2024-08-18T08:21:29+00:00", "id": "ca67f4f7-7982-477f-83c1-5297dd78bbe9", "status": "pass", "execution_time": null}, {"affected_rows": null, "time_utc": "2024-08-19T01:28:26+00:00", "id": "e97da402-d3d2-4204-a365-a99740471e0e", "status": "pass", "execution_time": null}], "description": "There were no failures, no errors and no warnings on the last 3 test runs."}, "median_exec_time": 0.0, "last_exec_time": null}], "model.elementary_tutorial.returned_orders": [{"metadata": {"test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "elementary_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e.None.generic", "database_name": "elementary_demo", "schema_name": "public", "table_name": "returned_orders", "column_name": null, "test_name": "volume_anomalies", "test_display_name": "Volume Anomalies", "original_path": "models/schema.yml", "latest_run_time": "2024-08-18T11:49:49+08:00", "latest_run_time_utc": "2024-08-18T03:49:49+00:00", "latest_run_status": "error", "model_unique_id": "model.elementary_tutorial.returned_orders", "table_unique_id": "elementary_demo.public.returned_orders", "test_type": "anomaly_detection", "test_sub_type": "generic", "test_query": null, "test_params": {"timestamp_column": "order_date", "model": "{{ get_where_subquery(ref('returned_orders')) }}"}, "test_created_at": null, "description": "Monitors the row count of your table over time.", "result": {"result_description": "Database Error in test elementary_volume_anomalies_returned_orders_order_date (models/schema.yml)\n  relation \"public.returned_orders\" does not exist\n  LINE 20:         from \"elementary_demo\".\"public\".\"returned_orders\"\n                        ^", "result_query": null}, "configuration": {"test_name": "volume_anomalies", "timestamp_column": "order_date", "testing_timeframe": "1 day", "anomaly_threshold": null}, "test_tags": ["elementary-tests", "table_anomalies"], "normalized_full_path": "elementary_tutorial/models/schema.yml"}, "test_runs": {"fail_rate": 1.0, "totals": {"errors": 1, "warnings": 0, "passed": 0, "failures": 0}, "invocations": [{"affected_rows": null, "time_utc": "2024-08-18T03:49:49+00:00", "id": "563b9e97-5eee-4b1f-b4c4-34b0549d51be", "status": "error", "execution_time": null}], "description": "There were no failures, 1 errors and no warnings on the last 1 test runs."}, "median_exec_time": 0.0, "last_exec_time": null}, {"metadata": {"test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e", "elementary_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_returned_orders_order_date.150e06ec8e.None.row_count", "database_name": "elementary_demo", "schema_name": "public", "table_name": "returned_orders", "column_name": null, "test_name": "volume_anomalies", "test_display_name": "Volume Anomalies", "original_path": "models/schema.yml", "latest_run_time": "2024-08-19T09:28:25+08:00", "latest_run_time_utc": "2024-08-19T01:28:25+00:00", "latest_run_status": "pass", "model_unique_id": "model.elementary_tutorial.returned_orders", "table_unique_id": "elementary_demo.public.returned_orders", "test_type": "anomaly_detection", "test_sub_type": "row_count", "test_query": "select * from (None) results\n      where\n        anomaly_score is not null and\n        upper(full_table_name) = upper(cast('ELEMENTARY_DEMO.PUBLIC.RETURNED_ORDERS' as varchar(4096))) and\n        metric_name = cast('row_count' as varchar(4096))", "test_params": {"timestamp_column": "order_date", "model": "{{ get_where_subquery(ref('returned_orders')) }}", "where_expression": null, "anomaly_sensitivity": 3, "anomaly_direction": "both", "time_bucket": {"period": "day", "count": 1}, "days_back": 14, "backfill_days": 2, "seasonality": null, "freshness_column": null, "event_timestamp_column": null, "dimensions": null, "ignore_small_changes": {"spike_failure_percent_threshold": null, "drop_failure_percent_threshold": null}, "fail_on_zero": false, "detection_delay": {"period": "hour", "count": 0}, "anomaly_exclude_metrics": null, "exclude_final_results": "1 = 1"}, "test_created_at": null, "description": "Monitors the row count of your table over time.", "result": {"result_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "result_query": "select * from (None) results\n      where\n        anomaly_score is not null and\n        upper(full_table_name) = upper(cast('ELEMENTARY_DEMO.PUBLIC.RETURNED_ORDERS' as varchar(4096))) and\n        metric_name = cast('row_count' as varchar(4096))"}, "configuration": {"test_name": "volume_anomalies", "timestamp_column": "order_date", "testing_timeframe": "1 day", "anomaly_threshold": 3}, "test_tags": ["elementary-tests", "table_anomalies"], "normalized_full_path": "elementary_tutorial/models/schema.yml"}, "test_runs": {"fail_rate": 0.0, "totals": {"errors": 0, "warnings": 0, "passed": 3, "failures": 0}, "invocations": [{"affected_rows": null, "time_utc": "2024-08-18T03:51:12+00:00", "id": "20ee100f-662e-401a-b32f-d932912ea4c0", "status": "pass", "execution_time": null}, {"affected_rows": null, "time_utc": "2024-08-18T08:21:29+00:00", "id": "ca67f4f7-7982-477f-83c1-5297dd78bbe9", "status": "pass", "execution_time": null}, {"affected_rows": null, "time_utc": "2024-08-19T01:28:25+00:00", "id": "e97da402-d3d2-4204-a365-a99740471e0e", "status": "pass", "execution_time": null}], "description": "There were no failures, no errors and no warnings on the last 3 test runs."}, "median_exec_time": 0.0, "last_exec_time": null}], "model.elementary_tutorial.customers": [{"metadata": {"test_unique_id": "test.elementary_tutorial.elementary_column_anomalies_customers_zero_count__number_of_orders__signup_date.e012735381", "elementary_unique_id": "test.elementary_tutorial.elementary_column_anomalies_customers_zero_count__number_of_orders__signup_date.e012735381.number_of_orders.generic", "database_name": "elementary_demo", "schema_name": "public", "table_name": "customers", "column_name": "number_of_orders", "test_name": "column_anomalies", "test_display_name": "Column Anomalies", "original_path": "models/schema.yml", "latest_run_time": "2024-08-19T09:28:26+08:00", "latest_run_time_utc": "2024-08-19T01:28:26+00:00", "latest_run_status": "pass", "model_unique_id": "model.elementary_tutorial.customers", "table_unique_id": "elementary_demo.public.customers", "test_type": "anomaly_detection", "test_sub_type": "generic", "test_query": "select * from (with anomaly_scores as (\n        select\n            id,\n            metric_id,\n            test_execution_id,\n            test_unique_id,\n            detected_at,\n            full_table_name,\n            column_name,\n            metric_name,\n            anomaly_score,\n            anomaly_score_threshold,\n            anomalous_value,\n            bucket_start,\n            bucket_end,\n            bucket_seasonality,\n            metric_value,\n            min_metric_value,\n            max_metric_value,\n            training_avg,\n            training_stddev,\n            training_set_size,\n            training_start,\n            training_end,\n            dimension,\n            dimension_value,\n            \n    case\n        when dimension is not null and column_name is null then \n    'The last ' || metric_name || ' value for dimension ' || dimension || ' - ' ||\n    case when dimension_value is null then 'NULL' else dimension_value end || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when dimension is not null and column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value for dimension ' || dimension || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when metric_name = 'freshness' then \n    'Last update was at ' || anomalous_value || ', ' || cast(abs(round(cast(metric_value/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours ago. Usually the table is updated within ' || cast(abs(round(cast(training_avg/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours.'\n\n        when column_name is null then \n    'The last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        else null\n    end as anomaly_description\n,\n            max(bucket_end) over (partition by test_execution_id) as max_bucket_end\n        from \"elementary_demo\".\"public\".\"test_e012735381_eleme__anomaly_scores__tmp_20240819012823992585\"\n      ),\n      anomaly_scores_with_is_anomalous as (\n        select\n          *,\ncase when\n          (\n            \n  (anomaly_score is not null and\n  (\n    \n  (\n    metric_value = 0 and \n    \n      1 = 2\n    \n  )\n or\n    (\n      case when metric_name IN \n        ( 'freshness' ,  'event_freshness'  )\n then\n            anomaly_score > 3\n    else\n        \n        abs(anomaly_score) > 3\n    \n\n     end and\n      (\n  \n  \n  \n  \n    \n        (1 = 1)\n    \n\n    and\n\n    \n        (1 = 1)\n    \n  \n  )\n    )\n  ))\n\n          )\n          and bucket_end >= \n    cast(max_bucket_end as timestamp) + cast('-2' as integer) * INTERVAL '1 day'\n\n          then TRUE else FALSE end as is_anomalous\n        from anomaly_scores\n      ),\n\n      final_results as (\n          select\n          metric_value as value,\n          training_avg as average,\n          \n          case\n          when is_anomalous = TRUE and 'both' = 'spike' then\n          lag(metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when is_anomalous = TRUE and 'both' != 'spike' then\n          lag(min_metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when 'both' = 'spike' then metric_value\n          else min_metric_value end as min_value,\n          case\n          when is_anomalous = TRUE and 'both' = 'drop' then\n          lag(metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when is_anomalous = TRUE and 'both' != 'drop' then\n          lag(max_metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when 'both' = 'drop' then metric_value\n          else max_metric_value end as max_value,\n          bucket_start as start_time,\n          bucket_end as end_time,\n          *\n        from anomaly_scores_with_is_anomalous\n        order by bucket_end, dimension_value\n      )\n\n      select * from final_results\n      where 1 = 1) results\n    where is_anomalous = true", "test_params": {"column_anomalies": ["zero_count"], "timestamp_column": "signup_date", "column_name": "number_of_orders", "model": "{{ get_where_subquery(ref('customers')) }}"}, "test_created_at": null, "description": "Column-level anomaly monitors (null_count, null_percent, zero_count, string_length, variance, etc.) on the column according to its data type.", "result": {"result_description": null, "result_query": "select * from (with anomaly_scores as (\n        select\n            id,\n            metric_id,\n            test_execution_id,\n            test_unique_id,\n            detected_at,\n            full_table_name,\n            column_name,\n            metric_name,\n            anomaly_score,\n            anomaly_score_threshold,\n            anomalous_value,\n            bucket_start,\n            bucket_end,\n            bucket_seasonality,\n            metric_value,\n            min_metric_value,\n            max_metric_value,\n            training_avg,\n            training_stddev,\n            training_set_size,\n            training_start,\n            training_end,\n            dimension,\n            dimension_value,\n            \n    case\n        when dimension is not null and column_name is null then \n    'The last ' || metric_name || ' value for dimension ' || dimension || ' - ' ||\n    case when dimension_value is null then 'NULL' else dimension_value end || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when dimension is not null and column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value for dimension ' || dimension || ' is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when metric_name = 'freshness' then \n    'Last update was at ' || anomalous_value || ', ' || cast(abs(round(cast(metric_value/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours ago. Usually the table is updated within ' || cast(abs(round(cast(training_avg/3600 as numeric(28,6)), 2)) as varchar(4096)) || ' hours.'\n\n        when column_name is null then \n    'The last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        when column_name is not null then \n    'In column ' || column_name || ', the last ' || metric_name || ' value is ' || cast(round(cast(metric_value as numeric(28,6)), 3) as varchar(4096)) ||\n    '. The average for this metric is ' || cast(round(cast(training_avg as numeric(28,6)), 3) as varchar(4096)) || '.'\n\n        else null\n    end as anomaly_description\n,\n            max(bucket_end) over (partition by test_execution_id) as max_bucket_end\n        from \"elementary_demo\".\"public\".\"test_e012735381_eleme__anomaly_scores__tmp_20240819012823992585\"\n      ),\n      anomaly_scores_with_is_anomalous as (\n        select\n          *,\ncase when\n          (\n            \n  (anomaly_score is not null and\n  (\n    \n  (\n    metric_value = 0 and \n    \n      1 = 2\n    \n  )\n or\n    (\n      case when metric_name IN \n        ( 'freshness' ,  'event_freshness'  )\n then\n            anomaly_score > 3\n    else\n        \n        abs(anomaly_score) > 3\n    \n\n     end and\n      (\n  \n  \n  \n  \n    \n        (1 = 1)\n    \n\n    and\n\n    \n        (1 = 1)\n    \n  \n  )\n    )\n  ))\n\n          )\n          and bucket_end >= \n    cast(max_bucket_end as timestamp) + cast('-2' as integer) * INTERVAL '1 day'\n\n          then TRUE else FALSE end as is_anomalous\n        from anomaly_scores\n      ),\n\n      final_results as (\n          select\n          metric_value as value,\n          training_avg as average,\n          \n          case\n          when is_anomalous = TRUE and 'both' = 'spike' then\n          lag(metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when is_anomalous = TRUE and 'both' != 'spike' then\n          lag(min_metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when 'both' = 'spike' then metric_value\n          else min_metric_value end as min_value,\n          case\n          when is_anomalous = TRUE and 'both' = 'drop' then\n          lag(metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when is_anomalous = TRUE and 'both' != 'drop' then\n          lag(max_metric_value) over (partition by full_table_name, column_name, metric_name, dimension, dimension_value, bucket_seasonality order by bucket_end)\n          when 'both' = 'drop' then metric_value\n          else max_metric_value end as max_value,\n          bucket_start as start_time,\n          bucket_end as end_time,\n          *\n        from anomaly_scores_with_is_anomalous\n        order by bucket_end, dimension_value\n      )\n\n      select * from final_results\n      where 1 = 1) results\n    where is_anomalous = true"}, "configuration": {"test_name": "column_anomalies", "timestamp_column": "signup_date", "testing_timeframe": "1 day", "anomaly_threshold": null}, "test_tags": ["column_anomalies", "elementary-tests"], "normalized_full_path": "elementary_tutorial/models/schema.yml"}, "test_runs": {"fail_rate": 0.25, "totals": {"errors": 1, "warnings": 0, "passed": 3, "failures": 0}, "invocations": [{"affected_rows": null, "time_utc": "2024-08-18T03:49:49+00:00", "id": "563b9e97-5eee-4b1f-b4c4-34b0549d51be", "status": "error", "execution_time": null}, {"affected_rows": null, "time_utc": "2024-08-18T03:51:13+00:00", "id": "20ee100f-662e-401a-b32f-d932912ea4c0", "status": "pass", "execution_time": null}, {"affected_rows": null, "time_utc": "2024-08-18T08:21:30+00:00", "id": "ca67f4f7-7982-477f-83c1-5297dd78bbe9", "status": "pass", "execution_time": null}, {"affected_rows": null, "time_utc": "2024-08-19T01:28:26+00:00", "id": "e97da402-d3d2-4204-a365-a99740471e0e", "status": "pass", "execution_time": null}], "description": "There were no failures, 1 errors and no warnings on the last 4 test runs."}, "median_exec_time": 0.0, "last_exec_time": null}, {"metadata": {"test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_customers_1.f225f4677c", "elementary_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_customers_1.f225f4677c.None.generic", "database_name": "elementary_demo", "schema_name": "public", "table_name": "customers", "column_name": null, "test_name": "volume_anomalies", "test_display_name": "Volume Anomalies", "original_path": "models/schema.yml", "latest_run_time": "2024-08-18T11:49:49+08:00", "latest_run_time_utc": "2024-08-18T03:49:49+00:00", "latest_run_status": "error", "model_unique_id": "model.elementary_tutorial.customers", "table_unique_id": "elementary_demo.public.customers", "test_type": "anomaly_detection", "test_sub_type": "generic", "test_query": null, "test_params": {"anomaly_sensitivity": 1, "model": "{{ get_where_subquery(ref('customers')) }}"}, "test_created_at": null, "description": "Monitors the row count of your table over time.", "result": {"result_description": "Database Error in test elementary_volume_anomalies_customers_1 (models/schema.yml)\n  relation \"public.customers\" does not exist\n  LINE 20:         from \"elementary_demo\".\"public\".\"customers\"\n                        ^", "result_query": null}, "configuration": {"test_name": "volume_anomalies", "timestamp_column": null, "testing_timeframe": "1 day", "anomaly_threshold": 1}, "test_tags": ["elementary-tests", "volume_anomalies"], "normalized_full_path": "elementary_tutorial/models/schema.yml"}, "test_runs": {"fail_rate": 1.0, "totals": {"errors": 1, "warnings": 0, "passed": 0, "failures": 0}, "invocations": [{"affected_rows": null, "time_utc": "2024-08-18T03:49:49+00:00", "id": "563b9e97-5eee-4b1f-b4c4-34b0549d51be", "status": "error", "execution_time": null}], "description": "There were no failures, 1 errors and no warnings on the last 1 test runs."}, "median_exec_time": 0.0, "last_exec_time": null}, {"metadata": {"test_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_customers_1.f225f4677c", "elementary_unique_id": "test.elementary_tutorial.elementary_volume_anomalies_customers_1.f225f4677c.None.row_count", "database_name": "elementary_demo", "schema_name": "public", "table_name": "customers", "column_name": null, "test_name": "volume_anomalies", "test_display_name": "Volume Anomalies", "original_path": "models/schema.yml", "latest_run_time": "2024-08-19T09:28:25+08:00", "latest_run_time_utc": "2024-08-19T01:28:25+00:00", "latest_run_status": "pass", "model_unique_id": "model.elementary_tutorial.customers", "table_unique_id": "elementary_demo.public.customers", "test_type": "anomaly_detection", "test_sub_type": "row_count", "test_query": "select * from (None) results\n      where\n        anomaly_score is not null and\n        upper(full_table_name) = upper(cast('ELEMENTARY_DEMO.PUBLIC.CUSTOMERS' as varchar(4096))) and\n        metric_name = cast('row_count' as varchar(4096))", "test_params": {"anomaly_sensitivity": 1, "model": "{{ get_where_subquery(ref('customers')) }}", "timestamp_column": "signup_date", "where_expression": null, "anomaly_direction": "both", "time_bucket": {"period": "day", "count": 1}, "days_back": 14, "backfill_days": 2, "seasonality": null, "freshness_column": null, "event_timestamp_column": null, "dimensions": null, "ignore_small_changes": {"spike_failure_percent_threshold": null, "drop_failure_percent_threshold": null}, "fail_on_zero": false, "detection_delay": {"period": "hour", "count": 0}, "anomaly_exclude_metrics": null, "exclude_final_results": "1 = 1"}, "test_created_at": null, "description": "Monitors the row count of your table over time.", "result": {"result_description": "The last row_count value is 0.000. The average for this metric is 0.000.", "result_query": "select * from (None) results\n      where\n        anomaly_score is not null and\n        upper(full_table_name) = upper(cast('ELEMENTARY_DEMO.PUBLIC.CUSTOMERS' as varchar(4096))) and\n        metric_name = cast('row_count' as varchar(4096))"}, "configuration": {"test_name": "volume_anomalies", "timestamp_column": "signup_date", "testing_timeframe": "1 day", "anomaly_threshold": 1}, "test_tags": ["elementary-tests", "volume_anomalies"], "normalized_full_path": "elementary_tutorial/models/schema.yml"}, "test_runs": {"fail_rate": 0.0, "totals": {"errors": 0, "warnings": 0, "passed": 3, "failures": 0}, "invocations": [{"affected_rows": null, "time_utc": "2024-08-18T03:51:12+00:00", "id": "20ee100f-662e-401a-b32f-d932912ea4c0", "status": "pass", "execution_time": null}, {"affected_rows": null, "time_utc": "2024-08-18T08:21:29+00:00", "id": "ca67f4f7-7982-477f-83c1-5297dd78bbe9", "status": "pass", "execution_time": null}, {"affected_rows": null, "time_utc": "2024-08-19T01:28:25+00:00", "id": "e97da402-d3d2-4204-a365-a99740471e0e", "status": "pass", "execution_time": null}], "description": "There were no failures, no errors and no warnings on the last 3 test runs."}, "median_exec_time": 0.0, "last_exec_time": null}]}, "test_runs_totals": {"model.elementary_tutorial.test_practice": {"errors": 1, "warnings": 0, "passed": 0, "failures": 3}, "test.elementary_tutorial.test4_dbt_test": {"errors": 1, "warnings": 0, "passed": 0, "failures": 3}, "model.elementary_tutorial.orders": {"errors": 1, "warnings": 0, "passed": 3, "failures": 0}, "model.elementary_tutorial.test4schema": {"errors": 1, "warnings": 1, "passed": 2, "failures": 0}, "model.elementary_tutorial.test4_column_anomaly": {"errors": 2, "warnings": 0, "passed": 6, "failures": 0}, "model.elementary_tutorial.test4_volume_anomaly": {"errors": 1, "warnings": 0, "passed": 3, "failures": 0}, "model.elementary_tutorial.returned_orders": {"errors": 1, "warnings": 0, "passed": 3, "failures": 0}, "model.elementary_tutorial.customers": {"errors": 2, "warnings": 0, "passed": 6, "failures": 0}}, "coverages": {"model.elementary_tutorial.customers": {"table_tests": 1, "column_tests": 1}, "model.elementary_tutorial.orders": {"table_tests": 1, "column_tests": 0}, "model.elementary_tutorial.returned_orders": {"table_tests": 1, "column_tests": 0}, "model.elementary_tutorial.test4_column_anomaly": {"table_tests": 0, "column_tests": 2}, "model.elementary_tutorial.test4schema": {"table_tests": 1, "column_tests": 0}, "model.elementary_tutorial.test4_volume_anomaly": {"table_tests": 1, "column_tests": 0}, "model.elementary_tutorial.test_practice": {"table_tests": 1, "column_tests": 0}}, "model_runs": [{"unique_id": "model.elementary_tutorial.stg_customers", "schema": "public", "name": "stg_customers", "status": "success", "last_exec_time": 0.1, "median_exec_time": 0.1, "compiled_code": "-- depends_on: \"elementary_demo\".\"public\".\"customers_validation\"\n\n\n    with source as (\n        select * from \"elementary_demo\".\"public\".\"customers_training\"\n    ),\n\n\nrenamed as (\n\n    select\n        id as customer_id,\n        first_name,\n        last_name\n\n    from source\n\n)\n\nselect * from renamed", "last_generated_at": "2024-08-19T01:28:05+00:00", "exec_time_change_rate": 0.0, "totals": {"errors": 0, "success": 3}, "runs": [{"id": "221ed21b-e787-4a4e-8f80-77edb9e8ec22", "time_utc": "2024-08-18T03:51:01+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.1}, {"id": "58e8d583-7104-4bac-9c09-7933cbfcb185", "time_utc": "2024-08-18T08:21:17+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.2}, {"id": "4ff85ef3-d80c-4c2a-962a-090a84e0722a", "time_utc": "2024-08-19T01:28:05+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.1}]}, {"unique_id": "model.elementary_tutorial.stg_orders", "schema": "public", "name": "stg_orders", "status": "success", "last_exec_time": 0.1, "median_exec_time": 0.1, "compiled_code": "-- depends_on: \"elementary_demo\".\"public\".\"orders_validation\"\n\n\n    with source as (\n        select * from \"elementary_demo\".\"public\".\"orders_training\"\n    ),\n\n\nrenamed as (\n\n    select\n        id as order_id,\n        user_id as customer_id,\n        order_date,\n        status\n\n    from source\n\n)\n\nselect * from renamed", "last_generated_at": "2024-08-19T01:28:05+00:00", "exec_time_change_rate": 0.0, "totals": {"errors": 0, "success": 3}, "runs": [{"id": "221ed21b-e787-4a4e-8f80-77edb9e8ec22", "time_utc": "2024-08-18T03:51:01+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.1}, {"id": "58e8d583-7104-4bac-9c09-7933cbfcb185", "time_utc": "2024-08-18T08:21:17+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.1}, {"id": "4ff85ef3-d80c-4c2a-962a-090a84e0722a", "time_utc": "2024-08-19T01:28:05+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.1}]}, {"unique_id": "model.elementary_tutorial.stg_payments", "schema": "public", "name": "stg_payments", "status": "success", "last_exec_time": 0.1, "median_exec_time": 0.1, "compiled_code": "-- depends_on: \"elementary_demo\".\"public\".\"payments_validation\"\n\n\n    with source as (\n        select * from \"elementary_demo\".\"public\".\"payments_training\"\n    ),\n\n\nrenamed as (\n\n    select\n        id as payment_id,\n        order_id,\n        payment_method,\n\n        -- `amount` is currently stored in cents, so we convert it to dollars\n        amount / 100 as amount\n\n    from source\n\n)\n\nselect * from renamed", "last_generated_at": "2024-08-19T01:28:05+00:00", "exec_time_change_rate": 0.0, "totals": {"errors": 0, "success": 3}, "runs": [{"id": "221ed21b-e787-4a4e-8f80-77edb9e8ec22", "time_utc": "2024-08-18T03:51:01+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.1}, {"id": "58e8d583-7104-4bac-9c09-7933cbfcb185", "time_utc": "2024-08-18T08:21:17+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.1}, {"id": "4ff85ef3-d80c-4c2a-962a-090a84e0722a", "time_utc": "2024-08-19T01:28:05+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.1}]}, {"unique_id": "model.elementary_tutorial.stg_signups", "schema": "public", "name": "stg_signups", "status": "success", "last_exec_time": 0.2, "median_exec_time": 0.1, "compiled_code": "-- depends_on: \"elementary_demo\".\"public\".\"signups_validation\"\n\n\n    with source as (\n        select * from \"elementary_demo\".\"public\".\"signups_training\"\n    ),\n\n\nrenamed as (\n\n    select\n        id as signup_id,\n        user_id as customer_id,\n        user_email as customer_email,\n        hashed_password,\n        signup_date\n\n    from source\n\n)\n\nselect * from renamed", "last_generated_at": "2024-08-19T01:28:05+00:00", "exec_time_change_rate": 100.0, "totals": {"errors": 0, "success": 3}, "runs": [{"id": "221ed21b-e787-4a4e-8f80-77edb9e8ec22", "time_utc": "2024-08-18T03:51:01+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.1}, {"id": "58e8d583-7104-4bac-9c09-7933cbfcb185", "time_utc": "2024-08-18T08:21:17+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.1}, {"id": "4ff85ef3-d80c-4c2a-962a-090a84e0722a", "time_utc": "2024-08-19T01:28:05+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.2}]}, {"unique_id": "model.elementary_tutorial.test_practice", "schema": "public", "name": "test_practice", "status": "success", "last_exec_time": 0.1, "median_exec_time": 0.1, "compiled_code": "-- depends_on: \"elementary_demo\".\"public\".\"customers_validation\"\n\nwith source as (\n    select * from \"elementary_demo\".\"public\".\"test_training\"\n),\n\nrenamed as (\n    select\n    *\n    from source\n)\n\nselect * from renamed", "last_generated_at": "2024-08-19T01:28:05+00:00", "exec_time_change_rate": 0.0, "totals": {"errors": 0, "success": 3}, "runs": [{"id": "221ed21b-e787-4a4e-8f80-77edb9e8ec22", "time_utc": "2024-08-18T03:51:01+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.1}, {"id": "58e8d583-7104-4bac-9c09-7933cbfcb185", "time_utc": "2024-08-18T08:21:17+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.1}, {"id": "4ff85ef3-d80c-4c2a-962a-090a84e0722a", "time_utc": "2024-08-19T01:28:05+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.1}]}, {"unique_id": "model.elementary_tutorial.test_volume", "schema": "public", "name": "test_volume", "status": "success", "last_exec_time": 0.1, "median_exec_time": 0.1, "compiled_code": "-- depends_on: \"elementary_demo\".\"public\".\"test_dataset\"\n\nwith source as (\n    select * from \"elementary_demo\".\"public\".\"test_dataset\"\n),\n\nrenamed as (\n    select\n    *\n    from source\n)\n\nselect * from renamed", "last_generated_at": "2024-08-19T01:28:05+00:00", "exec_time_change_rate": 0.0, "totals": {"errors": 0, "success": 3}, "runs": [{"id": "221ed21b-e787-4a4e-8f80-77edb9e8ec22", "time_utc": "2024-08-18T03:51:01+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.1}, {"id": "58e8d583-7104-4bac-9c09-7933cbfcb185", "time_utc": "2024-08-18T08:21:17+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.2}, {"id": "4ff85ef3-d80c-4c2a-962a-090a84e0722a", "time_utc": "2024-08-19T01:28:05+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.1}]}, {"unique_id": "model.elementary_tutorial.orders", "schema": "public", "name": "orders", "status": "success", "last_exec_time": 0.1, "median_exec_time": 0.1, "compiled_code": "\n\nwith orders as (\n\n    select * from \"elementary_demo\".\"public\".\"stg_orders\"\n\n),\n\npayments as (\n\n    select * from \"elementary_demo\".\"public\".\"stg_payments\"\n\n),\n\norder_payments as (\n\n    select\n        order_id,\n\n        sum(case when payment_method = 'credit_card' then amount else 0 end) as credit_card_amount,\n        sum(case when payment_method = 'coupon' then amount else 0 end) as coupon_amount,\n        sum(case when payment_method = 'bank_transfer' then amount else 0 end) as bank_transfer_amount,\n        sum(case when payment_method = 'gift_card' then amount else 0 end) as gift_card_amount,\n        sum(amount) as total_amount\n\n    from payments\n\n    group by order_id\n\n),\n\nfinal as (\n\n    select\n        orders.order_id,\n        orders.customer_id,\n        orders.order_date,\n        orders.status,\n\n        order_payments.credit_card_amount,\n\n        order_payments.coupon_amount,\n\n        order_payments.bank_transfer_amount,\n\n        order_payments.gift_card_amount,\n\n        order_payments.total_amount as amount\n\n    from orders\n\n\n    left join order_payments\n        on orders.order_id = order_payments.order_id\n\n)\n\nselect * from final", "last_generated_at": "2024-08-19T01:28:05+00:00", "exec_time_change_rate": 0.0, "totals": {"errors": 0, "success": 3}, "runs": [{"id": "221ed21b-e787-4a4e-8f80-77edb9e8ec22", "time_utc": "2024-08-18T03:51:01+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.1}, {"id": "58e8d583-7104-4bac-9c09-7933cbfcb185", "time_utc": "2024-08-18T08:21:17+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.1}, {"id": "4ff85ef3-d80c-4c2a-962a-090a84e0722a", "time_utc": "2024-08-19T01:28:05+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.1}]}, {"unique_id": "model.elementary_tutorial.customers", "schema": "public", "name": "customers", "status": "success", "last_exec_time": 0.2, "median_exec_time": 0.1, "compiled_code": "with customers as (\n\n    select * from \"elementary_demo\".\"public\".\"stg_customers\"\n\n),\n\norders as (\n\n    select * from \"elementary_demo\".\"public\".\"stg_orders\"\n\n),\n\npayments as (\n\n    select * from \"elementary_demo\".\"public\".\"stg_payments\"\n\n),\n\nsignups as (\n\n    select * from \"elementary_demo\".\"public\".\"stg_signups\"\n),\n\ncustomer_orders as (\n\n        select\n        customer_id,\n\n        min(order_date) as first_order,\n        max(order_date) as most_recent_order,\n        count(order_id) as number_of_orders\n    from orders\n\n    group by customer_id\n\n),\n\ncustomer_payments as (\n\n    select\n        orders.customer_id,\n        sum(amount) as total_amount\n\n    from payments\n\n    left join orders on\n         payments.order_id = orders.order_id\n\n    group by orders.customer_id\n\n),\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order,\n        customer_orders.most_recent_order,\n        case\n            when customer_orders.number_of_orders is null then 0\n            else customer_orders.number_of_orders\n        end as number_of_orders,\n        customer_payments.total_amount as customer_lifetime_value,\n        signups.customer_email,\n        \n        signups.signup_date\n\n    from customers\n\n    left join customer_orders\n        on customers.customer_id = customer_orders.customer_id\n\n    left join customer_payments\n        on  customers.customer_id = customer_payments.customer_id\n\n    left join signups\n        on customers.customer_id = signups.customer_id\n\n)\n\nselect * from final", "last_generated_at": "2024-08-19T01:28:05+00:00", "exec_time_change_rate": 100.0, "totals": {"errors": 0, "success": 3}, "runs": [{"id": "221ed21b-e787-4a4e-8f80-77edb9e8ec22", "time_utc": "2024-08-18T03:51:01+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.1}, {"id": "58e8d583-7104-4bac-9c09-7933cbfcb185", "time_utc": "2024-08-18T08:21:17+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.1}, {"id": "4ff85ef3-d80c-4c2a-962a-090a84e0722a", "time_utc": "2024-08-19T01:28:05+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.2}]}, {"unique_id": "model.elementary_tutorial.test4_column_anomaly", "schema": "public", "name": "test4_column_anomaly", "status": "success", "last_exec_time": 0.1, "median_exec_time": 0.1, "compiled_code": "with orders as (\n\n    select * from \"elementary_demo\".\"public\".\"test_practice\"\n\n),\n\nfinal as (\n\n    select\n    *\n    from orders\n)\n\nselect * from final", "last_generated_at": "2024-08-19T01:28:05+00:00", "exec_time_change_rate": 0.0, "totals": {"errors": 0, "success": 3}, "runs": [{"id": "221ed21b-e787-4a4e-8f80-77edb9e8ec22", "time_utc": "2024-08-18T03:51:01+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.1}, {"id": "58e8d583-7104-4bac-9c09-7933cbfcb185", "time_utc": "2024-08-18T08:21:17+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.1}, {"id": "4ff85ef3-d80c-4c2a-962a-090a84e0722a", "time_utc": "2024-08-19T01:28:05+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.1}]}, {"unique_id": "model.elementary_tutorial.test4_volume_anomaly", "schema": "public", "name": "test4_volume_anomaly", "status": "success", "last_exec_time": 0.1, "median_exec_time": 0.1, "compiled_code": "with orders as (\n\n    select * from \"elementary_demo\".\"public\".\"test_volume\"\n\n),\n\nfinal as (\n\n    select\n    *\n    from orders\n)\n\nselect * from final", "last_generated_at": "2024-08-19T01:28:05+00:00", "exec_time_change_rate": 0.0, "totals": {"errors": 0, "success": 3}, "runs": [{"id": "221ed21b-e787-4a4e-8f80-77edb9e8ec22", "time_utc": "2024-08-18T03:51:01+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.1}, {"id": "58e8d583-7104-4bac-9c09-7933cbfcb185", "time_utc": "2024-08-18T08:21:17+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.1}, {"id": "4ff85ef3-d80c-4c2a-962a-090a84e0722a", "time_utc": "2024-08-19T01:28:05+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.1}]}, {"unique_id": "model.elementary_tutorial.returned_orders", "schema": "public", "name": "returned_orders", "status": "success", "last_exec_time": 0.1, "median_exec_time": 0.1, "compiled_code": "\n\nwith orders as (\n    select *\n    from \"elementary_demo\".\"public\".\"orders\"\n)\n\nselect *\nfrom orders\nwhere status = 'return_pending' or status = 'returned'", "last_generated_at": "2024-08-19T01:28:05+00:00", "exec_time_change_rate": 0.0, "totals": {"errors": 0, "success": 3}, "runs": [{"id": "221ed21b-e787-4a4e-8f80-77edb9e8ec22", "time_utc": "2024-08-18T03:51:01+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.1}, {"id": "58e8d583-7104-4bac-9c09-7933cbfcb185", "time_utc": "2024-08-18T08:21:17+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.1}, {"id": "4ff85ef3-d80c-4c2a-962a-090a84e0722a", "time_utc": "2024-08-19T01:28:05+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.1}]}, {"unique_id": "model.elementary_tutorial.test4schema", "schema": "public", "name": "test4schema", "status": "success", "last_exec_time": 0.1, "median_exec_time": 0.1, "compiled_code": "with orders as (\n\n    select * from \"elementary_demo\".\"public\".\"test4_column_anomaly\"\n\n),\n\nfinal as (\n\n    select\n    age\n    from orders\n)\n\nselect * from final", "last_generated_at": "2024-08-19T01:28:05+00:00", "exec_time_change_rate": 0.0, "totals": {"errors": 0, "success": 3}, "runs": [{"id": "221ed21b-e787-4a4e-8f80-77edb9e8ec22", "time_utc": "2024-08-18T03:51:01+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.1}, {"id": "58e8d583-7104-4bac-9c09-7933cbfcb185", "time_utc": "2024-08-18T08:21:17+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.1}, {"id": "4ff85ef3-d80c-4c2a-962a-090a84e0722a", "time_utc": "2024-08-19T01:28:05+00:00", "status": "success", "full_refresh": false, "materialization": "view", "execution_time": 0.1}]}], "model_runs_totals": {"model.elementary_tutorial.stg_customers": {"errors": 0, "warnings": 0, "passed": 3, "failures": 0}, "model.elementary_tutorial.stg_orders": {"errors": 0, "warnings": 0, "passed": 3, "failures": 0}, "model.elementary_tutorial.stg_payments": {"errors": 0, "warnings": 0, "passed": 3, "failures": 0}, "model.elementary_tutorial.stg_signups": {"errors": 0, "warnings": 0, "passed": 3, "failures": 0}, "model.elementary_tutorial.test_practice": {"errors": 0, "warnings": 0, "passed": 3, "failures": 0}, "model.elementary_tutorial.test_volume": {"errors": 0, "warnings": 0, "passed": 3, "failures": 0}, "model.elementary_tutorial.orders": {"errors": 0, "warnings": 0, "passed": 3, "failures": 0}, "model.elementary_tutorial.customers": {"errors": 0, "warnings": 0, "passed": 3, "failures": 0}, "model.elementary_tutorial.test4_column_anomaly": {"errors": 0, "warnings": 0, "passed": 3, "failures": 0}, "model.elementary_tutorial.test4_volume_anomaly": {"errors": 0, "warnings": 0, "passed": 3, "failures": 0}, "model.elementary_tutorial.returned_orders": {"errors": 0, "warnings": 0, "passed": 3, "failures": 0}, "model.elementary_tutorial.test4schema": {"errors": 0, "warnings": 0, "passed": 3, "failures": 0}}, "filters": {"test_results": [{"name": "failures", "display_name": "Failures", "model_unique_ids": ["model.elementary_tutorial.test_practice", "test.elementary_tutorial.test4_dbt_test"]}, {"name": "errors", "display_name": "Errors", "model_unique_ids": ["model.elementary_tutorial.customers", "model.elementary_tutorial.test4_volume_anomaly", "model.elementary_tutorial.returned_orders"]}, {"name": "passed", "display_name": "Passed", "model_unique_ids": ["model.elementary_tutorial.orders", "model.elementary_tutorial.test4schema", "model.elementary_tutorial.test4_column_anomaly", "model.elementary_tutorial.test4_volume_anomaly", "model.elementary_tutorial.returned_orders", "model.elementary_tutorial.customers"]}, {"name": "no_test", "display_name": "No Tests", "model_unique_ids": ["model.elementary_tutorial.stg_customers", "model.elementary_tutorial.stg_payments", "model.elementary_tutorial.stg_orders", "model.elementary_tutorial.test_volume", "model.elementary_tutorial.stg_signups"]}], "test_runs": [{"name": "failures", "display_name": "Failures", "model_unique_ids": ["model.elementary_tutorial.test_practice", "test.elementary_tutorial.test4_dbt_test"]}, {"name": "warnings", "display_name": "Warnings", "model_unique_ids": ["model.elementary_tutorial.test4schema"]}, {"name": "errors", "display_name": "Errors", "model_unique_ids": ["model.elementary_tutorial.test_practice", "test.elementary_tutorial.test4_dbt_test", "model.elementary_tutorial.orders", "model.elementary_tutorial.test4schema", "model.elementary_tutorial.test4_column_anomaly", "model.elementary_tutorial.test4_volume_anomaly", "model.elementary_tutorial.returned_orders", "model.elementary_tutorial.customers"]}, {"name": "passed", "display_name": "Passed", "model_unique_ids": ["model.elementary_tutorial.orders", "model.elementary_tutorial.test4schema", "model.elementary_tutorial.test4_column_anomaly", "model.elementary_tutorial.test4_volume_anomaly", "model.elementary_tutorial.returned_orders", "model.elementary_tutorial.customers"]}, {"name": "no_test", "display_name": "No Tests", "model_unique_ids": ["model.elementary_tutorial.stg_customers", "model.elementary_tutorial.stg_payments", "model.elementary_tutorial.stg_orders", "model.elementary_tutorial.test_volume", "model.elementary_tutorial.stg_signups"]}], "model_runs": [{"name": "success", "display_name": "Successful Runs", "model_unique_ids": ["model.elementary_tutorial.test_practice", "model.elementary_tutorial.stg_customers", "model.elementary_tutorial.stg_payments", "model.elementary_tutorial.stg_orders", "model.elementary_tutorial.test_volume", "model.elementary_tutorial.stg_signups", "model.elementary_tutorial.orders", "model.elementary_tutorial.test4schema", "model.elementary_tutorial.test4_column_anomaly", "model.elementary_tutorial.test4_volume_anomaly", "model.elementary_tutorial.returned_orders", "model.elementary_tutorial.customers"]}]}, "lineage": {"nodes": [{"id": "model.elementary_tutorial.returned_orders", "type": "model", "sub_type": "view"}, {"id": "model.elementary_tutorial.test4_volume_anomaly", "type": "model", "sub_type": "view"}, {"id": "model.elementary_tutorial.customers", "type": "model", "sub_type": "view"}, {"id": "model.elementary_tutorial.orders", "type": "model", "sub_type": "view"}, {"id": "model.elementary_tutorial.test4_column_anomaly", "type": "model", "sub_type": "view"}, {"id": "model.elementary_tutorial.stg_customers", "type": "model", "sub_type": "view"}, {"id": "model.elementary_tutorial.test_practice", "type": "model", "sub_type": "view"}, {"id": "model.elementary_tutorial.stg_payments", "type": "model", "sub_type": "view"}, {"id": "model.elementary_tutorial.stg_orders", "type": "model", "sub_type": "view"}, {"id": "model.elementary_tutorial.stg_signups", "type": "model", "sub_type": "view"}, {"id": "model.elementary_tutorial.test_volume", "type": "model", "sub_type": "view"}, {"id": "model.elementary_tutorial.test4schema", "type": "model", "sub_type": "view"}], "edges": [["model.elementary_tutorial.returned_orders", "model.elementary_tutorial.orders"], ["model.elementary_tutorial.orders", "model.elementary_tutorial.stg_orders"], ["model.elementary_tutorial.orders", "model.elementary_tutorial.stg_payments"], ["model.elementary_tutorial.test4_volume_anomaly", "model.elementary_tutorial.test_volume"], ["model.elementary_tutorial.customers", "model.elementary_tutorial.stg_customers"], ["model.elementary_tutorial.customers", "model.elementary_tutorial.stg_orders"], ["model.elementary_tutorial.customers", "model.elementary_tutorial.stg_payments"], ["model.elementary_tutorial.customers", "model.elementary_tutorial.stg_signups"], ["model.elementary_tutorial.test4_column_anomaly", "model.elementary_tutorial.test_practice"], ["model.elementary_tutorial.test4schema", "model.elementary_tutorial.test4_column_anomaly"]]}, "invocations": [{"invocation_id": "4ff85ef3-d80c-4c2a-962a-090a84e0722a", "detected_at": null, "command": "run", "selected": "", "full_refresh": false, "job_url": null, "job_name": null, "job_id": null, "orchestrator": null}], "resources_latest_invocation": {"model.elementary.alerts_anomaly_detection": "4ff85ef3-d80c-4c2a-962a-090a84e0722a", "model.elementary.alerts_dbt_models": "4ff85ef3-d80c-4c2a-962a-090a84e0722a", "model.elementary.alerts_dbt_source_freshness": "4ff85ef3-d80c-4c2a-962a-090a84e0722a", "model.elementary.alerts_dbt_tests": "4ff85ef3-d80c-4c2a-962a-090a84e0722a", "model.elementary.alerts_schema_changes": "4ff85ef3-d80c-4c2a-962a-090a84e0722a", "model.elementary.anomaly_threshold_sensitivity": "4ff85ef3-d80c-4c2a-962a-090a84e0722a", "model.elementary.data_monitoring_metrics": "4ff85ef3-d80c-4c2a-962a-090a84e0722a", "model.elementary.dbt_artifacts_hashes": "4ff85ef3-d80c-4c2a-962a-090a84e0722a", "model.elementary.dbt_columns": "4ff85ef3-d80c-4c2a-962a-090a84e0722a", "model.elementary.dbt_exposures": "4ff85ef3-d80c-4c2a-962a-090a84e0722a", "model.elementary.dbt_invocations": "4ff85ef3-d80c-4c2a-962a-090a84e0722a", "model.elementary.dbt_metrics": "4ff85ef3-d80c-4c2a-962a-090a84e0722a", "model.elementary.dbt_models": "4ff85ef3-d80c-4c2a-962a-090a84e0722a", "model.elementary.dbt_run_results": "4ff85ef3-d80c-4c2a-962a-090a84e0722a", "model.elementary.dbt_seeds": "4ff85ef3-d80c-4c2a-962a-090a84e0722a", "model.elementary.dbt_snapshots": "4ff85ef3-d80c-4c2a-962a-090a84e0722a", "model.elementary.dbt_source_freshness_results": "4ff85ef3-d80c-4c2a-962a-090a84e0722a", "model.elementary.dbt_sources": "4ff85ef3-d80c-4c2a-962a-090a84e0722a", "model.elementary.dbt_tests": "4ff85ef3-d80c-4c2a-962a-090a84e0722a", "model.elementary.elementary_test_results": "4ff85ef3-d80c-4c2a-962a-090a84e0722a", "model.elementary.job_run_results": "4ff85ef3-d80c-4c2a-962a-090a84e0722a", "model.elementary.metadata": "4ff85ef3-d80c-4c2a-962a-090a84e0722a", "model.elementary.metrics_anomaly_score": "4ff85ef3-d80c-4c2a-962a-090a84e0722a", "model.elementary.model_run_results": "4ff85ef3-d80c-4c2a-962a-090a84e0722a", "model.elementary.monitors_runs": "4ff85ef3-d80c-4c2a-962a-090a84e0722a", "model.elementary.schema_columns_snapshot": "4ff85ef3-d80c-4c2a-962a-090a84e0722a", "model.elementary.snapshot_run_results": "4ff85ef3-d80c-4c2a-962a-090a84e0722a", "model.elementary.test_result_rows": "4ff85ef3-d80c-4c2a-962a-090a84e0722a", "model.elementary_tutorial.customers": "4ff85ef3-d80c-4c2a-962a-090a84e0722a", "model.elementary_tutorial.orders": "4ff85ef3-d80c-4c2a-962a-090a84e0722a", "model.elementary_tutorial.returned_orders": "4ff85ef3-d80c-4c2a-962a-090a84e0722a", "model.elementary_tutorial.stg_customers": "4ff85ef3-d80c-4c2a-962a-090a84e0722a", "model.elementary_tutorial.stg_orders": "4ff85ef3-d80c-4c2a-962a-090a84e0722a", "model.elementary_tutorial.stg_payments": "4ff85ef3-d80c-4c2a-962a-090a84e0722a", "model.elementary_tutorial.stg_signups": "4ff85ef3-d80c-4c2a-962a-090a84e0722a", "model.elementary_tutorial.test4_column_anomaly": "4ff85ef3-d80c-4c2a-962a-090a84e0722a", "model.elementary_tutorial.test4schema": "4ff85ef3-d80c-4c2a-962a-090a84e0722a", "model.elementary_tutorial.test4_volume_anomaly": "4ff85ef3-d80c-4c2a-962a-090a84e0722a", "model.elementary_tutorial.test_practice": "4ff85ef3-d80c-4c2a-962a-090a84e0722a", "model.elementary_tutorial.test_volume": "4ff85ef3-d80c-4c2a-962a-090a84e0722a"}, "invocations_job_identification": {}, "env": {"project_name": "elementary_tutorial", "env": "dev", "warehouse_type": "postgres"}, "tracking": {"posthog_api_key": "phc_56XBEzZmh02mGkadqLiYW51eECyYKWPyecVwkGdGUfg", "report_generator_anonymous_user_id": "47e68f9f-108e-4fe3-88cb-b43b9e5726c8", "anonymous_warehouse_id": "49960de5880e8c687434170f6476605b8fe4aeb9a28632c7995cf3ba831d9763"}}